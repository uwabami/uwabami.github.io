<!doctype html>
<html ⚡ lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <link rel="preconnect dns-prefetch" href="//cdn.ampproject.org" crossorigin>
    <link rel="preconnect dns-prefetch" href="//uwabami.github.io/" crossorigin>
    <!-- amp preload -->
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js">
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0/amp-geo-0.1.js">
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0/amp-consent-0.1.js">
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0/amp-analytics-0.1.js">
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0/amp-font-0.1.js">
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0/amp-form-0.1.js">
    <link rel="preload" as="image" href="/assets/img/top.png">
    <link rel="preload" as="font" type="font/woff2" href="/assets/fonts/inconsolata-v18-latin-regular.woff2" crossorigin>
    <link rel="preload" as="font" type="font/woff2" href="/assets/fonts/inconsolata-v18-latin-700.woff2" crossorigin>
    <link rel="preload" as="font" type="font/woff2" href="/assets/fonts/isfit-plus.woff2" crossorigin>
    <!-- end amp preload -->
    <meta name="author" content="Youhei SASAKI">
    <!-- end: check google site verification -->
    <!-- alternate -->
    <link rel="alternate" hreflang="ja" href="https://uwabami.github.io/cc-env/Emacs.html" />
    <!-- end: alternate -->
    <!-- begin jekyll seo -->
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Emacs の設定 | Youhei SASAKI’s official site</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Emacs の設定" />
<meta name="author" content="Youhei SASAKI" />
<meta property="og:locale" content="ja" />
<meta name="description" content="My Interest: Geophysical Fluid Dynamics, Convection, MHD Dynamo, Numerical Computing, Unix, Linux, Debian" />
<meta property="og:description" content="My Interest: Geophysical Fluid Dynamics, Convection, MHD Dynamo, Numerical Computing, Unix, Linux, Debian" />
<link rel="canonical" href="https://uwabami.github.io/cc-env/Emacs.html" />
<meta property="og:url" content="https://uwabami.github.io/cc-env/Emacs.html" />
<meta property="og:site_name" content="Youhei SASAKI’s official site" />
<meta property="og:image" content="https://uwabami.github.io/assets/img/eyecatch_1600x900.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-11-01T12:22:33+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:image" content="https://uwabami.github.io/assets/img/eyecatch_1600x900.png" />
<meta property="twitter:title" content="Emacs の設定" />
<meta name="twitter:site" content="@uwabami" />
<meta name="twitter:creator" content="@Youhei SASAKI" />
<script type="application/ld+json">
{"url":"https://uwabami.github.io/cc-env/Emacs.html","description":"My Interest: Geophysical Fluid Dynamics, Convection, MHD Dynamo, Numerical Computing, Unix, Linux, Debian","@type":"BlogPosting","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://uwabami.github.io/assets/img/eyecatch_1600x900.png"},"name":"Youhei SASAKI"},"image":"https://uwabami.github.io/assets/img/eyecatch_1600x900.png","headline":"Emacs の設定","dateModified":"2020-11-01T12:22:33+09:00","datePublished":"2020-11-01T12:22:33+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://uwabami.github.io/cc-env/Emacs.html"},"author":{"@type":"Person","name":"Youhei SASAKI"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
    <!-- end jekyll seo -->
    <link rel="icon" type="image/x-icon" href="https://uwabami.github.io/assets/img/favicon.ico">
    <!-- apple icons -->
    <link rel="apple-touch-icon" href="https://uwabami.github.io/assets/img/favicon-256x256.png">
    <link rel="shortcut-icon" type="image/ico" href="/assets/img/favicon.ico">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-geo" src="https://cdn.ampproject.org/v0/amp-geo-0.1.js"></script>
    <script async custom-element="amp-consent" src="https://cdn.ampproject.org/v0/amp-consent-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-font" src="https://cdn.ampproject.org/v0/amp-font-0.1.js"></script>
    <script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
    <!-- Custom css based on following two framework -->
    <!-- - normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css -->
    <!-- - basscss v8.1.2 | MIT License | github.com/basscss/basscss -->
    <style amp-custom>@font-face{font-family:'Inconsolata';font-style:normal;font-weight:400;font-display:swap;src:local("Inconsolata Regular"),local("Inconsolata-Regular"),url("/assets/fonts/inconsolata-v18-latin-regular.woff2") format("woff2")}@font-face{font-family:'Inconsolata';font-style:Bold;font-weight:700;font-display:swap;src:local("Inconsolata Bold"),local("Inconsolata-Bold"),url("/assets/fonts/inconsolata-v18-latin-700.woff2") format("woff2")}@font-face{font-family:'Isfit+';font-style:normal;font-weight:400;font-display:swap;src:local("isfit+"),local("isfit-plus"),url("/assets/fonts/isfit-plus.woff2") format("woff2")}@font-face{font-family:'Comic Neue';font-style:normal;font-weight:400;font-display:swap;src:local("Comic Neue"),local("Comic Neue"),url("/assets/fonts/ComicNeueSubset.woff2") format("woff2")}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:"Inconsolata","游ゴシック体",YuGothic,"游ゴシック","Yu Gothic","メイリオ","Isfit+","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",Symbola,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:"Inconsolata","游ゴシック体",YuGothic,"游ゴシック","Yu Gothic","メイリオ","Isfit+","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",Symbola,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}.h00{font-size:4rem}.h0{font-size:3rem}.h1{font-size:2rem}.h2{font-size:1.5rem}.h3{font-size:1.25rem}.h4{font-size:1rem}.h5{font-size:.875rem}.h6{font-size:.75rem}.font-family-inherit{font-family:inherit}.font-size-inherit{font-size:inherit}.text-decoration-none{text-decoration:none}.bold{font-weight:700}.regular{font-weight:normal}.italic{font-style:italic}.caps{text-transform:uppercase;letter-spacing:.2em}.left-align{text-align:left}.center{text-align:center}.right-align{text-align:right}.justify{text-align:justify}.nowrap{white-space:nowrap}.break-word{word-wrap:break-word}.line-height-1{line-height:1}.line-height-2{line-height:1.125}.line-height-3{line-height:1.25}.line-height-4{line-height:1.5}.list-style-none{list-style:none}.underline{text-decoration:underline}.truncate{max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.list-reset{list-style:none;padding-left:0}.inline{display:inline}.block{display:block}.inline-block{display:inline-block}.table{display:table}.table-cell{display:table-cell}.overflow-hidden{overflow:hidden}.overflow-scroll{overflow:scroll}.overflow-auto{overflow:auto}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.left{float:left}.right{float:right}.fit{max-width:100%}.max-width-1{max-width:320px}.max-width-2{max-width:480px}.max-width-3{max-width:600px}.max-width-4{max-width:800px}.border-box{box-sizing:border-box}.align-baseline{vertical-align:baseline}.align-top{vertical-align:top}.align-middle{vertical-align:middle}.align-bottom{vertical-align:bottom}.m0{margin:0}.mt0{margin-top:0}.mr0{margin-right:0}.mb0{margin-bottom:0}.ml0{margin-left:0}.mx0{margin-left:0;margin-right:0}.my0{margin-top:0;margin-bottom:0}.m1{margin:.5rem}.mt1{margin-top:.5rem}.mr1{margin-right:.5rem}.mb1{margin-bottom:.5rem}.ml1{margin-left:.5rem}.mx1{margin-left:.5rem;margin-right:.5rem}.my1{margin-top:.5rem;margin-bottom:.5rem}.m2{margin:1rem}.mt2{margin-top:1rem}.mr2{margin-right:1rem}.mb2{margin-bottom:1rem}.ml2{margin-left:1rem}.mx2{margin-left:1rem;margin-right:1rem}.my2{margin-top:1rem;margin-bottom:1rem}.m3{margin:2rem}.mt3{margin-top:2rem}.mr3{margin-right:2rem}.mb3{margin-bottom:2rem}.ml3{margin-left:2rem}.mx3{margin-left:2rem;margin-right:2rem}.my3{margin-top:2rem;margin-bottom:2rem}.m4{margin:4rem}.mt4{margin-top:4rem}.mr4{margin-right:4rem}.mb4{margin-bottom:4rem}.ml4{margin-left:4rem}.mx4{margin-left:4rem;margin-right:4rem}.my4{margin-top:4rem;margin-bottom:4rem}.mxn1{margin-left:-.5rem;margin-right:-.5rem}.mxn2{margin-left:-1rem;margin-right:-1rem}.mxn3{margin-left:-2rem;margin-right:-2rem}.mxn4{margin-left:-4rem;margin-right:-4rem}.m-auto{margin:auto}.mt-auto{margin-top:auto}.mr-auto{margin-right:auto}.mb-auto{margin-bottom:auto}.ml-auto{margin-left:auto}.mx-auto{margin-left:auto;margin-right:auto}.my-auto{margin-top:auto;margin-bottom:auto}.p0{padding:0}.pt0{padding-top:0}.pr0{padding-right:0}.pb0{padding-bottom:0}.pl0{padding-left:0}.px0{padding-left:0;padding-right:0}.py0{padding-top:0;padding-bottom:0}.p1{padding:.5rem}.pt1{padding-top:.5rem}.pr1{padding-right:.5rem}.pb1{padding-bottom:.5rem}.pl1{padding-left:.5rem}.py1{padding-top:.5rem;padding-bottom:.5rem}.px1{padding-left:.5rem;padding-right:.5rem}.p2{padding:1rem}.pt2{padding-top:1rem}.pr2{padding-right:1rem}.pb2{padding-bottom:1rem}.pl2{padding-left:1rem}.py2{padding-top:1rem;padding-bottom:1rem}.px2{padding-left:1rem;padding-right:1rem}.p3{padding:2rem}.pt3{padding-top:2rem}.pr3{padding-right:2rem}.pb3{padding-bottom:2rem}.pl3{padding-left:2rem}.py3{padding-top:2rem;padding-bottom:2rem}.px3{padding-left:2rem;padding-right:2rem}.p4{padding:4rem}.pt4{padding-top:4rem}.pr4{padding-right:4rem}.pb4{padding-bottom:4rem}.pl4{padding-left:4rem}.py4{padding-top:4rem;padding-bottom:4rem}.px4{padding-left:4rem;padding-right:4rem}.col{float:left;box-sizing:border-box}.col-right{float:right;box-sizing:border-box}.col-1{width:8.33333%}.col-2{width:16.66667%}.col-3{width:25%}.col-4{width:33.33333%}.col-5{width:41.66667%}.col-6{width:50%}.col-7{width:58.33333%}.col-8{width:66.66667%}.col-9{width:75%}.col-10{width:83.33333%}.col-11{width:91.66667%}.col-12{width:100%}@media (min-width: 40.06rem){.sm-col{float:left;box-sizing:border-box}.sm-col-right{float:right;box-sizing:border-box}.sm-col-1{width:8.33333%}.sm-col-2{width:16.66667%}.sm-col-3{width:25%}.sm-col-4{width:33.33333%}.sm-col-5{width:41.66667%}.sm-col-6{width:50%}.sm-col-7{width:58.33333%}.sm-col-8{width:66.66667%}.sm-col-9{width:75%}.sm-col-10{width:83.33333%}.sm-col-11{width:91.66667%}.sm-col-12{width:100%}}@media (min-width: 52.06rem){.md-col{float:left;box-sizing:border-box}.md-col-right{float:right;box-sizing:border-box}.md-col-1{width:8.33333%}.md-col-2{width:16.66667%}.md-col-3{width:25%}.md-col-4{width:33.33333%}.md-col-5{width:41.66667%}.md-col-6{width:50%}.md-col-7{width:58.33333%}.md-col-8{width:66.66667%}.md-col-9{width:75%}.md-col-10{width:83.33333%}.md-col-11{width:91.66667%}.md-col-12{width:100%}}@media (min-width: 64rem){.lg-col{float:left;box-sizing:border-box}.lg-col-right{float:right;box-sizing:border-box}.lg-col-1{width:8.33333%}.lg-col-2{width:16.66667%}.lg-col-3{width:25%}.lg-col-4{width:33.33333%}.lg-col-5{width:41.66667%}.lg-col-6{width:50%}.lg-col-7{width:58.33333%}.lg-col-8{width:66.66667%}.lg-col-9{width:75%}.lg-col-10{width:83.33333%}.lg-col-11{width:91.66667%}.lg-col-12{width:100%}}.flex{display:-webkit-box;display:flex}@media (min-width: 40.06rem){.sm-flex{display:-webkit-box;display:flex}}@media (min-width: 52.06rem){.lg-flex{display:-webkit-box;display:flex}}.flex-column{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{-webkit-box-align:start;align-items:flex-start}.items-end{-webkit-box-align:end;align-items:flex-end}.items-center{-webkit-box-align:center;align-items:center}.items-baseline{-webkit-box-align:baseline;align-items:baseline}.items-stretch{-webkit-box-align:stretch;align-items:stretch}.self-start{align-self:flex-start}.self-end{align-self:flex-end}.self-center{align-self:center}.self-baseline{align-self:baseline}.self-stretch{align-self:stretch}.justify-start{-webkit-box-pack:start;justify-content:flex-start}.justify-end{-webkit-box-pack:end;justify-content:flex-end}.justify-center{-webkit-box-pack:center;justify-content:center}.justify-between{-webkit-box-pack:justify;justify-content:space-between}.justify-around{justify-content:space-around}.justify-evenly{-webkit-box-pack:space-evenly;justify-content:space-evenly}.content-start{align-content:flex-start}.content-end{align-content:flex-end}.content-center{align-content:center}.content-between{align-content:space-between}.content-around{align-content:space-around}.content-stretch{align-content:stretch}.flex-auto{-webkit-box-flex:1;flex:1 1 auto;min-width:0;min-height:0}.flex-none{-webkit-box-flex:0;flex:none}.order-0{-webkit-box-ordinal-group:1;order:0}.order-1{-webkit-box-ordinal-group:2;order:1}.order-2{-webkit-box-ordinal-group:3;order:2}.order-3{-webkit-box-ordinal-group:4;order:3}.order-last{-webkit-box-ordinal-group:100000;order:99999}.relative{position:relative}.absolute{position:absolute}.fixed{position:fixed}.top-0{top:0}.right-0{right:0}.bottom-0{bottom:0}.left-0{left:0}.z1{z-index:1}.z2{z-index:2}.z3{z-index:3}.z4{z-index:4}.border{border-style:solid;border-width:1px;border-width:1px}.border-top{border-top-style:solid;border-top-width:1px}.border-right{border-right-style:solid;border-right-width:1px}.border-bottom{border-bottom-style:solid;border-bottom-width:1px}.border-left{border-left-style:solid;border-left-width:1px}.border-none{border:0}.rounded{border-radius:3px}.circle{border-radius:50%}.rounded-top{border-radius:3px 3px 0 0}.rounded-right{border-radius:0 3px 3px 0}.rounded-bottom{border-radius:0 0 3px 3px}.rounded-left{border-radius:3px 0 0 3px}.not-rounded{border-radius:0}.hide{position:absolute;height:1px;width:1px;overflow:hidden;clip:rect(1px, 1px, 1px, 1px)}@media (max-width: 40rem){.xs-hide{display:none}}@media (min-width: 40.06rem) and (max-width: 52.06rem){.sm-hide{display:none}}@media (min-width: 52.06rem) and (max-width: 64rem){.md-hide{display:none}}@media (min-width: 64rem){.lg-hide{display:none}}.display-none{display:none}h1{font-weight:normal}.content em{font-weight:normal;font-style:normal}.content strong{font-weight:normal;font-size:1.5rem}.content .alert{font-weight:bold;color:#ff4136}.content a:hover{text-decoration:underline}.content ol{counter-reset:list}.content ol>li{list-style-position:none;position:relative;list-style:none;margin-top:5px;margin-bottom:5px}.content dd{padding:0;margin-right:0;margin-left:15pt}.content ul>li{margin:5px 0 5px 0}.content ul{padding:0 20px 0 20px}.content ol{padding:0 30px 0 30px}.content ol>li:before{content:"(" counter(list, decimal) ") ";counter-increment:list;position:absolute;left:-35px}.content blockquote{border-left:5px solid #333333;margin:10px 0 10px 0;padding:0px 8px 0px 8px;font-style:normal}.content h2{border-bottom:1px solid #5af;font-weight:normal;margin:1rem 0 0 0;padding:0}.content h3{border-bottom:1px dashed #4ae;font-weight:normal;margin:1rem 0 0 0}.content h4{border-bottom:1px dotted #4ff;font-weight:normal;margin:1rem 0 0 0}.content h5{border-bottom:1px dashed #333333;font-weight:normal;font-size:1rem;margin:1rem 0 0 0}.content h6{border-bottom:1px dotted #333333;font-weight:normal;font-size:1rem;margin:1rem 0 0 0}.content p{text-align:justify;text-justify:inter-ideograph;hanging-punctuation:allow-end;font-feature-settings:"halt" 1}html{height:100%;-ms-text-size-adjust:100%;font-size:15pt;font-family:"Inconsolata","游ゴシック体",YuGothic,"游ゴシック","Yu Gothic","メイリオ","Isfit+","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",Symbola}body{margin:0;line-height:1.25;min-width:315px;height:100%;overflow-x:hidden;font-smooth:always;-webkit-font-smoothing:antialiased;padding-top:5rem}wrapper{min-height:100%}main{display:block;margin:0 auto;max-width:800px}header{display:block;margin:0 auto;max-width:800px;box-shadow:0 6px 10px -10px rgba(0,0,0,0.7)}.logo{border-radius:80%}.gsearch{max-width:40vw;font-family:"Inconsolata","游ゴシック体",YuGothic,"游ゴシック","Yu Gothic","メイリオ","Isfit+","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",Symbola}.title-font{font-family:"Comic Neue","Inconsolata","游ゴシック体",YuGothic,"游ゴシック","Yu Gothic","メイリオ","Isfit+","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",Symbola}hr{padding:0;margin:8px 0;border:0;height:0;border-top:1px solid rgba(0,0,0,0.1);border-bottom:1px solid rgba(255,255,255,0.8)}footer{display:block;margin:0 auto}.icon-envelope{color:#242424}.icon-key{color:#ff8c00}.icon-keybase{color:#ff8c00}.icon-twitter{color:#55acee}.icon-facebook{color:#3B5998}.icon-github{color:#4c4c4c}.icon-mastodon{color:#3B5998}.icon-amp{color:#ff851b}.research li:nth-child(even){background-color:#f5f5f5}.small{font-size:80%}.doi{font-size:80%}#table-of-contents{margin:0;padding:0;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;border-bottom:1px solid rgba(0,0,0,0.1)}#table-of-contents h2{margin:0;padding:0;font-size:1rem;border:none;margin-right:1rem}#table-of-contents h2:after{content:":";padding:0;margin:0}#table-of-contents #text-table-of-contents ul{margin:0;padding:0}#table-of-contents #text-table-of-contents ul li{list-style:none;padding:0;display:inline-block}#table-of-contents #text-table-of-contents ul li+li:before{content:"/ ";padding:0;margin:0;color:#ccc}a{text-decoration:none;color:#18bc9c}a:hover{text-decoration:underline}@media (max-width: 40rem){body{padding-top:4.8rem}.wrapper{padding:0 .5rem;background-color:#fff}header{padding:0 .5rem;background-color:#fff}header input.navigation-input{display:none}header .navcontents{height:0;padding:0;margin:0;opacity:0;overflow:hidden}header input.navigation-input:checked~.navcontents{position:absolute;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;top:2rem;width:80vw;left:10vw;text-align:right;padding:10px;height:auto;opacity:1;background-color:#fff;box-shadow:0 6px 10px 0 rgba(0,0,0,0.7)}header input.navigation-input:checked~.navcontents div{font-size:1.25rem;margin:10px auto;width:100%;text-align:right}.dmenu input.dmenu-input{display:none;width:0}.dmenu label{text-decoration:none;color:#18bc9c}.dmenu input.dmenu-input:not(:checked)~.dcontents{display:none}.dmenu input.dmenu-input:checked~.dcontents{opacity:1;background-color:#fff}.dmenu input.dmenu-input:checked~.dcontents ul{background-color:#fff}.page-title{font-size:1.5rem}amp-img.profile-picture{height:4rem;width:4rem;position:relative;float:right;border-radius:50%;margin-right:10px;margin-top:-1.6rem;margin-left:1.6rem}#table-of-contents{display:none}footer{padding:0 .5rem}}@media (min-width: 40.06rem) and (max-width: 52.06rem){body{padding-top:4.8rem}.wrapper{padding:0 1rem;background-color:#fff}header{padding:0 1rem;background-color:#fff}header input.navigation-input{display:none}header .navcontents{height:0;padding:0;margin:0;opacity:0;overflow:hidden}header input.navigation-input:checked~.navcontents{position:absolute;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;top:2rem;width:80vw;left:10vw;text-align:right;padding:10px;height:auto;opacity:1;background-color:#fff;box-shadow:0 6px 10px 0 rgba(0,0,0,0.7)}header input.navigation-input:checked~.navcontents div{font-size:1.25rem;margin:10px auto;width:100%;text-align:right}.dmenu input.dmenu-input{display:none;width:0}.dmenu label{text-decoration:none;color:#18bc9c}.dmenu input.dmenu-input:not(:checked)~.dcontents{display:none}.dmenu input.dmenu-input:checked~.dcontents{opacity:1;background-color:#fff}.dmenu input.dmenu-input:checked~.dcontents ul{background-color:#fff}amp-img.profile-picture{height:8rem;width:8rem;position:relative;float:right;border-radius:50%;margin-right:10px;margin-top:-1.6rem;margin-left:1.6rem}footer{padding:0 1rem}}@media (min-width: 52.06rem) and (max-width: 64rem){body{padding-top:5rem}.wrapper{padding:0 2rem;background-color:#fff}header{padding:0 2rem;background-color:#fff}header .navigation-input{display:none}.dmenu input.dmenu-input{display:none;width:0}.dmenu label{text-decoration:none;color:#18bc9c}.dmenu .dcontents{position:absolute}.dmenu input.dmenu-input:not(:checked)~.dcontents{display:none}.dmenu input.dmenu-input:checked~.dcontents{opacity:1;background-color:#fff}.dmenu input.dmenu-input:checked~.dcontents ul{background-color:#fff}amp-img.profile-picture{height:8rem;width:8rem;position:relative;float:right;border-radius:50%;margin-top:0.9rem;margin-left:0.9rem}footer{padding:0 2rem}}@media (min-width: 64rem){body{padding-top:4rem}.wrapper{padding:0 4rem;background-color:#fff}header{background-color:#fff}header .navigation-input{display:none}.dmenu input.dmenu-input{display:none;width:0}.dmenu label{text-decoration:none;color:#18bc9c}.dmenu .dcontents{position:absolute}.dmenu input.dmenu-input:not(:checked)~.dcontents{display:none}.dmenu input.dmenu-input:checked~.dcontents{opacity:1;background-color:#fff}.dmenu input.dmenu-input:checked~.dcontents ul{background-color:#fff}amp-img.profile-picture{height:8rem;width:8rem;position:relative;float:right;border-radius:50%;margin-top:0.9rem;margin-left:0.9rem}footer{padding:0 4rem}}table{margin:15px 0;border-collapse:collapse;width:100%;padding:0}table tr{border-top:1px solid #cccccc;background-color:white;margin:0;padding:0}table tr:nth-child(2n){background-color:#f8f8f8}table tr th{font-weight:bold;border:1px solid #cccccc;text-align:left;margin:0;padding:6px 13px}table tr td{border:1px solid #cccccc;text-align:left;margin:0;padding:6px 13px}table tr th :first-child,table tr td :first-child{margin:0}table tr th :last-child,table tr td :last-child{margin:0}pre{font-size:100%;padding:5px 10px;margin:0 auto;color:#020202;background-color:#eeeeff;overflow:auto;border:2px;border-radius:3px;font-family:inherit}code{background-color:#eeeeff;color:#020202;weight:normal;font-family:inherit}figure.highlight{margin:0;padding:0;border:0;font-family:inherit}.highlight{padding:5px 10px;background-color:#eeeeff;color:#f8f8f2;font-family:inherit}.highlight .hll{background-color:#eeeeff}.highlight .c{color:#008800}.highlight .err{border:1px solid #FF0000}.highlight .k{color:#AA22FF;font-weight:bold}.highlight .o{color:#666666}.highlight .cm{color:#008800}.highlight .cp{color:#008800}.highlight .c1{color:#008800}.highlight .cs{color:#008800;font-weight:bold}.highlight .gd{color:#A00000}.highlight .gr{color:#FF0000}.highlight .gh{color:#000080;font-weight:bold}.highlight .gi{color:#00A000}.highlight .go{color:#808080}.highlight .gp{color:#000080;font-weight:bold}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#0040D0}.highlight .kc{color:#AA22FF;font-weight:bold}.highlight .kd{color:#AA22FF;font-weight:bold}.highlight .kn{color:#AA22FF;font-weight:bold}.highlight .kp{color:#AA22FF}.highlight .kr{color:#AA22FF;font-weight:bold}.highlight .kt{color:#00BB00;font-weight:bold}.highlight .m{color:#666666}.highlight .s{color:#BB4444}.highlight .na{color:#BB4444}.highlight .nb{color:#AA22FF}.highlight .nc{color:#0000FF}.highlight .no{color:#880000}.highlight .nd{color:#AA22FF}.highlight .ni{color:#999999;font-weight:bold}.highlight .ne{color:#D2413A;font-weight:bold}.highlight .nf{color:#00A000}.highlight .nl{color:#A0A000}.highlight .nn{color:#0000FF;font-weight:bold}.highlight .nt{color:#008000;font-weight:bold}.highlight .nv{color:#B8860B}.highlight .ow{color:#AA22FF;font-weight:bold}.highlight .w{color:#bbbbbb}.highlight .mf{color:#666666}.highlight .mh{color:#666666}.highlight .mi{color:#666666}.highlight .mo{color:#666666}.highlight .sb{color:#BB4444}.highlight .sc{color:#BB4444}.highlight .sd{color:#BB4444}.highlight .s2{color:#BB4444}.highlight .se{color:#BB6622;font-weight:bold}.highlight .sh{color:#BB4444}.highlight .si{color:#BB6688;font-weight:bold}.highlight .sx{color:#008000}.highlight .sr{color:#BB6688}.highlight .s1{color:#BB4444}.highlight .ss{color:#B8860B}.highlight .bp{color:#AA22FF}.highlight .vc{color:#B8860B}.highlight .vg{color:#B8860B}.highlight .vi{color:#B8860B}.highlight .il{color:#666666}span.anchor{display:none}.sanchor{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAAAAAA6I3INAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAOAAAADgCxW/H3AAAAH0lEQVQI12M4jAIYDv9HAni4hw/Tmgt3E1YuiqtQAAD5Nq+Ne1ON1gAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMi0wNy0zMVQxNTowNDowNCswOTowMONpTpcAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMDctMTAtMjhUMDc6NDY6MzArMDk6MDAE9UrdAAAAAElFTkSuQmCC);background-position:bottom right;background-repeat:no-repeat;padding:14px 14px 0px 0px;color:#fff;background-color:transparent;font-size:1px}.canchor{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAAAMAAAADADOpTJ+AAAAIElEQVQI12P4jwQYsHKOHDlCDAe3AVAOSDVcD24OAgAAVIGJOMkyXx4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTItMDctMzFUMTU6MDM6NTgrMDk6MDCO9TH+AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDA3LTEwLTI4VDA3OjQ2OjMwKzA5OjAwBPVK3QAAAABJRU5ErkJggg==);background-position:bottom right;background-repeat:no-repeat;padding:12px 12px 0px 0px;color:#fff;background-color:transparent;font-size:1px}.mail{display:none}.sanchor:before{display:block;content:" ";margin-top:-110px;height:110px;visibility:hidden}p.source{text-align:right;font-size:80%}p.source cite{font-style:normal}.day h2{font-size:1rem}.comment{display:none}.profile-picture{height:8rem;width:8rem;position:relative;float:right;border-radius:50%;margin-top:-.8rem}.tdiary-profile{width:70%}.tdiary-profile-picture{border-radius:50%}.footer{text-align:right;font-size:80%}.gsearch{max-width:40vw}@media (max-width: 40rem){.footer{padding:0 .5rem}}@media (min-width: 40.06rem) and (max-width: 52.06rem){.footer{padding:0 1rem}}@media (min-width: 52.06rem) and (max-width: 64rem){.footer{padding:0 2rem}}@media (min-width: 64rem){.footer{padding:0 4rem}}*[id]:before{display:block;content:" ";margin-top:-110px;height:110px;visibility:hidden}    </style>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  </head>
  <body>
    <!-- include: gdpr -->
    <amp-geo layout="nodisplay">
      <script type="application/json">
        {
            "ISOCountryGroups": {
                "eu": [ "preset-eea"]
            }
        }
      </script>
    </amp-geo>
    <amp-consent layout="nodisplay" id="consent-element">
      <script type="application/json">
        {
            "consents": {
                "my_consent": {
                    "promptIfUnknownForGeoGroup": "eu",
                    "promptUI": "consent-ui"
                }
            }
        }
      </script>
      <div id="consent-ui">
        I use cookies to analyze how visitors use my website via Google Analytics:
        <button on="tap:consent-element.accept" role="button">Accept</button>
        <button on="tap:consent-element.reject" role="button">Reject</button>
        <button on="tap:consent-element.dismiss" role="button">Dismiss</button>
      </div>
    </amp-consent>
    <!-- end include: gdpr -->
    <div class="wrapper">
      <!-- include: navbar -->
      <header class="container left-0 right-0 top-0 z4 fixed">
        <!-- page loop -->
        <nav class="navigation flex items-center justify-between">
          <div class="pr1 py1 order-0">
            <a href="/index.html">
              <amp-img layout="fixed"
                       width="1.2rem"
                       height="1.2rem"
                       src="/assets/img/top.png"
                       alt="About"
                       id="top"
                       class="logo left">
              </amp-img>
            </a>
          </div>
          <input type="checkbox" id="tm" class="navigation-input">
          <label for="tm" class="pl1 py1 order-3 md-hide lg-hide h2">☰</label>
          <div class="navcontents items-center md-flex lg-flex order-1">
          <!-- lang ja -->
            <div class="px1 py0">
              <a href="/research/index.html">
                Research
              </a>
            </div>
            <div class="dmenu px1 py0">
              <input type="checkbox" id="dmenu" class="dmenu-input">
              <label for="dmenu">Software &#9662;</label>
              <div class="dcontents">
                <ul class="list-reset p0 m0">
                  <li class="px1 py0">
                    <a href="/software/index.html">
                      Repository
                    </a>
                  </li>
                  <li class="px1 py0">
                    <a href="/cc-env/index.html">
                      Comp. Memo
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="px1 py1">
              <a href="https://uwabami.junkhub.org/log">blog</a>
            </div>
          </div>
          <div class="flex-auto"></div>
          <div class="px1 py0 order-2">
            <form method="GET"
                  class="p0 m0"
                  action="https://www.google.com/cse"
                  target="_top">
              <div class="inline-block relative p0 m0 small">
                <input name="cx" type="hidden"
                       value="017455171263919107349:oumnpe4bynr" />
                <input name="ie" type="hidden" value="UTF-8" />
                <input class="gsearch" type="search" placeholder="検索" name="q" required>
              </div>
            </form>
          </div>
          
        </nav>
        <div class="breadcrumbs">
          <div class="flex items-center">
            <!-- create crumbs -->
            <div class="pr1 py0">
              <a href="/index.html">
                Top
              </a>
            </div>
            &gt;<div class="px1"><a href="/cc-env/index.html">Cc-env</a></div>      <!-- end page loop -->
            <div class="flex-auto py0"></div>
            <div class="pr0 py0"><!-- end: lang selector -->
            </div>
          </div>
        </div>
      </header>
      <!-- end include: navbar -->
      <main role="main">
        <div class="container content">
          <h1 class="page-title my2 py0 px0">Emacs の設定</h1>
          <hr>
<!-- %%%% start content %%%% -->
<p>
Related <a href="index.html">Index</a> <a href="Emacs.html">Emacs</a>
</p>
<div>
<h2 id="org66fa74cd">はじめに</h2>
<div class="outline-text-2" id="text-org66fa74cd">
<p>
ここでは私の Emacs の設定についてまとめています．
</p>

<amp-img src="https://travis-ci.org/uwabami/emacs.svg?branch=master" width="72px" height="20px" layout="fixed" class="travis_badge"><amp-img src="https://travis-ci.org/uwabami/emacs.svg?branch=master" width="72px" height="20px" layout="fixed" class="travis_badge" fallback></amp-img><noscript><img src="https://travis-ci.org/uwabami/emacs.svg?branch=master" width="72px" height="20px" class="travis_badge"></noscript></amp-img>
<amp-img src="https://img.shields.io/badge/License-GPLv3-blue.svg" width="92px" height="20px" layout="fixed"><amp-img src="https://img.shields.io/badge/License-GPLv3-blue.svg" width="92px" height="20px" layout="fixed" fallback></amp-img><noscript><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" width="92px" height="20px"></noscript></amp-img>
<a href="https://github.com/uwabami/emacs"><span class="icon-github"><svg id="SVGRoot" width="20px" height="20px" version="1.1" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m5.4144 12.761c0 0.0645-0.0742 0.11613-0.16774 0.11613-0.10645 0.01-0.18064-0.0419-0.18064-0.11613 0-0.0645 0.0742-0.11613 0.16774-0.11613 0.0968-0.01 0.18064 0.0419 0.18064 0.11613zm-1.0032-0.14516c-0.0226 0.0645 0.0419 0.13871 0.13871 0.15806 0.0839 0.0323 0.18064 0 0.2-0.0645 0.0194-0.0645-0.0419-0.13871-0.13871-0.16775-0.0839-0.0226-0.17742 0.01-0.2 0.0742zm1.4258-0.0548c-0.0935 0.0226-0.15806 0.0839-0.14838 0.15806 0.01 0.0645 0.0935 0.10645 0.19032 0.0839 0.0936-0.0226 0.15806-0.0839 0.14839-0.14838-0.01-0.0613-0.0968-0.10323-0.19033-0.0935zm2.1226-12.361c-4.4742 0-7.8968 3.3968-7.8968 7.871 0 3.5774 2.2516 6.6387 5.4677 7.7161 0.41291 0.0742 0.55807-0.18064 0.55807-0.39032 0-0.2-0.01-1.3032-0.01-1.9806 0 0-2.2581 0.48387-2.7323-0.96129 0 0-0.36774-0.93871-0.89677-1.1806 0 0-0.73871-0.50645 0.0516-0.49677 0 0 0.80323 0.0645 1.2452 0.83226 0.70645 1.2452 1.8903 0.88709 2.3516 0.67419 0.0742-0.51613 0.28387-0.87419 0.51613-1.0871-1.8032-0.2-3.6226-0.46129-3.6226-3.5645 0-0.8871 0.24516-1.3323 0.76129-1.9-0.0839-0.20968-0.35806-1.0742 0.0839-2.1903 0.6742-0.20967 2.2258 0.87097 2.2258 0.87097 0.64516-0.18064 1.3387-0.27419 2.0258-0.27419 0.68709 0 1.3806 0.0936 2.0258 0.27419 0 0 1.5516-1.0839 2.2258-0.87097 0.44193 1.1194 0.16774 1.9806 0.0839 2.1903 0.51613 0.57096 0.83226 1.0161 0.83226 1.9 0 3.1129-1.9 3.3613-3.7032 3.5645 0.29678 0.25484 0.54839 0.73871 0.54839 1.4968 0 1.0871-0.01 2.4322-0.01 2.6968 0 0.20968 0.14839 0.46452 0.55807 0.39032 3.2258-1.071 5.4129-4.1322 5.4129-7.7097 0-4.4742-3.629-7.871-8.1032-7.871zm-4.7613 11.126c-0.0419 0.0323-0.0323 0.10646 0.0226 0.16775 0.0516 0.0516 0.12581 0.0742 0.16775 0.0323 0.0419-0.0323 0.0323-0.10645-0.0226-0.16774-0.0516-0.0516-0.12581-0.0742-0.16775-0.0323zm-0.34838-0.26129c-0.0226 0.0419 0.01 0.0935 0.0742 0.12581 0.0516 0.0323 0.11613 0.0226 0.13871-0.0226 0.0226-0.0419-0.01-0.0935-0.0742-0.12581-0.0645-0.0194-0.11613-0.01-0.13871 0.0226zm1.0452 1.1484c-0.0516 0.0419-0.0323 0.13871 0.0419 0.2 0.0742 0.0742 0.16775 0.0839 0.20968 0.0323 0.0419-0.0419 0.0226-0.13871-0.0419-0.2-0.071-0.0742-0.16775-0.0839-0.20968-0.0323zm-0.36774-0.47419c-0.0516 0.0323-0.0516 0.11613 0 0.19032 0.0516 0.0742 0.13871 0.10645 0.18064 0.0742 0.0516-0.0419 0.0516-0.1258 0-0.2-0.0452-0.0742-0.12903-0.10645-0.18064-0.0645z" fill="currentColor" stroke-width=".032258"></path></svg></span></a>

<p>
基本方針は以下の通り:
</p>
</div>
<div>
<h3 id="org5eaa4818">Debian パッケージがインストールされているならばそれを優先する</h3>
<div class="outline-text-3" id="text-org5eaa4818">
<p>
:<a href="https://en.wikipedia.org/wiki/Eating_your_own_dog_food">Eating your own dog food - Wikipedia</a>
</p>

<p>
Emacsに関連するDebianパッケージを幾つかメンテナンスしているので,
可能な限りDebianパッケージを使うことにしています．
</p>
</div>
</div>
<div>
<h3 id="orgd2ba4ef2">
<a href="https://github.com/conao3/leaf.el">leaf.el</a>でEmacs のパッケージの導入と設定を行なう</h3>
<div class="outline-text-3" id="text-orgd2ba4ef2">
<p>
設定には<a href="https://github.com/conao3/leaf.el">leaf.el</a>を利用します．
VCS からインストールしたいパッケージが幾つかあるので,
それらについては<a href="https://github.com/dimitri/el-get">el-get</a>を利用しています．
今後は<a href="https://github.com/conao3/feather.el">feather.el</a>も試してみたいですね．
</p>
</div>
</div>
<div>
<h3 id="org458d9cf4">設定は <a href="http://orgmode.org/">Org mode</a> で書きたい</h3>
<div class="outline-text-3" id="text-org458d9cf4">
<p>
以前こんなブログ記事を書きました→ <a href="http://uwabami.junkhub.org/log/20111213.html#p01">Emacsの設定ファイルをorgで書く</a>
</p>

<p>
というわけで, 設定は <a href="http://orgmode.org/worg/org-contrib/babel/intro.html">Org Babel</a> で書いています.
本ファイル(<code>README.org</code>) から,
Makefile 内の以下のスクリプトで <code>~/init.el</code> を生成し, byte-compile します.
</p>
<figure class="highlight"><pre><code class="language-makefile-gmake" data-lang="makefile-gmake">EMACS   ?= emacs
init.el: README.org
    $(EMACS) -Q -q --batch --eval \
       "(progn \
          (require 'ob-tangle) \
          (org-babel-tangle-file \"$&lt;\" \"$@\" \"emacs-lisp\"))"
    $(EMACS) -q -l init.el --batch --eval '(kill-emacs)'
%.elc: %.el
    $(EMACS) -q -l init.el -batch -f batch-byte-compile $&lt;</code></pre></figure>
<p>
ついでに, 出力される <code>init.el</code> 用のおまじない(?)として
<code>lexsical-binding</code> を有効にしておきます．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; -*- lexical-binding: nil -*-</span>
<span class="c1">;; (require 'profiler)</span>
<span class="c1">;; (profiler-start 'cpu)</span>
<span class="c1">;;</span>
<span class="c1">;; increase gc-cons-threshold duraring startup.</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">gc-cons-threshold</span> <span class="nv">most-positive-fixnum</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org60bad8a3">ディレクトリ構成の修正</h3>
<div class="outline-text-3" id="text-org60bad8a3">
<p>
分割した設定ファイル群やパッケージでinstallしたパッケージ
の置き場所は <code>user-emacs-directory</code> 以下にまとめています。
</p>

<p>
ディレクトリ構成は以下のようにしました:
</p>
<pre class="example">
    ~/.emacs.d/
     |-- Makefile    ←  byte-compile 用の rule
     |-- README.org  ←  本ファイル．`org-babel-tangle' で init.el を生成
     |-- pkg
     |   |-- elpa/   ←  package.el で導入したパッケージが置かれる場所
     |   `-- el-get/ ←  el-get で導入したパッケージが置かれる場所
     |-- share/      ←  (基本的に)参照するだけの資源置き場所
     `-- tmp/        ←  一次ファイルの置き場所
</pre>
<p>
上記ディレクトリ構成を設定ファイルで使用するために
ディレクトリ配置を宣言しておきます。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">when</span> <span class="nv">load-file-name</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">user-emacs-directory</span>
        <span class="p">(</span><span class="nv">expand-file-name</span> <span class="p">(</span><span class="nv">file-name-directory</span> <span class="nv">load-file-name</span><span class="p">))))</span>
<span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:share</span>
  <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"share/"</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:tmp</span>
  <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"tmp/"</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:pkg:elpa</span>
  <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"pkg/elpa"</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:pkg:elget</span>
  <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"pkg/el-get"</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">my:d</span> <span class="o">'</span><span class="p">(</span><span class="nv">my:d:share</span>
                <span class="nv">my:d:tmp</span>
                <span class="nv">my:d:pkg:elpa</span>
                <span class="nv">my:d:pkg:elget</span><span class="p">))</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
    <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">make-directory</span> <span class="nv">my:d</span> <span class="no">t</span><span class="p">))))</span></code></pre></figure>
<p>
その他, 良く使うディレクトリもここで設定しておきます．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:org</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)</span> <span class="s">"/Nextcloud/org/"</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org87c9febb">Byte-Compile 時の Common Lisp の読み込み</h3>
<div class="outline-text-3" id="text-org87c9febb">
<p>
幾つかの関数で <code>Common-Lisp</code> 的挙動が期待されているので,
<code>cl-lib</code> を読み込んでおきます．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">eval-and-compile</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'cl-lib</span> <span class="no">nil</span> <span class="no">t</span><span class="p">))</span>
<span class="c1">;; el-get が cl に依存しているので, ここで</span>
<span class="c1">;; `Package cl is deprecated' が表示されるのを止めておく.</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">byte-compile-warnings</span> <span class="o">'</span><span class="p">(</span><span class="nb">not</span> <span class="nv">cl-functions</span> <span class="nv">obsolete</span><span class="p">))</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="orgcf4176e7">Package 関連: <a href="https://emacs-jp.github.io/packages/package-management/package-el">package.el</a>, <a href="https://github.com/conao3/leaf.el">leaf.el</a>, <a href="https://github.com/dimitri/el-get">el-get</a>
</h2>
<div class="outline-text-2" id="text-orgcf4176e7">
<p>
<a href="https://github.com/conao3/leaf.el">leaf.el</a>のおかげで,
無いと途方に暮れるパッケージ以外のインストールは無視できるようになります.
</p>
</div>
<div>
<h3 id="orgc51eb87d"><a href="https://emacs-jp.github.io/packages/package-management/package-el">package.el</a></h3>
<div class="outline-text-3" id="text-orgc51eb87d">
<p>
パッケージは基本的に <code>pacakge.el</code> で導入するので, 先ずはその設定.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">eval-and-compile</span>
  <span class="p">(</span><span class="nv">custom-set-variables</span>
   <span class="o">'</span><span class="p">(</span><span class="nv">package-archives</span> <span class="o">'</span><span class="p">((</span><span class="s">"gnu"</span>   <span class="o">.</span> <span class="s">"https://elpa.gnu.org/packages/"</span><span class="p">)</span>
                        <span class="p">(</span><span class="s">"melpa"</span> <span class="o">.</span> <span class="s">"https://melpa.org/packages/"</span><span class="p">)</span>
                        <span class="p">))</span>
   <span class="o">'</span><span class="p">(</span><span class="nv">package-gnupghome-dir</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">".gnupg"</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)))</span>
   <span class="o">'</span><span class="p">(</span><span class="nv">package-user-dir</span> <span class="nv">my:d:pkg:elpa</span><span class="p">)</span>
   <span class="o">'</span><span class="p">(</span><span class="nv">package-enable-at-startup</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">gnutls-algorithm-priority</span> <span class="s">"NORMAL:-VERS-TLS1.3"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">eval-when-compile</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="p">(</span><span class="nv">locate-user-emacs-file</span> <span class="s">"tmp/bootstrap-stamp"</span><span class="p">))</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">gnutls-algorithm-priority</span> <span class="s">"NORMAL:-VERS-TLS1.3"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">package-refresh-contents</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">with-temp-buffer</span>
      <span class="p">(</span><span class="nv">write-file</span> <span class="p">(</span><span class="nv">locate-user-emacs-file</span> <span class="s">"tmp/bootstrap-stamp"</span><span class="p">)))</span>
    <span class="p">))</span>
<span class="p">(</span><span class="nv">package-initialize</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgc2ededbf"><a href="https://github.com/conao3/leaf.el">leaf.el</a></h3>
<div class="outline-text-3" id="text-orgc2ededbf">
<p>
個々のパッケージの設定には<a href="https://github.com/conao3/leaf.el">leaf.el</a>を利用します.
自分で修正した版やオリジナル版を別の場所から持ってくる場合は
<a href="https://github.com/conao3/leaf.el">leaf.el</a>から<a href="https://github.com/dimitri/el-get">el-get</a>を呼び出します.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">package-installed-p</span> <span class="ss">'leaf</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">package-refresh-contents</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">package-install</span> <span class="ss">'leaf</span> <span class="no">t</span><span class="p">))</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">leaf-keywords</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">blackout</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">el-get</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:preface</span>
    <span class="p">(</span><span class="nv">defconst</span> <span class="nv">el-get-dir</span> <span class="nv">my:d:pkg:elget</span><span class="p">)</span> <span class="c1">;; override el-get default</span>
    <span class="ss">:custom</span> <span class="p">((</span><span class="nv">el-get-notify-type</span>       <span class="o">.</span> <span class="ss">'message</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">el-get-git-shallow-clone</span> <span class="o">.</span> <span class="no">t</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">leaf-keywords-init</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org9abae8f2">
<code>exec-path-from-shell</code>: 環境変数の読み込み</h2>
<div class="outline-text-2" id="text-org9abae8f2">
<p>
shell(zsh)で設定した <code>PATH</code> などの環境変数をEmacsに引き継ぐために
<a href="https://github.com/purcell/exec-path-from-shell">purcell/exec-path-from-shell</a> を使います.
今の所
</p>
<ul class="org-ul">
<li><code>SHELL</code></li>
<li><code>DEBFULLNAME</code></li>
<li><code>DEBEMAIL</code></li>
<li><code>TEXMFHOME</code></li>
<li><code>SKKSERVER</code></li>
<li><code>http_proxy</code></li>
<li><code>GPG_KEY_ID</code></li>
<li><code>GPG_AGENT_INFO</code></li>
<li><code>PASSWORD_STORE_DIR</code></li>
<li><code>PATH</code></li>
</ul>
<p>
を読み込んでいます(多いな…).
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">exec-path-from-shell</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:defun</span> <span class="p">(</span><span class="nv">exec-path-from-shell-initialize</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">exec-path-from-shell-check-startup-files</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">exec-path-from-shell-variables</span>
    <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">"SHELL"</span>
        <span class="s">"DEBFULLNAME"</span>
        <span class="s">"DEBEMAIL"</span>
        <span class="s">"SKKSERVER"</span>
        <span class="s">"TEXMFHOME"</span>
        <span class="s">"http_proxy"</span>
        <span class="s">"GPG_KEY_ID"</span>
        <span class="s">"GPG_AGENT_INFO"</span>
        <span class="s">"PASSWORD_STORE_DIR"</span>
        <span class="s">"PATH"</span><span class="p">)))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">exec-path-from-shell-initialize</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">user-full-name</span>    <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"DEBFULLNAME"</span><span class="p">))</span>
        <span class="nv">user-mail-address</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"DEBEMAIL"</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:password-store</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"PASSWORD_STORE_DIR"</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">expand-file-name</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"Emacs/"</span> <span class="p">(</span><span class="nv">system-name</span><span class="p">))</span>
                          <span class="p">(</span><span class="nv">getenv</span> <span class="s">"PASSWORD_STORE_DIR"</span><span class="p">))</span>
      <span class="s">""</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org1a8b35da">認証関連: <code>plstore</code>, <code>password-store</code> など</h2>
<div class="outline-text-2" id="text-org1a8b35da">
<ul class="org-ul">
<li>
<code>leaf-plstore</code> で <code>plstore</code> が使えるようになったので,
その設定をしておく.</li>
<li>
<code>auth-password-store</code> で auth-source として <code>password-store</code> を使う.</li>
</ul>
<p>
といった事をしている.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*authentication</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"GPG_KEY_ID"</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d:password-store</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">leaf-default-plstore</span>
        <span class="p">(</span><span class="nv">plstore-open</span>
         <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"plstore.plist"</span> <span class="nv">my:d:password-store</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'vc-directory-exclusion-list</span>
               <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">my:d:password-store</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">auth-source</span>
    <span class="ss">:custom</span>
    <span class="o">`</span><span class="p">((</span><span class="nv">auth-source-gpg-encrypt-to</span> <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nv">getenv</span> <span class="s">"GPG_KEY_ID"</span><span class="p">))</span>
      <span class="c1">;; (auth-sources</span>
      <span class="c1">;; . ,(expand-file-name "authinfo.gpg" my:d:password-store))</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">password-store</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">auth-source-pass</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">plstore</span>
    <span class="ss">:custom</span>
    <span class="o">`</span><span class="p">((</span><span class="nv">plstore-secret-keys</span> <span class="o">.</span> <span class="ss">'silent</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">plstore-encrypt-to</span>  <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">getenv</span> <span class="s">"GPG_KEY_ID"</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org34ff2306">独自関数</h2>
<div class="outline-text-2" id="text-org34ff2306">
<p>
細かい独自関数, など．
</p>
</div>
<div>
<h3 id="org452a76a8">ファイル名を minibuffer におさまる様に整形</h3>
<div class="outline-text-3" id="text-org452a76a8">
<p>
zsh prompt風味．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">my:shorten-file-path</span> <span class="p">(</span><span class="nv">fpath</span> <span class="nv">max-length</span><span class="p">)</span>
  <span class="s">"Show up to `max-length' characters of a directory name `fpath' like zsh"</span>
  <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">path</span> <span class="p">(</span><span class="nb">reverse</span> <span class="p">(</span><span class="nv">split-string</span> <span class="p">(</span><span class="nv">abbreviate-file-name</span> <span class="nv">fpath</span><span class="p">)</span> <span class="s">"/"</span><span class="p">)))</span>
         <span class="p">(</span><span class="nv">output</span> <span class="s">""</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">top</span> <span class="p">(</span><span class="nv">mapconcat</span> <span class="ss">'identity</span> <span class="p">(</span><span class="nb">reverse</span> <span class="p">(</span><span class="nb">last</span> <span class="nv">path</span> <span class="mi">3</span><span class="p">))</span> <span class="s">"/"</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">vmax</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">max-length</span> <span class="mi">4</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">top</span><span class="p">)))</span>
         <span class="p">(</span><span class="nv">path</span> <span class="p">(</span><span class="nb">butlast</span> <span class="nv">path</span> <span class="mi">3</span><span class="p">))</span>
         <span class="p">)</span>
    <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">path</span>
                <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">output</span><span class="p">)</span> <span class="nv">vmax</span><span class="p">)</span>
                     <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">length</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"/"</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">path</span><span class="p">)</span> <span class="nv">output</span><span class="p">))</span> <span class="nv">vmax</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">output</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"/"</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">path</span><span class="p">)</span> <span class="nv">output</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">path</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">path</span><span class="p">)))</span>
    <span class="c1">;; 省略</span>
    <span class="p">(</span><span class="nb">when</span> <span class="nv">path</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">output</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"/..."</span> <span class="nv">output</span><span class="p">)))</span>
    <span class="p">(</span><span class="nb">format</span> <span class="s">"%s%s"</span> <span class="nv">top</span> <span class="nv">output</span><span class="p">)))</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org5b521483">空になったファイルを尋ねずに自動削除</h3>
<div class="outline-text-3" id="text-org5b521483">
<p>
ゴミが残らないし, 地味に便利．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*delete-file-if-no-contents</span>
  <span class="ss">:preface</span> <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:delete-file-if-no-contents</span> <span class="p">()</span>
             <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">buffer-file-name</span> <span class="p">(</span><span class="nv">current-buffer</span><span class="p">))</span>
                        <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-max</span><span class="p">)))</span>
               <span class="p">(</span><span class="nb">delete-file</span>
                <span class="p">(</span><span class="nv">buffer-file-name</span> <span class="p">(</span><span class="nv">current-buffer</span><span class="p">)))))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nv">memq</span> <span class="ss">'my:delete-file-if-no-contents</span> <span class="nv">after-save-hook</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">after-save-hook</span>
            <span class="p">(</span><span class="nb">cons</span> <span class="ss">'my:delete-file-if-no-contents</span> <span class="nv">after-save-hook</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orge279b0e0">scratch を殺さない. 消したら再生成</h3>
<div class="outline-text-3" id="text-orge279b0e0">
<p>
…元ネタがどこだったのか忘れてしまった…
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*keepscratchbuffer</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:make-scratch</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">arg</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">progn</span>
      <span class="c1">;; "*scratch*" を作成して buffer-list に放り込む</span>
      <span class="p">(</span><span class="nv">set-buffer</span> <span class="p">(</span><span class="nv">get-buffer-create</span> <span class="s">"*scratch*"</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">funcall</span> <span class="nv">initial-major-mode</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">erase-buffer</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">initial-scratch-message</span> <span class="p">(</span><span class="nb">not</span> <span class="nv">inhibit-startup-message</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">insert</span> <span class="nv">initial-scratch-message</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">or</span> <span class="nv">arg</span>
          <span class="p">(</span><span class="k">progn</span>
            <span class="p">(</span><span class="k">setq</span> <span class="nv">arg</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">switch-to-buffer</span> <span class="s">"*scratch*"</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nb">=</span> <span class="nv">arg</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">message</span> <span class="s">"*scratch* is cleared up."</span><span class="p">))</span>
            <span class="p">((</span><span class="nb">=</span> <span class="nv">arg</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nv">message</span> <span class="s">"another *scratch* is created"</span><span class="p">)))))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:buffer-name-list</span> <span class="p">()</span>
    <span class="p">(</span><span class="nb">mapcar</span> <span class="p">(</span><span class="k">function</span> <span class="nv">buffer-name</span><span class="p">)</span> <span class="p">(</span><span class="nv">buffer-list</span><span class="p">)))</span>
  <span class="ss">:hook</span>  <span class="p">((</span><span class="nv">kill-buffer-query-functions</span>
           <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
               <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">string=</span> <span class="s">"*scratch*"</span> <span class="p">(</span><span class="nv">buffer-name</span><span class="p">))</span>
                   <span class="p">(</span><span class="k">progn</span> <span class="p">(</span><span class="nv">my:make-scratch</span> <span class="mi">0</span><span class="p">)</span> <span class="no">nil</span><span class="p">)</span>
                 <span class="no">t</span><span class="p">)))</span>
          <span class="p">(</span><span class="nv">after-save-hook</span>
           <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
               <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nb">member</span> <span class="s">"*scratch*"</span> <span class="p">(</span><span class="nv">my:buffer-name-list</span><span class="p">))</span>
                 <span class="p">(</span><span class="nv">my:make-scratch</span> <span class="mi">1</span><span class="p">)))))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org1effd724">行末の無駄な空白/改行を削除する</h3>
<div class="outline-text-3" id="text-org1effd724">
<p>
@see <a href="http://d.hatena.ne.jp/tototoshi/20101202/1291289625">無駄な行末の空白を削除する(Emacs Advent Calendar jp:2010)</a>
</p>

<p>
ただし, RD や Markdown だと空白行に意味があったりするので,
必要に応じて拡張子で判断して外している．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*trailing-white-space</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defvar</span> <span class="nv">my:delete-trailing-whitespace-exclude-suffix</span>
    <span class="p">(</span><span class="nb">list</span> <span class="s">"\\.rd$"</span> <span class="s">"\\.md$"</span> <span class="s">"\\.rbt$"</span> <span class="s">"\\.rab$"</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:delete-trailing-whitespace</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">eval-when-compile</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'cl-lib</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">cond</span>
     <span class="p">((</span><span class="nb">equal</span> <span class="no">nil</span>
             <span class="p">(</span><span class="nv">cl-loop</span> <span class="nv">for</span> <span class="nv">pattern</span> <span class="nv">in</span> <span class="nv">my:delete-trailing-whitespace-exclude-suffix</span>
                      <span class="nv">thereis</span> <span class="p">(</span><span class="nv">string-match</span> <span class="nv">pattern</span> <span class="nv">buffer-file-name</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">delete-trailing-whitespace</span><span class="p">))))</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">before-save-hook</span> <span class="o">.</span> <span class="nv">my:delete-trailing-whitespace</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="orgadf8c6bf">言語の設定</h2>
<div class="outline-text-2" id="text-orgadf8c6bf">
<p>
最近のEmacsはlocaleから文字コードを自動判別するらしいので,
以前良く設定していた以下は不要らしいですね(ホントかな…?)。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">set-language-environment</span> <span class="s">"Japanese"</span><span class="p">)</span>
<span class="p">(</span><span class="nv">prefer-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-file-name-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-keyboard-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-terminal-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span>
<span class="p">(</span><span class="nv">set-default</span> <span class="ss">'buffer-file-coding-system</span> <span class="ss">'utf-8</span><span class="p">)</span></code></pre></figure>
<p>
なお, m17n.org の消滅によって上記設定に関する情報の参照元が消えた。
適切な参照元はどこだろう…?
</p>
</div>
<div>
<h3 id="org58d8e6f8">cp5022x.el</h3>
<div class="outline-text-3" id="text-org58d8e6f8">
<p>
Emacs23 から内部が Unicode ベースになっています。
</p>

<p>
しかし文字コードの変換はGNU libcのiconvをベースにしているため,
機種依存文字を含む文字コードの変換をうまく行なえません。
そこで言語設定前に <code>cp5022x.el</code> をインストールすることにしています。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">cp5022x</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">set-charset-priority</span> <span class="ss">'ascii</span> <span class="ss">'japanese-jisx0208</span> <span class="ss">'latin-jisx0201</span>
                        <span class="ss">'katakana-jisx0201</span> <span class="ss">'iso-8859-1</span> <span class="ss">'unicode</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">set-coding-system-priority</span> <span class="ss">'utf-8</span> <span class="ss">'euc-jp</span> <span class="ss">'iso-2022-jp</span> <span class="ss">'cp932</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org1927da44">主にEmacs本体, および同梱されている拡張に関する設定</h2>
<div class="outline-text-2" id="text-org1927da44">
</div>
<div>
<h3 id="orgd140a191">終了時に <code>custom.el</code> を消す</h3>
<div class="outline-text-3" id="text-orgd140a191">
<p>
設定ファイルに極力移す.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">cus-edit</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">custom-file</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"custom.el"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">custom-file</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"custom.el"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:hook</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">kill-emacs-hook</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
                         <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="nv">custom-file</span><span class="p">)</span>
                             <span class="p">(</span><span class="nb">delete-file</span> <span class="nv">custom-file</span><span class="p">)))))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgaee31636">
<code>customize</code> で設定していたアレコレ</h3>
<div class="outline-text-3" id="text-orgaee31636">
<p>
<code>custom.el</code> にある設定は極力こちらに移すようにしている.
</p>
<ul class="org-ul">
<li>
<code>gc-cons-threshold</code> はとりあえずデフォルトのままに.
<ul class="org-ul">
<li>メモリ喰いな拡張を入れている場合には,
安易に <code>gc-cons-threshold</code> を上げるのは考えものである.
「gc が走る→大きな領域を掃除するのでその間 emacs が止まる」
という事を頻繁に経験することになるだろう.</li>
<li>とはいえ, 起動時には結構 garbage-collect が走るので,
起動時はl <code>most-positive-fixnum</code> にしておいて,
起動後に <code>emacs-startup-hook</code> で default に戻すようにしてみた.</li>
<li>
<code>idle-timer</code> で入力が無い時に GC を走らせることにしてみた.</li>
</ul>
</li>
<li>大抵の場合ターミナル内で <code>-nw</code> として起動するし,
メニューは触ったことないので使わないので,
フレーム, ツールバー等を非表示にする．</li>
<li>
<code>.elc</code> と <code>.el</code> の timestamp を比較し, 新しい方を読み込む
(<code>load-prefer-newer</code> は Emacs &gt;= 24.4 から).</li>
<li>yes or no を y or n に</li>
</ul>
<p>
他にもイロイロと. 設定が増えてきたら分ける.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">cus-start</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span>
    <span class="c1">;; (garbage-collection-messages . t)</span>
    <span class="c1">;; 表示</span>
    <span class="p">(</span><span class="nv">tool-bar-mode</span>          <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">; 基本 "-nw" なので不要</span>
    <span class="p">(</span><span class="nv">scroll-bar-mode</span>        <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">; 基本 "-nw" なので不要</span>
    <span class="p">(</span><span class="nv">menu-bar-mode</span>          <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">; 基本 "-nw" なので不要</span>
    <span class="p">(</span><span class="nv">blink-cursor-mode</span>      <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">; 基本 "-nw" なので不要</span>
    <span class="p">(</span><span class="nv">column-number-mode</span>     <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">; 基本 "-nw" なので不要</span>
    <span class="p">(</span><span class="nv">ring-bell-function</span>     <span class="o">.</span> <span class="ss">'ignore</span><span class="p">)</span>   <span class="c1">; ベル無効化</span>
    <span class="c1">;; 編集</span>
    <span class="p">(</span><span class="nv">tab-width</span>              <span class="o">.</span> <span class="mi">4</span><span class="p">)</span>    <span class="c1">;; tab 幅 4</span>
    <span class="p">(</span><span class="nv">indent-tabs-mode</span>       <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">;; tab ではインデントしない</span>
    <span class="p">(</span><span class="nv">fill-column</span>            <span class="o">.</span> <span class="mi">72</span><span class="p">)</span>   <span class="c1">;; RFC2822 風味</span>
    <span class="p">(</span><span class="nv">truncate-lines</span>         <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">;; 折り返し無し</span>
    <span class="p">(</span><span class="nv">truncate-partial-width-windows</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">paragraph-start</span>        <span class="o">.</span> <span class="o">'</span><span class="s">"^\\([ 　・○&lt;\t\n\f]\\|(?[0-9a-zA-Z]+)\\)"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">auto-fill-mode</span>         <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">next-line-add-newlines</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>  <span class="c1">;; バッファ終端で newline を入れない</span>
    <span class="p">(</span><span class="nv">read-file-name-completion-ignore-case</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>  <span class="c1">; 大文字小文字区別無し</span>
    <span class="p">(</span><span class="nv">save-abbrevs</span>           <span class="o">.</span> <span class="ss">'silent</span><span class="p">)</span>
    <span class="c1">;; backup</span>
    <span class="p">(</span><span class="nv">auto-save-list-file-prefix</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">".saves-"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">auto-save-default</span>       <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">auto-save-timeout</span>       <span class="o">.</span> <span class="mi">15</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">auto-save-interval</span>      <span class="o">.</span> <span class="mi">60</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">make-backup-files</span>       <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">backup-by-copying</span>       <span class="o">.</span> <span class="no">t</span><span class="p">)</span>  <span class="c1">;; symlink は使わない</span>
    <span class="p">(</span><span class="nv">backup-directory-alist</span>  <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="s">"."</span> <span class="o">.</span> <span class="o">,</span><span class="nv">my:d:tmp</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">auto-save-file-name-transforms</span> <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="s">".*"</span> <span class="o">,</span><span class="nv">my:d:tmp</span> <span class="no">t</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">version-control</span>         <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">kept-new-versions</span>       <span class="o">.</span> <span class="mi">5</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">kept-old-versions</span>       <span class="o">.</span> <span class="mi">5</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">delete-old-versions</span>     <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">delete-auto-save-files</span>  <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; undo/redo - 数字に根拠無し</span>
    <span class="p">(</span><span class="nv">undo-limit</span>              <span class="o">.</span> <span class="mi">200000</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">undo-strong-limit</span>       <span class="o">.</span> <span class="mi">260000</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">history-length</span>          <span class="o">.</span> <span class="no">t</span><span class="p">)</span>  <span class="c1">;; 無制限(の筈)</span>
    <span class="c1">;; (save-silently           . t)</span>
    <span class="c1">;;</span>
    <span class="p">(</span><span class="nv">safe-local-variable-values</span>
     <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">org-link-file-path-type</span> <span class="o">.</span> <span class="nv">absolute</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">boundp</span> <span class="ss">'load-prefer-newer</span><span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">load-prefer-newer</span> <span class="no">t</span><span class="p">))</span>
  <span class="c1">;; yes or no を y or n に</span>
  <span class="p">(</span><span class="nv">fset</span> <span class="ss">'yes-or-no-p</span> <span class="ss">'y-or-n-p</span><span class="p">)</span>
  <span class="c1">;; GC</span>
  <span class="c1">;; Run GC every 60 seconds if emacs is idle.</span>
  <span class="p">(</span><span class="nv">run-with-idle-timer</span> <span class="mf">60.0</span> <span class="no">t</span> <span class="nf">#'</span><span class="nv">garbage-collect</span><span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span>
   <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
       <span class="p">(</span><span class="k">setq</span> <span class="nv">gc-cons-threshold</span> <span class="mi">800000</span><span class="p">)</span> <span class="c1">;; default</span>
       <span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org9eac26e0">
<code>startup</code>: 起動は静かに</h3>
<div class="outline-text-3" id="text-org9eac26e0">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">startup</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">inhibit-startup-screen</span>            <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">inhibit-startup-message</span>           <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">inhibit-startup-echo-area-message</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">initial-scratch-message</span>           <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org58ba514c">
<code>hl-mode</code>: 現在行のハイライト</h3>
<div class="outline-text-3" id="text-org58ba514c">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">hl-line</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">global-hl-line-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgd5c20561">選択リージョンに色付け</h3>
<div class="outline-text-3" id="text-orgd5c20561">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">simple</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">transient-mark-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org281c29f0">
<code>show-paren-mode</code>: 対応する括弧を強調表示</h3>
<div class="outline-text-3" id="text-org281c29f0">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">paren</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">show-paren-style</span>  <span class="o">.</span> <span class="ss">'mixed</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">show-paren-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgdd3a7c08">
<code>linum-mode</code> : 行番号表示</h3>
<div class="outline-text-3" id="text-orgdd3a7c08">
<p>
必要に応じて有効にするので, 基本使わない.
通常はモードラインに行番号や桁番号を表示しないようする.
ついでに <code>linum-mode</code> を有効にした場合の桁表示を 5 桁に.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">line-number-mode</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">linum-format</span>     <span class="o">.</span> <span class="s">"%5d "</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">line-number-mode</span> <span class="o">.</span> <span class="no">nil</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org45fe96c0">byte-compile 関連</h3>
<div class="outline-text-3" id="text-org45fe96c0">
<ul class="org-ul">
<li>debug は表示しない: 必要に応じて t に変更する</li>
<li>Compile-Log の非表示: ほとんど見ないし．</li>
<li>Warning の抑制: これもほとんど見ないし．</li>
</ul>
<p>
他にも増えそうだが
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">eval-and-compile</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">bytecomp</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">byte-compile-warnings</span> <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nb">not</span>
                                <span class="nv">obsolete</span>
                                <span class="nv">free-vars</span>
                                <span class="nv">unresolved</span>
                                <span class="nv">callargs</span>
                                <span class="nv">redefine</span>
                                <span class="nv">noruntime</span>
                                <span class="nv">cl-functions</span>
                                <span class="nv">interactive-only</span>
                                <span class="nv">make-local</span><span class="p">))</span>
     <span class="p">(</span><span class="nv">debug-on-error</span>        <span class="o">.</span> <span class="no">nil</span><span class="p">))</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">win</span> <span class="p">(</span><span class="nv">get-buffer-window</span> <span class="s">"*Compile-Log*"</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">when</span> <span class="nv">win</span> <span class="p">(</span><span class="nv">delete-window</span> <span class="nv">win</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org41afd6b6">
<code>autorevert</code>: ファイルが変更されたら再読み込み</h3>
<div class="outline-text-3" id="text-org41afd6b6">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">autorevert</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">auto-revert-interval</span> <span class="o">.</span> <span class="mf">0.1</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">global-auto-revert-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org246148ce">
<code>savehist</code>: 変更履歴を保存</h3>
<div class="outline-text-3" id="text-org246148ce">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">savehist</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">savehist-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"history"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:hook</span>
  <span class="p">((</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">savehist-mode</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org35f3de20">ファイル, デイレクトリ整理</h3>
<div class="outline-text-3" id="text-org35f3de20">
<p>
<code>~/.emacs.d/</code> 以下にファイルが転がるのがなんか嫌なので,
気がつく度に設定している.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*change-default-file-location</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span><span class="c1">;; url</span>
    <span class="p">(</span><span class="nv">url-configuration-directory</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"url"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="c1">;; nsm</span>
    <span class="p">(</span><span class="nv">nsm-settings-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"nsm.data"</span> <span class="nv">my:d:tmp</span> <span class="p">))</span>
    <span class="c1">;; bookmark</span>
    <span class="p">(</span><span class="nv">bookmark-default-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"bookmarks"</span> <span class="nv">my:d:share</span><span class="p">))</span>
    <span class="c1">;; eshell</span>
    <span class="p">(</span><span class="nv">eshell-directory-name</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"eshell"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<p>
他にもイロイロありそう．
<code>bookmark</code> はちゃんと使いこなしたい所ではあるが．
</p>
</div>
</div>
<div>
<h3 id="org6a5a84f9">
<code>eldoc</code>: emacs-lisp document</h3>
<div class="outline-text-3" id="text-org6a5a84f9">
<p>
minibuffer では eldoc にお黙り頂く。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">eldoc</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">emacs-lisp-mode-hook</span> <span class="o">.</span> <span class="nv">turn-on-eldoc-mode</span><span class="p">)</span>
  <span class="ss">:blackout</span> <span class="no">t</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:shutup-eldoc-message</span> <span class="p">(</span><span class="nv">f</span> <span class="k">&amp;optional</span> <span class="nb">string</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">active-minibuffer-window</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">funcall</span> <span class="nv">f</span> <span class="nb">string</span><span class="p">)))</span>
  <span class="ss">:advice</span>
  <span class="p">(</span><span class="ss">:around</span> <span class="nv">eldoc-message</span>
           <span class="nv">my:shutup-eldoc-message</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org2157dacb">
<code>midnight</code>: 一定期間使用しなかった buffer を自動削除</h3>
<div class="outline-text-3" id="text-org2157dacb">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">midnight</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">clean-buffer-list-delay-general</span> <span class="o">.</span> <span class="mi">1</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">midnight-mode</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org9a0cf611">
<code>uniquify</code>: モードラインのファイル名にディレクトリも表示する</h3>
<div class="outline-text-3" id="text-org9a0cf611">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">uniquify</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">uniquify-buffer-name-style</span> <span class="o">.</span> <span class="ss">'post-forward-angle-brackets</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">uniquify-min-dir-content</span>   <span class="o">.</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org68c5e01b">
<code>whitespace</code>: 空白の強調表示</h3>
<div class="outline-text-3" id="text-org68c5e01b">
<p>
背景も変えようかなぁ…
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">whitespace</span>
  <span class="ss">:blackout</span> <span class="p">((</span><span class="nv">global-whitespace-mode</span> <span class="o">.</span> <span class="s">""</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">whitespace-mode</span>        <span class="o">.</span> <span class="s">""</span><span class="p">))</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">after-init-hook</span> <span class="o">.</span> <span class="nv">global-whitespace-mode</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">whitespace-line-column</span>      <span class="o">.</span> <span class="mi">72</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">whitespace-style</span>
    <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nv">face</span>        <span class="c1">; faceを使う</span>
        <span class="nv">trailing</span>    <span class="c1">; 行末の空白を対象.</span>
        <span class="nv">tabs</span>        <span class="c1">; tab</span>
        <span class="nv">spaces</span>      <span class="c1">; space</span>
        <span class="p">))</span>
   <span class="p">(</span><span class="nv">whitespace-display-mappings</span> <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">space-mark</span> <span class="nv">?\u3000</span> <span class="nv">[?\□]</span><span class="p">)</span>
                                    <span class="p">(</span><span class="nv">tab-mark</span> <span class="nv">?\t</span> <span class="nv">[?\u00BB</span> <span class="nv">?\t]</span> <span class="nv">[?\\</span> <span class="nv">?\t]</span><span class="p">)))</span>
   <span class="p">(</span><span class="nv">whitespace-space-regexp</span>     <span class="o">.</span> <span class="s">"\\(\u3000+\\)"</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">whitespace-global-modes</span>     <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nb">not</span> <span class="nv">eww-mode</span>
                                        <span class="nv">term-mode</span>
                                        <span class="nv">eshell-mode</span>
                                        <span class="nv">org-agenda-mode</span>
                                        <span class="nv">calendar-mode</span><span class="p">))</span>
   <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org285d3b12">
<code>saveplace</code>: 前回の修正位置を記憶する.</h3>
<div class="outline-text-3" id="text-org285d3b12">
<p>
記憶の保存先を <code>~/.emacs.d/tmp/emacs-places</code> に変更.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">save-place</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">save-place</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">save-place-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"emacs-places"</span>  <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">save-place-mode</span><span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">save-place-ingore-files-regexp</span>
        <span class="p">(</span><span class="nb">format</span> <span class="s">"\\(%s\\)\\|\\(%s\\)"</span>
                <span class="nv">save-place-ignore-files-regexp</span>
                <span class="nv">tramp-file-name-regexp</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgd064b693">
<code>time-stamp</code>: 保存時に timestamp を自動更新</h3>
<div class="outline-text-3" id="text-orgd064b693">
<p>
デフォルトではいろいろと衝突したので
更新文字列を変更し,  <code>＄Lastupdate: 2</code> (＄は半角) があったら
timestamp を更新する様にした．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">time-stamp</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">before-save-hook</span> <span class="o">.</span> <span class="nv">time-stamp</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">time-stamp-active</span>     <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">time-stamp-line-limit</span> <span class="o">.</span> <span class="mi">10</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">time-stamp-start</span>      <span class="o">.</span> <span class="s">"$Lastupdate: 2"</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">time-stamp-end</span>        <span class="o">.</span> <span class="s">"\\$"</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">time-stamp-format</span>     <span class="o">.</span> <span class="s">"%Y-%02m-%02d %02H:%02M:%02S"</span><span class="p">)</span>
   <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<p>
モード独自の設定(例えば Org とか)に関しては別途．
</p>
</div>
</div>
<div>
<h3 id="org04853162">
<code>tramp</code>: ssh 越しにファイルを編集</h3>
<div class="outline-text-3" id="text-org04853162">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">tramp</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">tramp-persistency-file-name</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"tramp"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">tramp-persistency-file-name</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"tramp"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">tramp-completion-reread-directory-timeout</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">kill-emacs-hook</span>
   <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="nv">tramp-persistency-file-name</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">delete-file</span> <span class="nv">tramp-persistency-file-name</span><span class="p">))))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org456d3821"><code>browse-url</code></h3>
<div class="outline-text-3" id="text-org456d3821">
<p>
ブラウザ呼び出しは <code>xdg-open/open</code> に丸投げ.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">browse-url</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:bind</span> <span class="p">(</span><span class="s">"C-c C-j"</span> <span class="o">.</span> <span class="nv">browse-url-at-point</span><span class="p">)</span>
  <span class="ss">:defer-config</span>
  <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nv">executable-find</span> <span class="s">"xdg-open"</span><span class="p">)</span>
         <span class="p">(</span><span class="k">setq</span> <span class="nv">browse-url-browser-function</span> <span class="ss">'browse-url-xdg-open</span>
               <span class="nv">browse-url-secondary-browser-function</span> <span class="ss">'browse-url-xdg-open</span><span class="p">))</span>
        <span class="p">((</span><span class="nb">eq</span> <span class="nv">system-type</span> <span class="ss">'darwin</span><span class="p">)</span>
         <span class="p">(</span><span class="k">setq</span> <span class="nv">browse-url-browser-function</span> <span class="ss">'browse-url-default-macosx-browser</span>
               <span class="nv">browse-url-secondary-browser-function</span> <span class="ss">'browse-url-default-macosx-browser</span><span class="p">))</span>
        <span class="p">(</span><span class="no">t</span>
         <span class="c1">;; (setq browse-url-browser-function 'w3m-browse-url)</span>
         <span class="p">(</span><span class="k">setq</span> <span class="nv">browse-url-browser-function</span> <span class="ss">'eww-browse-url</span><span class="p">)</span>
         <span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org931fd3cc">
<code>server</code>: Emacs server</h3>
<div class="outline-text-3" id="text-org931fd3cc">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">server</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">server-running-p</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">server-start</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgdd48e2df">buffer の印刷</h3>
<div class="outline-text-3" id="text-orgdd48e2df">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ps-mule</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">ps-multibyte-buffer</span> <span class="o">.</span> <span class="ss">'non-latin-printer</span><span class="p">))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">defalias</span> <span class="ss">'ps-mule-header-string-charset</span> <span class="ss">'ignore</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org43970469">
<code>recentf</code>: 最近使ったファイル履歴の保管</h2>
<div class="outline-text-2" id="text-org43970469">
<p>
ファイルを開く際には <code>my:counsel-recentf</code> を使うので,
結局履歴を貯める設定をしている事になっている.
ディレクトリの履歴も取れるので recentf-ext を入れておく
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">recentf</span>
  <span class="ss">:defun</span>
  <span class="p">(</span><span class="nv">recentf-save-list</span> <span class="nv">recentf-cleanup</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">shut-up</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:init</span>
    <span class="p">(</span><span class="nb">defvar</span> <span class="nv">shut-up-ignore</span> <span class="no">t</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:recentf-save-list-silence</span> <span class="p">()</span>
    <span class="s">"Shut up"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">message-log-max</span> <span class="no">nil</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">shut-up</span> <span class="p">(</span><span class="nv">recentf-save-list</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">message</span> <span class="s">""</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:recentf-cleanup-silence</span> <span class="p">()</span>
    <span class="s">"Shut up"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">message-log-max</span> <span class="no">nil</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">shut-up</span> <span class="p">(</span><span class="nv">recentf-cleanup</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">message</span> <span class="s">""</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">recentf-ext</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="p">((</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="nv">recentf-mode</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">focus-out-hook</span>  <span class="o">.</span> <span class="nv">my:recentf-save-list-silence</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">focus-out-hook</span>  <span class="o">.</span> <span class="nv">my:recentf-cleanup-silence</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">recentf-save-file</span>       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"recentf"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">recentf-max-saved-items</span> <span class="o">.</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">recentf-auto-cleanup</span>    <span class="o">.</span> <span class="ss">'never</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">recentf-exclude</span>         <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">".recentf"</span>
                                 <span class="s">"^/tmp\\.*"</span>
                                 <span class="s">"^/private\\.*"</span>
                                 <span class="s">"^/var/folders\\.*"</span>
                                 <span class="s">"/TAGS$"</span>
                                 <span class="s">"\\.*草稿\\.*"</span>
                                 <span class="s">"^#\\.*"</span>
                                 <span class="s">"^/home/uwabami/.mozilla/\\.*"</span>
                                 <span class="s">"^/home/uwabami/.emacs.d/tmp/\\.*"</span>
                                 <span class="s">"^/home/uwabami/.dotfiles/Emacs/tmp/\\.*"</span>
                                 <span class="s">"^/[^/:]+:"</span>
                                 <span class="s">"bookmarks"</span>
                                 <span class="s">"org-recent-headings.dat"</span>
                                 <span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orgd903bf1d">
<code>all-the-icons-in-terminal</code>: ターミナルでもicon fontを使いたい。</h2>
<div class="outline-text-2" id="text-orgd903bf1d">
<p>
<a href="https://github.com/domtronn/all-the-icons.el">all-the-icons.el</a>のデータを修正して,
<a href="https://github.com/sebastiencs/icons-in-terminal">icons in terminal</a>を修正した
自作フォントのデータを読みに行くようにしてみました。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">all-the-icons</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:init</span> <span class="p">(</span><span class="nv">leaf</span> <span class="nv">memoize</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">all-the-icons-scale-factor</span>   <span class="o">.</span> <span class="mf">0.9</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">all-the-icons-default-adjust</span> <span class="o">.</span> <span class="mf">0.0</span><span class="p">))</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">all-the-icons-in-terminal</span>
  <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">all-the-icons-in-terminal</span>
           <span class="ss">:type</span> <span class="nv">github</span>
           <span class="ss">:pkgname</span> <span class="s">"uwabami/isfit-plus"</span><span class="p">)</span>
  <span class="ss">:after</span> <span class="nv">all-the-icons</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'all-the-icons-mode-icon-alist</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">f90-mode</span> <span class="nv">all-the-icons-faicon</span> <span class="s">"facebook"</span><span class="p">))</span> <span class="c1">;; facebook!?</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'all-the-icons-mode-icon-alist</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">wl-folder-mode</span> <span class="nv">all-the-icons-faicon</span> <span class="s">"folder-o"</span> <span class="p">))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'all-the-icons-mode-icon-alist</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">wl-summary-mode</span> <span class="nv">all-the-icons-faicon</span> <span class="s">"folder-open-o"</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'all-the-icons-mode-icon-alist</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">wl-draft-mode</span> <span class="nv">all-the-icons-material</span> <span class="s">"drafts"</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'all-the-icons-mode-icon-alist</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">mime-view-mode</span> <span class="nv">all-the-icons-faicon</span> <span class="s">"envelope-o"</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
<div>
<h3 id="orgd3ca00ac">
<span class="done SOMEDAY">SOMEDAY</span> East Asian Ambiguos 対応 <code>[0/1]</code>
</h3>
<div class="outline-text-3" id="text-orgd3ca00ac">
<p>
East Asian Ambiguosを2文字幅にして, ついでに
CJK 以外の East Asian Ambiguosと絵文字も2文字幅にするようにしています。
拙作の修正ロケールはこちら: <a href="https://github.com/uwabami/locale-eaw-emoji">https://github.com/uwabami/locale-eaw-emoji</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">locale-eaw-emoji</span>
  <span class="ss">:el-get</span> <span class="nv">uwabami/locale-eaw-emoji</span>
  <span class="ss">:after</span> <span class="nv">all-the-icons-in-terminal</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">eaw-and-emoji-fullwidth</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> 最近, EAWは一文字幅強制の方が良いかなぁ, とか悩み中.</li>
</ul>
</div>
</div>
<div>
<h3 id="orgcf967538">macOS対応</h3>
<div class="outline-text-3" id="text-orgcf967538">
<p>
最近良く触る様になったので設定している。
<del>まあ, イマイチ慣れない訳ですけれど</del>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*mac-encoding</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">eq</span> <span class="nv">system-type</span> <span class="ss">'darwin</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">ucs-normalize</span>
    <span class="ss">:require</span> <span class="no">t</span>
    <span class="ss">:defvar</span> <span class="p">(</span><span class="nv">mac-pass-control-to-system</span> <span class="nv">ns-command-modifier</span> <span class="nv">ns-alternate-modifier</span><span class="p">)</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="nv">set-file-name-coding-system</span> <span class="ss">'utf-8-hfs</span><span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">locale-coding-system</span> <span class="ss">'utf-8-hfs</span><span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">mac-pass-control-to-system</span> <span class="no">t</span>  <span class="c1">;; Ctrl を Mac から奪い取る</span>
          <span class="nv">ns-command-modifier</span> <span class="ss">'meta</span>     <span class="c1">;; Cmd と Option を逆にする</span>
          <span class="nv">ns-alternate-modifier</span> <span class="ss">'super</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">global-set-key</span> <span class="nv">[ns-drag-file]</span> <span class="ss">'ns-find-file</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org3416eeb2">
<span class="done SOMEDAY">SOMEDAY</span> Windows(WSL2)対応 <code>[/]</code>
</h3>
<div class="outline-text-3" id="text-org3416eeb2">
<figure class="highlight"><pre><code class="language-nil" data-lang="nil">;; nothing - -;</code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> 使う気になったら何かしなければならない, 気がしている</li>
</ul>
</div>
</div>
</div>
<div>
<h2 id="org7d9d4027">カレンダー設定</h2>
<div class="outline-text-2" id="text-org7d9d4027">
<p>
表示の更新と <code>japanese-holidays</code> による日本の休日の追加
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">calendar</span>
  <span class="ss">:custom</span>
  <span class="p">(</span><span class="c1">;; 祝日をカレンダーに表示</span>
   <span class="p">(</span><span class="nv">mark-holidays-in-calendar</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="c1">;; 月と曜日の表示調整</span>
   <span class="p">(</span><span class="nv">calendar-month-name-array</span> <span class="o">.</span> <span class="nv">[</span><span class="s">"01"</span> <span class="s">"02"</span> <span class="s">"03"</span> <span class="s">"04"</span> <span class="s">"05"</span> <span class="s">"06"</span>
                                 <span class="s">"07"</span> <span class="s">"08"</span> <span class="s">"09"</span> <span class="s">"10"</span> <span class="s">"11"</span> <span class="s">"12"</span> <span class="nv">]</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">calendar-day-name-array</span>   <span class="o">.</span> <span class="nv">[</span><span class="s">"日"</span> <span class="s">"月"</span> <span class="s">"火"</span> <span class="s">"水"</span> <span class="s">"木"</span> <span class="s">"金"</span> <span class="s">"土"</span><span class="nv">]</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">calendar-day-header-array</span> <span class="o">.</span> <span class="nv">[</span><span class="s">"日"</span> <span class="s">"月"</span> <span class="s">"火"</span> <span class="s">"水"</span> <span class="s">"木"</span> <span class="s">"金"</span> <span class="s">"土"</span><span class="nv">]</span><span class="p">)</span>
   <span class="c1">;; 日曜開始</span>
   <span class="p">(</span><span class="nv">calendar-week-start-day</span>   <span class="o">.</span> <span class="mi">0</span><span class="p">))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="s">"calendar"</span>
    <span class="p">(</span><span class="nv">leaf</span> <span class="nv">japanese-holidays</span>
      <span class="ss">:ensure</span> <span class="no">t</span>
      <span class="ss">:custom</span>
      <span class="p">((</span><span class="nv">japanese-holiday-weekend</span>         <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="mi">0</span> <span class="mi">6</span><span class="p">))</span>
       <span class="p">(</span><span class="nv">japanese-holiday-weekend-marker</span>  <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nv">holiday</span>  <span class="c1">;; 日</span>
                                             <span class="no">nil</span>      <span class="c1">;; 月</span>
                                             <span class="no">nil</span>      <span class="c1">;; 火</span>
                                             <span class="no">nil</span>      <span class="c1">;; 水</span>
                                             <span class="no">nil</span>      <span class="c1">;; 木</span>
                                             <span class="no">nil</span>      <span class="c1">;; 金</span>
                                             <span class="nv">japanese-holiday-saturday</span><span class="p">)))</span>
      <span class="ss">:hook</span>
      <span class="p">((</span><span class="nv">calendar-today-visible-hook</span>   <span class="o">.</span> <span class="nv">japanese-holiday-mark-weekend</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">calendar-today-invisible-hook</span> <span class="o">.</span> <span class="nv">japanese-holiday-mark-weekend</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">calendar-today-visible-hook</span>   <span class="o">.</span> <span class="nv">calendar-mark-today</span><span class="p">))</span>
      <span class="ss">:config</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">calendar-holidays</span> <span class="p">(</span><span class="nb">append</span> <span class="nv">japanese-holidays</span><span class="p">))</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org8aa6f45e">キーバインドの設定</h2>
<div class="outline-text-2" id="text-org8aa6f45e">
<p>
既に手癖になってしまっているアレコレ．
特に <code>[home]</code> と <code>[end]</code> は無いと途方に暮れます．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf-keys</span> <span class="p">((</span><span class="s">"C-h"</span>     <span class="o">.</span> <span class="nv">backward-delete-char</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c M-a"</span> <span class="o">.</span> <span class="nv">align-regexp</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c ;"</span>   <span class="o">.</span> <span class="nv">comment-region</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c M-;"</span> <span class="o">.</span> <span class="nv">uncomment-region</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-/"</span>     <span class="o">.</span> <span class="nv">undo</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c M-r"</span> <span class="o">.</span> <span class="nv">replace-regexp</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c r"</span>   <span class="o">.</span> <span class="nv">replace-string</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"&lt;home&gt;"</span>  <span class="o">.</span> <span class="nv">beginning-of-buffer</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"&lt;end&gt;"</span>   <span class="o">.</span> <span class="nv">end-of-buffer</span><span class="p">)</span>
            <span class="p">(</span><span class="s">"C-c M-l"</span> <span class="o">.</span> <span class="nv">toggle-truncate-lines</span><span class="p">)))</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org5d9ade19">
<code>migemo</code>: インクリメンタル検索</h2>
<div class="outline-text-2" id="text-org5d9ade19">
<p>
無いと途方に暮れる．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">migemo</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"cmigemo"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">'</span><span class="p">((</span><span class="nv">migemo-user-dictionary</span>  <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">migemo-regex-dictionary</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">migemo-options</span>          <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">"-q"</span> <span class="s">"--emacs"</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">migemo-command</span>          <span class="o">.</span> <span class="s">"cmigemo"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">migemo-coding-system</span>    <span class="o">.</span> <span class="ss">'utf-8-unix</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">cond</span>
   <span class="p">((</span><span class="nb">and</span> <span class="p">(</span><span class="nb">eq</span> <span class="nv">system-type</span> <span class="ss">'darwin</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">file-directory-p</span> <span class="s">"/usr/local/share/migemo/utf-8/"</span><span class="p">))</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">migemo-dictionary</span> <span class="s">"/usr/local/share/migemo/utf-8/migemo-dict"</span><span class="p">))</span>
   <span class="p">(</span><span class="no">t</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">migemo-dictionary</span> <span class="s">"/usr/share/cmigemo/utf-8/migemo-dict"</span><span class="p">)))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">migemo-init</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org35bd4bc4">
<span class="done SOMEDAY">SOMEDAY</span> <code>eww</code>: 内蔵ブラウザ <code>[0/3]</code>
</h2>
<div class="outline-text-2" id="text-org35bd4bc4">
<p>
リンクを簡単に辿る(Hit-a-Hint) のために <code>ace-link</code> も入れておく
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">eww</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"eww"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">make-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"eww"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">ace-link</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">addressbar</span>
    <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">addressbar</span>
             <span class="ss">:type</span> <span class="nv">github</span>
             <span class="ss">:pkgname</span> <span class="s">"lurdan/emacs-addressbar"</span><span class="p">)</span>
    <span class="ss">:custom</span>
    <span class="o">`</span><span class="p">((</span><span class="nv">addressbar-persistent-history-directory</span>
       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">addressbar-ignore-url-regexp</span>
       <span class="o">.</span> <span class="s">"\\(://duckduckgo\\.com/\\|google\\.com/search\\)"</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">addressbar-search-command-alist</span>
       <span class="o">.</span>  <span class="o">'</span><span class="p">(</span><span class="s">"g"</span> <span class="o">.</span> <span class="s">"https://google.com/search?&amp;gws_rd=cr&amp;complete=0&amp;pws=0&amp;tbs=li:1&amp;q="</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">addressbar-display-url-max-length</span> <span class="o">.</span> <span class="mi">60</span><span class="p">)</span>
      <span class="p">))</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">shr</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">shr-use-colors</span>    <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">shr-use-fonts</span>     <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">shr-image-animate</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">shr-width</span>         <span class="o">.</span> <span class="mi">72</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"&lt;f2&gt;"</span> <span class="o">.</span> <span class="nv">eww</span><span class="p">)</span>
         <span class="p">(</span><span class="ss">:eww-mode-map</span>
          <span class="p">(</span><span class="s">"r"</span>   <span class="o">.</span> <span class="nv">eww-reload</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"o"</span>   <span class="o">.</span> <span class="nv">eww</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"&amp;"</span>   <span class="o">.</span> <span class="nv">eww-browse-with-external-browser</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"b"</span>   <span class="o">.</span> <span class="nv">eww-back-url</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"]"</span>   <span class="o">.</span> <span class="nv">eww-next-url</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"["</span>   <span class="o">.</span> <span class="nv">eww-previous-url</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"g"</span>   <span class="o">.</span> <span class="nv">eww-top-url</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"+"</span>   <span class="o">.</span> <span class="nv">my:eww-increase-width</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"-"</span>   <span class="o">.</span> <span class="nv">my:eww-decrease-width</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"h"</span>   <span class="o">.</span> <span class="nv">backward-char</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"j"</span>   <span class="o">.</span> <span class="nv">next-line</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"k"</span>   <span class="o">.</span> <span class="nv">previous-line</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"l"</span>   <span class="o">.</span> <span class="nv">forward-char</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"/"</span>   <span class="o">.</span> <span class="nv">isearch-forward</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"?"</span>   <span class="o">.</span> <span class="nv">isearch-backward</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"n"</span>   <span class="o">.</span> <span class="nv">isearch-next</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"N"</span>   <span class="o">.</span> <span class="nv">isearch-previous</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"f"</span>   <span class="o">.</span> <span class="nv">ace-link-eww</span><span class="p">))</span>
         <span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">eww-bookmarks-directory</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"eww"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">eww-search-prefix</span>
     <span class="o">.</span> <span class="s">"https://www.google.com/search?&amp;gws_rd=cr&amp;complete=0&amp;pws=0&amp;tbs=li:1&amp;q="</span><span class="p">))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">ace-link-setup-default</span><span class="p">)</span>
  <span class="c1">;; :init</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; (defun eww-disable-images ()</span>
  <span class="c1">;;   "ewwで画像表示させない"</span>
  <span class="c1">;;   (interactive)</span>
  <span class="c1">;;   (setq-local shr-put-image-function 'shr-put-image-alt)</span>
  <span class="c1">;;   (eww-reload))</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; (defun eww-enable-images ()</span>
  <span class="c1">;;   "ewwで画像表示させる"</span>
  <span class="c1">;;   (interactive)</span>
  <span class="c1">;;   (setq-local shr-put-image-function 'shr-put-image)</span>
  <span class="c1">;;   (eww-reload))</span>
  <span class="c1">;; (defun shr-put-image-alt (spec alt &amp;optional flags)</span>
  <span class="c1">;;   (insert alt))</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; (defun eww-mode-hook--disable-image ()</span>
  <span class="c1">;;   (setq-local shr-put-image-function 'shr-put-image-alt))</span>
  <span class="c1">;; (add-hook 'eww-mode-hook 'eww-mode-hook--disable-image)</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> 背景色の指定</li>
<li class="off">
<code>[ ]</code> 幅の強制</li>
</ul>
</div>
</div>
<div>
<h2 id="orgd9b46f9c">
<span class="done SOMEDAY">SOMEDAY</span> <code>elscreen</code>: バッファー用 GNU screen もどき <code>[0/2]</code>
</h2>
<div class="outline-text-2" id="text-orgd9b46f9c">
<p>
emacs-jpのfolk版を利用中.
modeline の表示そのものは無効化しておく．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">elscreen</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">elscreen-display-tab</span>             <span class="o">.</span> <span class="mi">8</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">elscreen-tab-display-control</span>     <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">elscreen-display-screen-number</span>   <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">elscreen-prefix-key</span>              <span class="o">.</span> <span class="s">""</span><span class="p">)</span> <span class="c1">;; なんかカッコ悪いなぁ...</span>
   <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">elscreen-start</span><span class="p">)</span>
  <span class="p">)</span>
<span class="c1">;; (leaf elscreen-multi-term</span>
<span class="c1">;;   :el-get  wamei/elscreen-multi-term</span>
<span class="c1">;;  )</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> Debian パッケージ版は古い．更新すべき</li>
</ul>

<p>
ついでに elscreen⇔ zsh での連携を設定しておく.
詳細は
</p>
<ul class="org-ul">
<li><a href="https://masutaka.net/chalow/2011-09-28-1.html">ターミナルの zsh と Emacs を風のように駆け抜ける！</a></li>
<li><a href="http://syohex.hatenablog.com/entry/20111026/1319606395">cdeを改良</a></li>
<li><a href="https://qiita.com/__hage/items/2dd732b4dd68e124e8bd">cdeとelscreen-separate-buffer-listの相性が悪い</a></li>
</ul>
<p>
などを参照のこと.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">return-current-working-directory-to-shell</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">expand-file-name</span>
   <span class="p">(</span><span class="nv">with-current-buffer</span>
       <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">featurep</span> <span class="ss">'elscreen</span><span class="p">)</span>
           <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">frame-confs</span> <span class="p">(</span><span class="nv">elscreen-get-frame-confs</span> <span class="p">(</span><span class="nv">selected-frame</span><span class="p">)))</span>
                  <span class="p">(</span><span class="nv">num</span> <span class="p">(</span><span class="nb">nth</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'screen-history</span> <span class="nv">frame-confs</span><span class="p">)))</span>
                  <span class="p">(</span><span class="nv">cur-window-conf</span>
                   <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'window-configuration</span>
                          <span class="p">(</span><span class="nb">assoc</span> <span class="nv">num</span> <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'screen-property</span> <span class="nv">frame-confs</span><span class="p">))))</span>
                  <span class="p">(</span><span class="nv">marker</span> <span class="p">(</span><span class="nb">nth</span> <span class="mi">2</span> <span class="nv">cur-window-conf</span><span class="p">)))</span>
             <span class="p">(</span><span class="nv">marker-buffer</span> <span class="nv">marker</span><span class="p">))</span>
         <span class="p">(</span><span class="nb">nth</span> <span class="mi">1</span>
              <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'buffer-list</span>
                     <span class="p">(</span><span class="nb">nth</span> <span class="mi">1</span> <span class="p">(</span><span class="nb">nth</span> <span class="mi">1</span> <span class="p">(</span><span class="nv">current-frame-configuration</span><span class="p">))))))</span>
     <span class="nv">default-directory</span><span class="p">)))</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> <code>counsel-find-file</code> だと動作しないことがある. 謎</li>
</ul>
</div>
</div>
<div>
<h2 id="orgb83f65a0">日本語入力: <code>ddskk</code>
</h2>
<div class="outline-text-2" id="text-orgb83f65a0">
<p>
<a href="http://openlab.ring.gr.jp/skk/ddskk-ja.html">Daredevil SKK (DDSKK)</a> をメインで使用中．無いと途方に暮れる．
ちなみにGTKが有効になっていると <code>gtk-immodule</code> なんかと衝突するので
<code>~/.Xresources</code> で xim を無効にしておくと良い．
例えば以下の様に:
</p>
<figure class="highlight"><pre><code class="language-conf" data-lang="conf">! <span class="n">disable</span> <span class="n">XIM</span>
<span class="n">Emacs</span>*<span class="n">useXIM</span>: <span class="n">false</span></code></pre></figure>
</div>
<div>
<h3 id="orgeaefbd62">Emacs 本体側の設定(ddskk)</h3>
<div class="outline-text-3" id="text-orgeaefbd62">
<p>
実際の設定は別ファイルで行なわれるため
ここでは設定ファイルの位置変更を変更している．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defvar</span> <span class="nv">skk-user-directory</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:tmp</span> <span class="s">"skk"</span><span class="p">))</span>
<span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">skk-user-directory</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">make-directory</span> <span class="nv">skk-user-directory</span><span class="p">))</span>
<span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">locate-library</span> <span class="s">"skk"</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">package-install</span> <span class="ss">'ddskk</span> <span class="no">t</span><span class="p">))</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">skk</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x j"</span>   <span class="o">.</span> <span class="nv">skk-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x C-j"</span> <span class="o">.</span> <span class="nv">skk-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-\\"</span>    <span class="o">.</span> <span class="nv">skk-mode</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-init-file</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">user-emacs-directory</span> <span class="s">"init-ddskk"</span><span class="p">)</span>
        <span class="nv">default-input-method</span> <span class="s">"japanese-skk"</span> <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org03d84f47">DDSKK 本体の設定</h3>
<div class="outline-text-3" id="text-org03d84f47">
</div>
<div>
<h4 id="orgab495f21">基本動作</h4>
<div class="outline-text-4" id="text-orgab495f21">
<p>
byte-compile の為の読み込み
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">eval-when-compile</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'skk</span><span class="p">))</span></code></pre></figure>
<p>
sticky shift: <a href="http://homepage1.nifty.com/blankspace/emacs/sticky.html">sticky shift</a> を参照のこと.
ddskk の 14.2 以降から同梱されるようになった(ありがたい)
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-sticky-key</span> <span class="s">";"</span><span class="p">)</span></code></pre></figure>
<p>
変換候補の表示位置
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-show-candidates-always-pop-to-buffer</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
候補表示件数を2列に
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-henkan-number-to-display-candidates</span> <span class="mi">5</span><span class="p">)</span></code></pre></figure>
<p>
日本語表示しない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-japanese-message-and-error</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
メニューを日本語にしない -&gt; toolbar 非表示だし.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-show-japanese-menu</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
注釈の表示
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-show-annotation</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
インジケータの表示のカスタマイズ
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-latin-mode-string</span> <span class="s">"[_A]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-hiragana-mode-string</span> <span class="s">"[あ]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-katakana-mode-string</span> <span class="s">"[ア]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-jisx0208-latin-mode-string</span> <span class="s">"[Ａ]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-jisx0201-mode-string</span> <span class="s">"[_ｱ]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-abbrev-mode-string</span> <span class="s">"[aA]"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-indicator-use-cursor-color</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
インジケータを左端に表示
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-status-indicator</span> <span class="ss">'left</span><span class="p">)</span></code></pre></figure>
<p>
mode-line が動くのが許せないので, ちょっと修正
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">defadvice</span> <span class="nv">skk-make-indicator-alist</span>
    <span class="p">(</span><span class="nv">after</span> <span class="nv">my:set-skk-default-indicator</span> <span class="nv">activate</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">elem</span>
           <span class="o">'</span><span class="p">((</span><span class="nv">abbrev</span> <span class="s">" [aA]"</span> <span class="o">.</span> <span class="s">"--[aA]:"</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">latin</span> <span class="s">" [_A]"</span> <span class="o">.</span> <span class="s">"--[_A]:"</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">default</span> <span class="s">" [--]"</span> <span class="o">.</span> <span class="s">"--[--]:"</span><span class="p">))</span>
           <span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">ad-return-value</span>
          <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="nb">cons</span> <span class="nv">elem</span> <span class="no">nil</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">delq</span> <span class="p">(</span><span class="nb">assoc</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">elem</span><span class="p">)</span> <span class="nv">ad-return-value</span><span class="p">)</span> <span class="nv">ad-return-value</span><span class="p">)))))</span>
<span class="c1">;;</span>
<span class="c1">;;(setq skk-show-inline t)</span></code></pre></figure>
<p>
カーソルには色をつけない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-use-color-cursor</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
キーバインド
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">global-set-key</span> <span class="s">"\C-x\C-j"</span> <span class="ss">'skk-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="s">"\C-xj"</span> <span class="ss">'skk-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="s">"\C-j"</span> <span class="ss">'skk-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="s">"\C-\\"</span> <span class="ss">'skk-mode</span><span class="p">)</span></code></pre></figure>
<p>
半角カナを入力
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-use-jisx0201-input-method</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
Enter で改行しない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-egg-like-newline</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
"「"を入力したら"」"も自動で挿入
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-auto-insert-paren</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
句読点変換ルール
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-kuten-touten-alist</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="p">(</span><span class="nv">jp</span>    <span class="o">.</span> <span class="p">(</span><span class="s">"。"</span> <span class="o">.</span> <span class="s">"、"</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">jp-en</span> <span class="o">.</span> <span class="p">(</span><span class="s">"。"</span> <span class="o">.</span> <span class="s">", "</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">en-jp</span> <span class="o">.</span> <span class="p">(</span><span class="s">"．"</span> <span class="o">.</span> <span class="s">"，"</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">en</span>    <span class="o">.</span> <span class="p">(</span><span class="s">". "</span> <span class="o">.</span> <span class="s">", "</span><span class="p">))</span>
        <span class="p">))</span>
<span class="p">(</span><span class="nv">setq-default</span> <span class="nv">skk-kutouten-type</span> <span class="ss">'en</span><span class="p">)</span></code></pre></figure>
<p>
全角記号の変換: @ での日付入力は使わない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-rom-kana-rule-list</span>
      <span class="p">(</span><span class="nb">append</span> <span class="nv">skk-rom-kana-rule-list</span>
              <span class="o">'</span><span class="p">((</span><span class="s">"!"</span> <span class="no">nil</span> <span class="s">"!"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">":"</span> <span class="no">nil</span> <span class="s">":"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">";"</span> <span class="no">nil</span> <span class="s">";"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">"?"</span> <span class="no">nil</span> <span class="s">"?"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">"z "</span> <span class="no">nil</span> <span class="s">"　"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">"\\"</span> <span class="no">nil</span> <span class="s">"\\"</span><span class="p">)</span>
                <span class="p">(</span><span class="s">"@"</span> <span class="no">nil</span> <span class="s">"@"</span><span class="p">)</span>
                <span class="p">)))</span></code></pre></figure>
<p>
送り仮名が厳密に正しい候補を優先
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-henkan-strict-okuri-precedence</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
辞書の共有
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-share-private-jisyo</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
変換候補を縦に表示
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (setq skk-show-inline 'vertical)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-show-inline</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="orgb6cec722">辞書の設定</h4>
<div class="outline-text-4" id="text-orgb6cec722">
<p>
追加している辞書の一覧は
</p>
<ul class="org-ul">
<li><a href="http://www.chibutsu.org/jisho/">地球物理辞書</a></li>
<li><a href="http://www.geocities.jp/living_with_plasma/tanudic.html">天文・天体物理用語の漢字変換用辞書</a></li>
<li>はてなキーワード</li>
<li><a href="http://matsucon.net/material/dic/">2ちゃんねる顔文字辞書 MatsuCon</a></li>
<li><a href="http://matsucon.net/">MatsuCon</a></li>
</ul>
<p>
といった所.
はてなキーワードからの辞書の抽出は <a href="http://d.hatena.ne.jp/znz">znz</a> さんの
</p>
<ul class="org-ul">
<li><a href="http://rubyist.g.hatena.ne.jp/znz/20060924/p1">「はてなダイアリーキーワードふりがなリスト」を SKK の辞書に変換</a></li>
</ul>
<p>
を参考に.
<a href="http://matsucon.net/">MatsuCon</a> で公開されている顔文字に関しては
顔文字に ; や が含まれている場合に, 適宜quoteする必要があるので
以下のスクリプトで適当に変換.
</p>
<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s1">'nkf'</span>
<span class="n">src</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="no">ARGV</span><span class="p">.</span><span class="nf">size</span> <span class="o">&lt;</span> <span class="mi">1</span>
  <span class="nb">puts</span> <span class="s2">"usage: ime2skk.rb ime_dictionary"</span>
  <span class="nb">exit</span> <span class="mi">0</span>
<span class="k">end</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">f</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span>
    <span class="n">line_euc</span> <span class="o">=</span> <span class="no">NKF</span><span class="p">.</span><span class="nf">nkf</span><span class="p">(</span><span class="s2">"-S -e"</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line_euc</span> <span class="o">=~</span> <span class="sr">/^([^!]+?)\t(.+?)\t.+$/</span>
      <span class="n">entry</span> <span class="o">=</span> <span class="vg">$1</span>
      <span class="n">content</span> <span class="o">=</span> <span class="vg">$2</span>
      <span class="k">if</span> <span class="n">content</span> <span class="o">=~</span><span class="sr">/;/</span>
        <span class="nb">puts</span> <span class="n">entry</span> <span class="o">+</span> <span class="s2">" /(concat </span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">content</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s1">';'</span><span class="p">,</span><span class="s1">'\\\\073'</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">)/"</span>
      <span class="k">elsif</span> <span class="n">content</span> <span class="o">=~</span><span class="sr">/\//</span>
        <span class="nb">puts</span> <span class="n">entry</span> <span class="o">+</span> <span class="s2">" /(concat </span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">content</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span><span class="s1">'\\\\057'</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">)/"</span>
      <span class="k">else</span>
        <span class="nb">puts</span> <span class="n">entry</span> <span class="o">+</span> <span class="s2">" /"</span> <span class="o">+</span> <span class="n">content</span> <span class="o">+</span> <span class="s2">"/"</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="p">}</span></code></pre></figure>
<p>
他にも quote する必要あるような気もするけれど, それは気がついた時に.
</p>

<p>
辞書サーバがそもそも UTF-8 を扱えれば良いのだけれども.
辞書サーバの指定は以下.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">cond</span>
 <span class="p">((</span><span class="nv">getenv</span> <span class="s">"SKKSERVER"</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-server-host</span> <span class="s">"127.0.0.1"</span>
        <span class="nv">skk-server-portnum</span> <span class="s">"1178"</span>
        <span class="nv">skk-large-jisyo</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'skk-search-prog-list</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">skk-server-completion-search</span><span class="p">)</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'skk-search-prog-list</span>
               <span class="o">'</span><span class="p">(</span><span class="nv">skk-comp-by-server-completion</span><span class="p">)</span> <span class="no">t</span><span class="p">))</span>
 <span class="p">(</span><span class="no">t</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-get-jisyo-directory</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:tmp</span> <span class="s">"skk-jisyo"</span><span class="p">)</span>
        <span class="nv">skk-large-jisyo</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">skk-get-jisyo-directory</span> <span class="s">"/SKK-JISYO.L"</span><span class="p">)))</span>
 <span class="p">)</span>
<span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="s">"/usr/local/share/skkdic/SKK-JISYO.emoji.utf8"</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-extra-jisyo-file-list</span>
        <span class="p">(</span><span class="nb">list</span> <span class="o">'</span><span class="p">(</span><span class="s">"/usr/local/share/skkdic/SKK-JISYO.emoji.utf8"</span> <span class="o">.</span> <span class="nv">utf-8</span><span class="p">))))</span></code></pre></figure>
<p>
辞書登録の際に送り仮名を削除
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-check-okurigana-on-touroku</span> <span class="ss">'auto</span><span class="p">)</span></code></pre></figure>
<p>
漢字登録のミスをチェックする
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-check-okurigana-on-touroku</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
個人辞書の文字コード
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">skk-jisyo-code</span> <span class="ss">'utf-8-unix</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org0cbdad2e">インクリメンタルサーチ</h4>
<div class="outline-text-4" id="text-org0cbdad2e">
<p>
minibuffer 内では強制的に skk off.
インクリメンタルサーチは migemo に任せることに．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'skk-mode-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
            <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">skk-in-minibuffer-p</span><span class="p">)</span>
                 <span class="p">(</span><span class="nv">skk-mode-exit</span><span class="p">))))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">skk-isearch-start-mode</span> <span class="ss">'latin</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
</div>
<div>
<h2 id="orge3fb8a64">補完: <code>ido</code>
</h2>
<div class="outline-text-2" id="text-orge3fb8a64">
<p>
補完は <code>ido</code> が軽いし速いので好み.
見た目がちょっと簡素すぎる気もするので、なんとか弄りたい所ではある。
</p>
</div>
<div>
<h3 id="orgc92613c0">
<code>ido</code> の設定</h3>
<div class="outline-text-3" id="text-orgc92613c0">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ido</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">ido-completing-read+</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="c1">;; (leaf ido-describe-bindings :ensure t)</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x C-f"</span> <span class="o">.</span> <span class="nv">ido-find-file</span><span class="p">))</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:ido-disable-line-trucation</span> <span class="p">()</span>
    <span class="p">(</span><span class="nb">set</span> <span class="p">(</span><span class="nv">make-local-variable</span> <span class="ss">'truncate-lines</span><span class="p">)</span> <span class="no">nil</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:ido-remove-tramp-from-cache</span> <span class="no">nil</span>
    <span class="s">"Remove any TRAMP entries from `ido-dir-file-cache'.
    This stops tramp from trying to connect to remote hosts on emacs startup,
    which can be very annoying."</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">ido-dir-file-cache</span>
          <span class="p">(</span><span class="nv">cl-remove-if</span>
           <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">string-match</span> <span class="s">"/\\(rsh\\|ssh\\|telnet\\|su\\|sudo\\|sshx\\|krlogin\\|ksu\\|rcp\\|scp\\|rsync\\|scpx\\|fcp\\|nc\\|ftp\\|smb\\|adb\\):"</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)))</span>
           <span class="nv">ido-dir-file-cache</span><span class="p">)))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:ido-kill-emacs-hook</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">my:ido-remove-tramp-from-cache</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">ido-save-history</span><span class="p">))</span>
  <span class="ss">:advice</span> <span class="p">(</span><span class="ss">:override</span> <span class="nv">ido-kill-emacs-hook</span>
                     <span class="nv">my:ido-kill-emacs-hook</span><span class="p">)</span>
  <span class="ss">:hook</span> <span class="p">((</span><span class="nv">ido-setup-hook</span>
          <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
              <span class="p">(</span><span class="nv">define-key</span> <span class="nv">ido-completion-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">"C-h"</span><span class="p">)</span> <span class="ss">'ido-delete-backward-updir</span><span class="p">)</span>
              <span class="p">(</span><span class="nv">define-key</span> <span class="nv">ido-completion-map</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">"C-l"</span><span class="p">)</span> <span class="ss">'ido-delete-backward-updir</span><span class="p">)))</span>
         <span class="p">(</span><span class="nv">ido-minibuffer-setup-hook</span> <span class="o">.</span> <span class="nv">my:ido-disable-line-trucation</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="c1">;; 補完で無視する拡張子の追加．そのうち増える．</span>
  <span class="p">(</span><span class="nv">cl-loop</span> <span class="nv">for</span> <span class="nv">ext</span> <span class="nv">in</span>
           <span class="o">'</span><span class="p">(</span><span class="c1">;; TeX</span>
             <span class="s">".dvi"</span>
             <span class="s">".fdb_latexmk"</span>
             <span class="s">".fls"</span>
             <span class="s">".ilg"</span>
             <span class="s">".jqz"</span>
             <span class="s">".nav"</span>
             <span class="s">".out"</span>
             <span class="s">".snm"</span>
             <span class="s">".synctex\\.gz"</span>
             <span class="s">".vrb"</span>
             <span class="c1">;; fortran &gt;= 90</span>
             <span class="s">".mod"</span>
             <span class="c1">;; zsh</span>
             <span class="s">".zwc"</span>
             <span class="c1">;; libtool</span>
             <span class="s">".in"</span>
             <span class="s">".libs/"</span>
             <span class="c1">;; fxxkin Apple</span>
             <span class="s">".DS_Store"</span>
             <span class="s">"._DS_Store"</span>
             <span class="p">)</span>
           <span class="nb">do</span> <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'completion-ignored-extensions</span> <span class="nv">ext</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span><span class="c1">;; prefix match 入力を先頭一致可能</span>
    <span class="p">(</span><span class="nv">ido-enable-prefix</span>             <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="c1">;; TAB で名前の一致までその後 RET で実行</span>
    <span class="p">(</span><span class="nv">ido-confirm-unique-completion</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; . を prefix として扱う</span>
    <span class="p">(</span><span class="nv">ido-enable-dot-prefix</span>         <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="c1">;; flx matching を試す際には prefix を無効化すること</span>
    <span class="p">(</span><span class="nv">ido-enable-flex-matching</span>      <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;;</span>
    <span class="p">(</span><span class="nv">ido-default-file-method</span>       <span class="o">.</span> <span class="ss">'selected-window</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">ido-default-buffer-method</span>     <span class="o">.</span> <span class="ss">'selected-window</span><span class="p">)</span>
    <span class="c1">;; avoid [Too Big]</span>
    <span class="p">(</span><span class="nv">ido-max-directory-size</span>        <span class="o">.</span> <span class="mi">1000000</span><span class="p">)</span>
    <span class="c1">;; Tramp では無効化</span>
    <span class="p">(</span><span class="nv">ido-enable-tramp-completion</span>   <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="c1">;; ido-vertical も調べないとアカン様な.</span>
    <span class="p">(</span><span class="nv">ido-use-faces</span>                 <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; 拡張子には match しない</span>
    <span class="p">(</span><span class="nv">ido-ignore-extensions</span>         <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; 補完できない場合の挙動 ← "何もしない" は可能かな? nil?</span>
    <span class="p">(</span><span class="nv">ido-cannot-complete-command</span>   <span class="o">.</span> <span class="ss">'ido-next-match</span><span class="p">)</span>
    <span class="c1">;; 補完候補が無い場合に search を始める長さ ⇒ -1 で停止</span>
    <span class="p">(</span><span class="nv">ido-auto-merge-work-directories-length</span> <span class="o">.</span> <span class="mi">-1</span><span class="p">)</span>
    <span class="c1">;; 補完候補が無い場合に search を始める時間</span>
    <span class="c1">;; run-with-timer に与える値なので, とりあえず長め(30分)にしておく</span>
    <span class="p">(</span><span class="nv">ido-auto-merge-delay-time</span>     <span class="o">.</span> <span class="mi">1800</span><span class="p">)</span>
    <span class="c1">;; 補完結果の保存</span>
    <span class="p">(</span><span class="nv">ido-save-directory-list-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"ido.last"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">ido-mode</span> <span class="no">t</span><span class="p">)</span>
  <span class="c1">;; (ido-everywhere t)   ; &lt;- 過去の選択を覚えている奴と相性悪い.</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org72b78bcc">
<code>flx-ido</code>: flex match の強化</h3>
<div class="outline-text-3" id="text-org72b78bcc">
<p>
曖昧マッチが非常に直感的になった．地味に便利で手放せない．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">flx-ido</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">flx-ido-use-faces</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">flx-ido-threshold</span> <span class="o">.</span> <span class="mi">10000</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nv">flx-ido-mode</span> <span class="mi">1</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orge285b835">
<code>ido-flx-with-migemo</code>: flx + migemo</h3>
<div class="outline-text-3" id="text-orge285b835">
<p>
これは便利だ
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ido-flex-with-migemo</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"cmigemo"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:after</span> <span class="p">(</span><span class="nv">flx</span> <span class="nv">migemo</span><span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">ido-flex-with-migemo-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgba1f040e">
<span class="done SOMEDAY">SOMEDAY</span> <code>ido-vertical-mode</code>: 候補を縦に並べて表示 <code>[/]</code>
</h3>
<div class="outline-text-3" id="text-orgba1f040e">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ido-vertical-mode</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:after</span> <span class="nv">all-the-icons-in-terminal</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:ido-indicator</span>
    <span class="o">'</span><span class="p">((((</span><span class="nc">class</span> <span class="nv">color</span><span class="p">)</span> <span class="p">(</span><span class="nv">background</span> <span class="nv">light</span><span class="p">))</span> <span class="ss">:foreground</span> <span class="s">"#FFBF7F"</span><span class="p">)</span>
      <span class="p">(((</span><span class="nc">class</span> <span class="nv">color</span><span class="p">)</span> <span class="p">(</span><span class="nv">background</span> <span class="nv">dark</span><span class="p">))</span> <span class="ss">:foreground</span> <span class="s">"#FFBF7F"</span><span class="p">))</span>
    <span class="s">"Face used by Ido highlighting the arrow."</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span><span class="c1">;; 補完候補数の表示</span>
    <span class="p">(</span><span class="nv">ido-vertical-show-count</span>  <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; キーバインド</span>
    <span class="p">(</span><span class="nv">ido-vertical-define-keys</span> <span class="o">.</span> <span class="ss">'C-n-C-p-up-down-left-right</span><span class="p">)</span>
    <span class="c1">;; minibuffer の高さ制限</span>
    <span class="p">(</span><span class="nv">ido-max-window-height</span>    <span class="o">.</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="c1">;; 候補選択表示のカスタマイズ</span>
    <span class="p">(</span><span class="nv">ido-vertical-indicator</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nb">format</span> <span class="s">"%s"</span>
                <span class="p">(</span><span class="nv">all-the-icons-faicon</span> <span class="s">"hand-o-right"</span>
                                      <span class="ss">:face</span> <span class="ss">'my:ido-indicator</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nv">ido-vertical-mode</span> <span class="mi">1</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> Debian パッケージは古い．更新すること</li>
</ul>
</div>
</div>
<div>
<h3 id="org28528ad3"><code>amx</code></h3>
<div class="outline-text-3" id="text-org28528ad3">
<p>
M-x を ido で. 以前は smex を利用していたが, amx に乗り換えた.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">amx</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"M-x"</span> <span class="o">.</span> <span class="nv">amx</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span><span class="c1">;; backend 'ivy or 'ido or 'auto</span>
    <span class="p">(</span><span class="nv">amx-backend</span> <span class="o">.</span> <span class="ss">'ido</span><span class="p">)</span>
    <span class="c1">;; prompt</span>
    <span class="p">(</span><span class="nv">amx-prompt-string</span> <span class="o">.</span> <span class="s">"amx: "</span><span class="p">)</span>
    <span class="c1">;; keybind</span>
    <span class="p">(</span><span class="nv">amx-show-key-bindings</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="c1">;; 履歴</span>
    <span class="p">(</span><span class="nv">amx-save-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"amx-items"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">amx-history-length</span> <span class="o">.</span> <span class="mi">128</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org56240c5e">
<code>ido-recentf</code>: recentf を ido で</h3>
<div class="outline-text-3" id="text-org56240c5e">
<p>
"recentf-list" の結果を整形して, minibuffer に納まる様に縮小したり
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*ido-recentf-open</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">ido-recentf-open</span> <span class="p">()</span>
    <span class="s">"Use `ido-completing-read' to \\[find-file] a recent file"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">files</span> <span class="p">(</span><span class="nb">mapcar</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">f</span><span class="p">)</span>
                           <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nv">my:shorten-file-path</span> <span class="nv">f</span> <span class="mi">70</span><span class="p">)</span> <span class="nv">f</span><span class="p">))</span>
                         <span class="nv">recentf-list</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">selected</span> <span class="p">(</span><span class="nv">ido-completing-read</span> <span class="s">"Files: "</span> <span class="p">(</span><span class="nb">mapcar</span> <span class="nf">#'</span><span class="nb">car</span> <span class="nv">files</span><span class="p">))))</span>
        <span class="p">(</span><span class="nv">find-file</span> <span class="p">(</span><span class="nv">assoc-default</span> <span class="nv">selected</span> <span class="nv">files</span><span class="p">)))))</span>
  <span class="ss">:bind</span> <span class="p">(</span><span class="s">"C-x C-r"</span> <span class="o">.</span> <span class="nv">ido-recentf-open</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org7eb97621">ido-ghq</h3>
<div class="outline-text-3" id="text-org7eb97621">
<p>
ghq list を ido で選んで dired で開く
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ido-ghq</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"ghq"</span><span class="p">)</span>
  <span class="ss">:el-get</span> <span class="nv">uwabami/ido-ghq</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x f"</span> <span class="o">.</span> <span class="nv">ido-ghq-open</span><span class="p">))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">ido-ghq-short-list</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org15a06190">校正, 辞書等</h2>
<div class="outline-text-2" id="text-org15a06190">
</div>
<div>
<h3 id="orgc780f35e">
<code>redpen-paragraph</code>: <a href="http://redpen.cc/">redpen</a> による文章校正</h3>
<div class="outline-text-3" id="text-orgc780f35e">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">redpen-paragraph</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"redpen"</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">file-directory-p</span> <span class="s">"~/.config/redpen"</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:bind</span>
  <span class="p">((</span><span class="s">"C-c C-r"</span> <span class="o">.</span> <span class="nv">redpen-paragraph</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">((</span><span class="nv">LaTeX-mode-hook</span>
    <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
        <span class="p">(</span><span class="k">setq</span> <span class="nv">redpen-commands</span>
              <span class="o">'</span><span class="p">(</span>
                <span class="c1">;; for english command</span>
                <span class="s">"redpen -r json2 -c ~/.config/redpen/redpen-conf-en.xml -f latex %s 2&gt;/dev/null"</span>
                <span class="c1">;; for japanese command</span>
                <span class="s">"redpen -r json2 -c ~/.config/redpen/redpen-conf-ja.xml -f latex %s 2&gt;/dev/null"</span>
                <span class="p">)))</span>
    <span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">defvar</span> <span class="nv">redpen-commands</span>
    <span class="o">'</span><span class="p">(</span>
      <span class="c1">;; for english command</span>
      <span class="s">"redpen -r json2 -c ~/.config/redpen/redpen-conf-en.xml %s 2&gt;/dev/null"</span>
      <span class="c1">;; for japanese command</span>
      <span class="s">"redpen -r json2 -c ~/.config/redpen/redpen-conf-ja.xml %s 2&gt;/dev/null"</span>
      <span class="p">))</span>
  <span class="c1">;;redpen-paragraph-force-reading-whole t</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org3737a28e">
<code>ispell</code>: spell checker</h3>
<div class="outline-text-3" id="text-org3737a28e">
<p>
ispell はコマンドとして <code>aspell</code> を利用する.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ispell</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-executable-p</span> <span class="s">"aspell"</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">(</span><span class="nv">ispell-program-name</span> <span class="o">.</span> <span class="s">"aspell"</span><span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'ispell-skip-region-alist</span> <span class="o">'</span><span class="p">(</span><span class="s">"[^\000-\377]+"</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org820e6b6d">
<code>flyspell</code>: on-the-fly spell checker <code>[0/1]</code>
</h3>
<div class="outline-text-3" id="text-org820e6b6d">
<p>
flyspell-mode は別途有効化しておいた方が良いのかもしれない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">flyspell</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="p">(</span><span class="nv">flyspell-mode</span> <span class="o">.</span> <span class="s">"F"</span><span class="p">)</span>
  <span class="ss">:defun</span>
  <span class="nv">flyspell-emacs-popup-textual</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:flyspell-popup-choose</span> <span class="p">(</span><span class="nv">orig</span> <span class="nv">event</span> <span class="nv">poss</span> <span class="nv">word</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">window-system</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">funcall</span> <span class="nv">orig</span> <span class="nv">event</span> <span class="nv">poss</span> <span class="nv">word</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">flyspell-emacs-popup-textual</span> <span class="nv">event</span> <span class="nv">poss</span> <span class="nv">word</span><span class="p">)))</span>
  <span class="ss">:advice</span> <span class="p">(</span><span class="ss">:around</span> <span class="nv">flyspell-emacs-popup</span>
                   <span class="nv">my:flyspell-popup-choose</span><span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="c1">;; flyspell-prog-mode との switch が欲しい</span>
  <span class="p">((</span><span class="nv">LaTeX-mode-hook</span> <span class="o">.</span> <span class="nv">flyspell-mode</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> flyspell-prog-mode との switch が欲しい</li>
</ul>
</div>
</div>
<div>
<h3 id="org3002f57f">
<code>lookup</code>: 電子辞書の検索</h3>
<div class="outline-text-3" id="text-org3002f57f">
<p>
EPWING化した辞書群を検索するために <code>lookup-el</code> ver. 1.4 系列を利用
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">lookup</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="s">"/etc/emacs/site-start.d/50lookup-el.el"</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">file-exists-p</span> <span class="s">"/usr/local/share/dict/lookup-enabled"</span><span class="p">))</span>
  <span class="ss">:commands</span> <span class="p">(</span><span class="nv">lookup</span> <span class="nv">lookup-region</span> <span class="nv">lookup-pattern</span><span class="p">)</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-c w"</span> <span class="o">.</span> <span class="nv">lookup-pattern</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-c W"</span> <span class="o">.</span> <span class="nv">lookup-word</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="p">(</span><span class="nv">lookup-search-agents</span>
   <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/eijiro"</span> <span class="ss">:alias</span> <span class="s">"英辞郎"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/waeijiro"</span> <span class="ss">:alias</span> <span class="s">"和英辞郎"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/rikagaku5"</span> <span class="ss">:alias</span> <span class="s">"理化学辞典 第5版"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/koujien4"</span> <span class="ss">:alias</span> <span class="s">"広辞苑 第4版"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/wadai5"</span> <span class="ss">:alias</span> <span class="s">"研究社 和英大辞典 第5版"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/eidai6"</span> <span class="ss">:alias</span> <span class="s">"研究社 英和大辞典 第6版"</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">ndeb</span> <span class="s">"/usr/local/share/dict/colloc"</span> <span class="ss">:alias</span> <span class="s">"研究社 英和活用大辞典 "</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org12fd2b4e">Copy &amp; Paste:</h2>
<div class="outline-text-2" id="text-org12fd2b4e">
</div>
<div>
<h3 id="org1689d1f5">Linux では <code>xclip</code> を利用</h3>
<div class="outline-text-3" id="text-org1689d1f5">
<p>
clipboard と PRIMARY の同期には <code>gpaste</code> を使っている．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">xclip</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"xclip"</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">eq</span> <span class="nv">system-type</span> <span class="ss">'gnu/linux</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">xclip-mode</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgb2de5472">macOS では <code>pbcopy/pbpaste</code> を利用.</h3>
<div class="outline-text-3" id="text-orgb2de5472">
<p>
<code>pbcopy/pbpase</code> の呼び出し方が変わった? 動かない時がある様な。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*macOSclipborad</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">eq</span> <span class="nv">system-type</span> <span class="ss">'darwin</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:copy-from-osx</span> <span class="p">()</span>
    <span class="s">"Get string via pbpaste"</span>
    <span class="p">(</span><span class="nv">shell-command-to-string</span> <span class="s">"pbpaste"</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:paste-to-osx</span> <span class="p">(</span><span class="nv">text</span> <span class="k">&amp;optional</span> <span class="nb">push</span><span class="p">)</span>
    <span class="s">"put `TEXT' via pbcopy with `PUSH' mode"</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">process-connection-type</span> <span class="no">nil</span><span class="p">))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">proc</span> <span class="p">(</span><span class="nv">start-process</span> <span class="s">"pbcopy"</span> <span class="s">"*Messages*"</span> <span class="s">"pbcopy"</span><span class="p">)))</span>
        <span class="p">(</span><span class="nv">process-send-string</span> <span class="nv">proc</span> <span class="nv">text</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">process-send-eof</span> <span class="nv">proc</span><span class="p">))))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">interprogram-cut-function</span>   <span class="ss">'my:paste-to-osx</span>
        <span class="nv">interprogram-paste-function</span> <span class="ss">'my:copy-from-osx</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org5f756509">
<code>ibuffer</code>: buffer の操作</h2>
<div class="outline-text-2" id="text-org5f756509">
<p>
buffer を眺めるのは ibuffer が好み
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ibuffer</span>
  <span class="ss">:after</span> <span class="nv">all-the-icons-in-terminal</span>
  <span class="ss">:defun</span> <span class="p">(</span><span class="nv">ibuffer-current-buffer</span><span class="p">)</span>
  <span class="ss">:defvar</span> <span class="p">(</span><span class="nv">ibuffer-formats</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:ibuffer-find-file</span> <span class="p">()</span>
    <span class="s">"Like `find-file', but default to the directory of the buffer at point."</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">default-directory</span>
            <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">buf</span> <span class="p">(</span><span class="nv">ibuffer-current-buffer</span><span class="p">)))</span>
              <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">buffer-live-p</span> <span class="nv">buf</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">with-current-buffer</span> <span class="nv">buf</span>
                    <span class="nv">default-directory</span><span class="p">)</span>
                <span class="nv">default-directory</span><span class="p">))))</span>
      <span class="p">(</span><span class="nv">find-file</span> <span class="nv">default-directory</span><span class="p">)))</span>
  <span class="c1">;;</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x C-b"</span> <span class="o">.</span> <span class="nv">ibuffer-other-window</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x b"</span>   <span class="o">.</span> <span class="nv">ibuffer-other-window</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x M-b"</span> <span class="o">.</span> <span class="nv">ibuffer</span><span class="p">)</span>
         <span class="p">(</span><span class="ss">:ibuffer-mode-map</span>
          <span class="p">(</span><span class="s">"C-x C-f"</span> <span class="o">.</span> <span class="nv">my:ibuffer-find-file</span><span class="p">))</span>
         <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">define-ibuffer-column</span> <span class="nv">icon</span> <span class="p">(</span><span class="ss">:name</span> <span class="s">"  "</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">icon</span>
           <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">buffer-file-name</span><span class="p">)</span>
                    <span class="p">(</span><span class="nv">all-the-icons-auto-mode-match?</span><span class="p">))</span>
               <span class="p">(</span><span class="nv">all-the-icons-icon-for-file</span>
                <span class="p">(</span><span class="nv">file-name-nondirectory</span> <span class="p">(</span><span class="nv">buffer-file-name</span><span class="p">)))</span>
             <span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="nv">major-mode</span> <span class="p">))))</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">symbolp</span> <span class="nv">icon</span><span class="p">)</span>
          <span class="p">(</span><span class="k">setq</span> <span class="nv">icon</span>
                <span class="p">(</span><span class="nv">all-the-icons-faicon</span>
                 <span class="s">"file-o"</span>
                 <span class="ss">:face</span> <span class="ss">'all-the-icons-dsilver</span><span class="p">))</span>
        <span class="nv">icon</span><span class="p">)))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">ibuffer-formats</span>
        <span class="o">`</span><span class="p">((</span><span class="nv">mark</span> <span class="nv">modified</span> <span class="nv">read-only</span>
                <span class="s">" "</span> <span class="p">(</span><span class="nv">icon</span> <span class="mi">2</span> <span class="mi">2</span> <span class="ss">:left</span> <span class="ss">:elide</span><span class="p">)</span>
                <span class="o">,</span><span class="p">(</span><span class="nv">propertize</span> <span class="s">" "</span> <span class="ss">'display</span> <span class="o">`</span><span class="p">(</span><span class="nv">space</span> <span class="ss">:align-to</span> <span class="mi">8</span><span class="p">))</span>
                <span class="p">(</span><span class="nv">name</span> <span class="mi">18</span> <span class="mi">18</span> <span class="ss">:left</span> <span class="ss">:elide</span><span class="p">)</span>
                <span class="s">" "</span> <span class="p">(</span><span class="nv">size</span> <span class="mi">9</span> <span class="mi">-1</span> <span class="ss">:right</span><span class="p">)</span>
                <span class="s">" "</span> <span class="p">(</span><span class="nv">mode</span> <span class="mi">16</span> <span class="mi">16</span> <span class="ss">:left</span> <span class="ss">:elide</span><span class="p">)</span> <span class="s">" "</span> <span class="nv">filename-and-process</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">mark</span> <span class="s">" "</span> <span class="p">(</span><span class="nv">name</span> <span class="mi">16</span> <span class="mi">-1</span><span class="p">)</span> <span class="s">" "</span> <span class="nv">filename</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org2c2abb9b">
<code>wanderulst</code>: MUA の設定</h2>
<div class="outline-text-2" id="text-org2c2abb9b">
<p>
MUA として Wanderlust を使っている
</p>
<ul class="org-ul">
<li><a href="https://wanderlust.github.io/wl-docs/wl-ja.html">Wanderlust – Yet Another Message Interface On Emacsen –</a></li>
</ul>
</div>
<div>
<h3 id="org47a9ca66">Emacs 本体側の設定(wanderlust)</h3>
<div class="outline-text-3" id="text-org47a9ca66">
<p>
Emacs 本体での設定は以下の通り. Wanderlust 自体の設定は別ファイルで行なわれる．
ここでは <code>wl-init-file</code> を指定することで, 設定ファイルを明示している．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">wl</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-exists-p</span> <span class="s">"/etc/emacs/site-start.d/65wl-beta.el"</span><span class="p">)</span>
  <span class="ss">:commands</span> <span class="p">(</span><span class="nv">wl</span> <span class="nv">wl-other-frame</span> <span class="nv">wl-draft</span> <span class="nv">wl-user-agent</span> <span class="nv">wl-user-agent-compose</span> <span class="nv">wl-draft-send</span> <span class="nv">wl-draft-kill</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:wl-mode-line-buffer-identification</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">id</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">force-mode-line-update</span> <span class="no">t</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">defconst</span> <span class="nv">my:d:wl-cache-directory</span>
    <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"wanderlust"</span> <span class="s">"~/.cache"</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span>
           <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"local/Trash"</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">make-directory</span>
     <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"local/Trash"</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">)</span> <span class="no">t</span><span class="p">))</span>
  <span class="ss">:advice</span> <span class="p">(</span><span class="ss">:override</span> <span class="nv">wl-mode-line-buffer-identification</span>
                     <span class="nv">my:wl-mode-line-buffer-identification</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">elmo-msgdb-directory</span>     <span class="o">.</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">elmo-maildir-folder-path</span> <span class="o">.</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">elmo-cache-directory</span>     <span class="o">.</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">wl-score-files-directory</span> <span class="o">.</span> <span class="nv">my:d:wl-cache-directory</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">read-mail-command</span>        <span class="o">.</span> <span class="nf">#'</span><span class="nv">wl</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">wl-init-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"init-wl"</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">define-mail-user-agent</span>
    <span class="ss">'wl-user-agent</span>
    <span class="ss">'wl-user-agent-compose</span>
    <span class="ss">'wl-draft-send</span>
    <span class="ss">'wl-draft-kill</span>
    <span class="ss">'mail-send-hook</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<p>
割と <code>/etc/emacs/site-start.d/65wl-beta.el</code> と重複している気がするが…
</p>
</div>
</div>
<div>
<h3 id="org160184bf">Wanderlust 本体の設定</h3>
<div class="outline-text-3" id="text-org160184bf">
<p>
実際の設定は以下の通り
</p>
</div>
<div>
<h4 id="orge2af69a1">byte-compile の準備</h4>
<div class="outline-text-4" id="text-orge2af69a1">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">eval-and-compile</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">el-x</span>
    <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">el-x</span>
             <span class="ss">:type</span> <span class="nv">github</span>
             <span class="ss">:pkgname</span> <span class="s">"sigma/el-x"</span>
             <span class="ss">:build</span> <span class="o">`</span><span class="p">((</span><span class="s">"make"</span> <span class="o">,</span><span class="p">(</span><span class="nb">format</span> <span class="s">"EMACSBIN=%s"</span> <span class="nv">el-get-emacs</span><span class="p">)))</span>
             <span class="ss">:load-path</span> <span class="s">"lisp"</span>
             <span class="p">)</span>
    <span class="ss">:require</span> <span class="no">t</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nv">eval-when-compile</span>
  <span class="p">(</span><span class="nb">require</span> <span class="ss">'cp5022x</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">require</span> <span class="ss">'wl</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">require</span> <span class="ss">'mime-def</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org9638e017">依存/追加ライブラリのインストールと読み込み</h4>
<div class="outline-text-4" id="text-org9638e017">
</div>
<div>
<h5 id="org587385af">rail</h5>
<div class="outline-text-5" id="text-org587385af">
<p>
SEMI や FLIM などの UA の表示に <a href="http://uwabami.github.com/rail/">rail</a> を使っている.
ちなみに rail を有効にすると, 以下の様に User-Agent が表示される
</p>
<div class="col-7 px2 mx-auto">
<amp-img layout="responsive" width="640" height="400" src="https://uwabami.github.io/software/rail/wanderlust_with_or_without_rail.webp" alt="rail preview"><amp-img layout="responsive" width="640" height="400" src="https://uwabami.github.io/software/rail/wanderlust_with_or_without_rail.png" alt="rail preview" fallback></amp-img><noscript><img width="640" height="400" src="https://uwabami.github.io/software/rail/wanderlust_with_or_without_rail.png" alt="rail preview"></noscript></amp-img>
</div>

<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">rail</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">locate-library</span> <span class="s">"rail"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">el-get-bundle</span> <span class="nv">uwabami/rail</span><span class="p">))</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">rail-emulate-genjis</span> <span class="no">t</span><span class="p">)</span>
  <span class="ss">:require</span> <span class="no">t</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orga4113e25">cp5022x を使う</h5>
<div class="outline-text-5" id="text-orga4113e25">
<p>
ISO-2022-JP を CP50220 として扱う.
<a href="http://d.hatena.ne.jp/kiwanami/20091103/1257243524">Wanderlustと文字コード</a> も参照のこと.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'mime-charset-coding-system-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="nv">iso-2022-jp</span> <span class="o">.</span> <span class="nv">cp50220</span><span class="p">))</span>
<span class="c1">;; fxxkin outlook</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'mime-charset-coding-system-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="nv">gb2312</span> <span class="o">.</span> <span class="nv">gbk</span><span class="p">))</span>
<span class="c1">;;</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-mime-charset</span> <span class="ss">'iso-2022-jp</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgc4ec7a62">SEMI の追加設定</h5>
<div class="outline-text-5" id="text-orgc4ec7a62">
<p>
HTML メールを表示するために eww を使う.
mime-setup がロードされる前に記述する必要あり.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">mime-setup</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">w3m-load</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">mime-w3m</span> <span class="ss">:require</span> <span class="no">t</span><span class="p">)</span>
  <span class="c1">;; (setq mime-view-text/html-previewer 'shr</span>
  <span class="c1">;;       mime-setup-enable-inline-html 'shr)</span>
  <span class="c1">;; (defvar my:shr-width 72)</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; (defun my:shr-insert-document (&amp;rest them)</span>
  <span class="c1">;;   (let ((shr-width my:shr-width)) (apply them)))</span>
  <span class="c1">;; ;;</span>
  <span class="c1">;; (defun my:mime-shr-preview-text/html (&amp;rest args)</span>
  <span class="c1">;;   (advice-add 'shr-insert-document :around 'my:shr-insert-document)</span>
  <span class="c1">;;   (unwind-protect</span>
  <span class="c1">;;       (apply args)</span>
  <span class="c1">;;     (advice-remove 'shr-insert-document 'my:shr-insert-document)))</span>
  <span class="c1">;; :advice</span>
  <span class="c1">;; (:around mime-shr-preview-text/html</span>
  <span class="c1">;;          my:mime-shr-preview-text/html)</span>
  <span class="p">)</span></code></pre></figure>
<p>
どのアプリケーションで開くか → <code>xdg-open</code> に丸投げ．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (setq mime-view-mailcap-files '("~/.mailcap"))</span></code></pre></figure>
<p>
<code>~/.mailcap</code> 自体は以下
</p>
<figure class="highlight"><pre><code class="language-conf" data-lang="conf"><span class="n">applications</span>/*; <span class="n">xdg</span>-<span class="n">open</span> %<span class="n">s</span>;
<span class="n">image</span>/*; <span class="n">xdg</span>-<span class="n">open</span> %<span class="n">s</span>;
<span class="n">video</span>/*; <span class="n">xdg</span>-<span class="n">open</span> %<span class="n">s</span>;</code></pre></figure>
<p>
MIME の例の保存先の変更
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-situation-examples-file</span>
      <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:tmp</span> <span class="s">"mime-example"</span><span class="p">))</span></code></pre></figure>
<p>
text/plain より html を優先 <code>(- -;)</code>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-view-type-subtype-score-alist</span>
      <span class="o">'</span><span class="p">(((</span><span class="nv">text</span> <span class="o">.</span> <span class="nv">plain</span><span class="p">)</span> <span class="o">.</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">((</span><span class="nv">text</span> <span class="o">.</span> <span class="nv">html</span><span class="p">)</span>  <span class="o">.</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">))</span></code></pre></figure>
<p>
音を鳴らすアレやコレの無効化
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-play-find-every-situations</span> <span class="no">nil</span>
      <span class="nv">mime-play-delete-file-immediately</span> <span class="no">nil</span>
      <span class="nv">process-connection-type</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="org6dae78eb">個人情報の設定</h4>
<div class="outline-text-4" id="text-org6dae78eb">
<p>
具体的な設定内容は以下のファイルに置いている
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">load</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:password-store</span> <span class="s">"/wl-info.gpg"</span><span class="p">))</span></code></pre></figure>
<p>
設定している内容は以下の通り
</p>
</div>
<div>
<h5 id="org7f87384b">自身のメールアドレスと購読メーリングリストの設定</h5>
<div class="outline-text-5" id="text-org7f87384b">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; From: の設定</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-from</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">user-full-name</span> <span class="s">" &lt;"</span> <span class="nv">user-mail-address</span> <span class="s">"&gt;"</span><span class="p">))</span>
<span class="c1">;; (system-name) が FQDN を返さない場合、</span>
<span class="c1">;; `wl-local-domain' にホスト名を除いたドメイン名を設定</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-local-domain</span> <span class="s">"example.com"</span><span class="p">)</span>
<span class="c1">;; 自分のメールアドレスのリスト</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-user-mail-address-list</span>
      <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nv">wl-address-header-extract-address</span> <span class="nv">wl-from</span><span class="p">)</span>
            <span class="c1">;; "e-mail2@example.com"</span>
            <span class="c1">;; "e-mail3@example.net" ...</span>
            <span class="p">))</span>
<span class="c1">;; 自分の参加しているメーリングリストのリスト</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-subscribed-mailing-list</span>
      <span class="o">'</span><span class="p">(</span><span class="s">"wl@lists.airs.net"</span>
        <span class="s">"apel-ja@m17n.org"</span>
        <span class="s">"emacs-mime-ja@m17n.org"</span>
        <span class="c1">;; "ml@example.com" ...</span>
        <span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgba8bc2e7">送受信用サーバの設定</h5>
<div class="outline-text-5" id="text-orgba8bc2e7">
<p>
受信(IMAP)
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-imap4-default-server</span> <span class="s">"your imap server"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-imap4-default-port</span> <span class="ss">'993</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-imap4-default-stream-type</span> <span class="ss">'ssl</span><span class="p">)</span></code></pre></figure>
<p>
送信(SMTP)
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-smtp-posting-server</span> <span class="s">"your smtp server"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-smtp-posting-user</span> <span class="s">"your account"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-smtp-posting-port</span> <span class="mi">587</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-smtp-connection-type</span> <span class="ss">'starttls</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-smtp-authenticate-type</span> <span class="s">"login"</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org9af3a565">From に応じて送信サーバをきりかえる.</h5>
<div class="outline-text-5" id="text-org9af3a565">
<p>
本来はメール作成時/返信時の template の切り替えなのだれど,
送信時の SMTP の設定を from に合わせてきりかえるようにする.
default に二重に指定しているのは,
一度別のアカウントに切り替えた後に再びトグルして戻って来た際に元に戻す(上書き)するため.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-template-alist</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"default"</span>
         <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="nv">wl-from</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-server</span> <span class="o">.</span> <span class="s">"your smtp server"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-user</span> <span class="o">.</span> <span class="s">"your account"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-port</span> <span class="o">.</span> <span class="mi">587</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-connection-type</span> <span class="o">.</span> <span class="ss">'starttls</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-authenticate-type</span> <span class="o">.</span> <span class="s">"login"</span><span class="p">)</span>
         <span class="p">)</span>
        <span class="p">(</span><span class="s">"example1"</span>
         <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="s">"Your Name &lt;account@example1.com&gt;"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-server</span> <span class="o">.</span> <span class="s">"smtp.example1.com"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-user</span> <span class="o">.</span> <span class="s">"your account"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-port</span> <span class="o">.</span> <span class="mi">587</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-connection-type</span> <span class="o">.</span> <span class="ss">'starttls</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-authenticate-type</span> <span class="o">.</span> <span class="s">"login"</span><span class="p">)</span>
         <span class="p">)</span>
        <span class="p">(</span><span class="s">"example2"</span>
         <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="s">"Your Name &lt;account@example2.com&gt;"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-server</span> <span class="o">.</span> <span class="s">"smtp.example2.com"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-user</span> <span class="o">.</span> <span class="s">"your account"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-port</span> <span class="o">.</span> <span class="mi">587</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-connection-type</span> <span class="o">.</span> <span class="ss">'starttls</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-authenticate-type</span> <span class="o">.</span> <span class="s">"plain"</span><span class="p">)</span>
         <span class="p">)</span>
        <span class="p">(</span><span class="s">"ssh:smtp"</span>
         <span class="c1">;; need ssh tunnel</span>
         <span class="c1">;; ssh -f -N -L 20025:localhost:25 smtp.server.com</span>
         <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="s">"Your Name &lt;account@example3.com&gt;"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-server</span> <span class="o">.</span> <span class="s">"localhost"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-user</span> <span class="o">.</span> <span class="s">"your ssh account"</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-posting-port</span> <span class="o">.</span> <span class="mi">20025</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-connection-type</span> <span class="o">.</span> <span class="ss">'nil</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">wl-smtp-authenticate-type</span> <span class="o">.</span> <span class="ss">'nil</span><span class="p">)</span>
         <span class="p">)</span>
        <span class="p">))</span></code></pre></figure>
<p>
ssh tunnel を自動的にやる事はできないモンだろうか
(送信時に open して, 送信後に close する, みたいなの).
</p>

<p>
ついでに template の切り替えに関して幾つか設定.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; template 切り替え時に 内容を表示</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-template-visible-select</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
<code>draft-mode</code> で <code>C-c C-n</code> をするとテンプレートを切り替え
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-draft-mode-map</span> <span class="s">"\C-c\C-n"</span> <span class="ss">'wl-template-select</span><span class="p">)</span></code></pre></figure>
<p>
from に応じて wl-from, wl-envelope-from,
送信 smtp サーバを変更する送信時に変更
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'wl-draft-send-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
            <span class="p">(</span><span class="nb">set</span> <span class="p">(</span><span class="nv">make-local-variable</span> <span class="ss">'wl-from</span><span class="p">)</span>
                 <span class="p">(</span><span class="nv">std11-fetch-field</span> <span class="s">"From"</span><span class="p">))))</span></code></pre></figure>
<p>
送信時に自動的に wl-draft-config-alist を適用…しない?
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">remove-hook</span> <span class="ss">'wl-draft-send-hook</span> <span class="ss">'wl-draft-config-exec</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="org19ec5248">基本設定</h4>
<div class="outline-text-4" id="text-org19ec5248">
</div>
<div>
<h5 id="org69cc3854">imap 関連</h5>
<div class="outline-text-5" id="text-org69cc3854">
<p>
デフォルトの認証設定
フォルダ名は UTF-7 でエンコードされているので,
表示する際にこれをデコードする
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-imap4-use-modified-utf7</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org2d8166ce">非同期チェック</h5>
<div class="outline-text-5" id="text-org2d8166ce">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-folder-check-async</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org6572a382">フォルダの位置の default からの変更</h5>
<div class="outline-text-5" id="text-org6572a382">
<p>
<code>~/.cache/wanderlust/</code> に集約している
local の Mail folder の位置
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-maildir-folder-path</span> <span class="s">"~/.cache/wanderlust"</span>
      <span class="nv">elmo-localdir-folder-path</span> <span class="s">"~/.cache/wanderlust/local"</span><span class="p">)</span></code></pre></figure>
<p>
local フォルダの設定:
<code>.lost+found</code> は <code>elmo-maildir-folder-path</code> からの相対パスになっていることに注意
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-lost+found-folder</span> <span class="s">".lost+found"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-queue-folder</span> <span class="s">"+queue"</span><span class="p">)</span></code></pre></figure>
<p>
folders の位置の変更
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-folders-file</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:password-store</span> <span class="s">"/wl-folders.gpg"</span><span class="p">))</span></code></pre></figure>
<p>
Drafts, Trash の置き場所
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-draft-folder</span> <span class="s">"+Drafts"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-trash-folder</span> <span class="s">"+Trash"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-lost+found-folder</span> <span class="s">"+lost+found"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-temporary-file-directory</span> <span class="s">"~/Downloads/"</span><span class="p">)</span></code></pre></figure>
<p>
アドレス帳
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-use-petname</span> <span class="no">t</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-address-file</span>  <span class="s">"~/.mua/Address"</span><span class="p">)</span></code></pre></figure>
<p>
LDAP サーバからアドレスを引くことも可能.
以前は GCALDaemon を使って local に ldap サーバを上げていたのだけれども,
Google Contacts の API が変わったらしく
GCALDaemon で LDAP サーバは使えなくなったのでコメントアウト.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-use-ldap</span> <span class="no">t</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-ldap-server</span> <span class="s">"localhost"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-ldap-port</span> <span class="s">"389"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-ldap-base</span> <span class="s">"dc=math,dc=kyoto-u,dc=ac,dc=jp"</span><span class="p">)</span></code></pre></figure>
<p>
パスワードの保存先
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-passwd-alist-file-name</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">my:d:password-store</span> <span class="s">"/wl-passwd.gpg"</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org72bfee4a">フォルダ編集時に backup を作成しない.</h5>
<div class="outline-text-5" id="text-org72bfee4a">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-fldmgr-make-backup</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org223d5fa2">FCC, BCC の設定</h5>
<div class="outline-text-5" id="text-org223d5fa2">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-fcc</span> <span class="no">nil</span><span class="p">)</span>
<span class="c1">;; (setq wl-fcc "%Sent")</span></code></pre></figure>
<p>
fcc を既読にする場合は以下．=wl-fcc= が nil の場合には意味は無い
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-fcc-force-as-read</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
bcc は常に自身に.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-bcc</span> <span class="p">(</span><span class="nv">concat</span> <span class="nv">user-mail-address</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org4378f104">起動時に <code>%INBOX</code> のみをチェック</h5>
<div class="outline-text-5" id="text-org4378f104">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-auto-check-folder-name</span> <span class="s">"%INBOX"</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org6efc7670">フォルダ選択時の初期設定</h5>
<div class="outline-text-5" id="text-org6efc7670">
<p>
imap の namespace を毎度入力するのが面倒なので, これを追加しておく.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-default-spec</span> <span class="s">"%"</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgb2cf2b53">confirm 関連の設定</h5>
<div class="outline-text-5" id="text-orgb2cf2b53">
<p>
スキャン時の問い合わせの無効化.
ちなみに confirm を nil にしても 問い合わせが無いだけで
threshold は効くので, 明示的に nil に.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-folder-update-confirm</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-folder-update-threshold</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-message-fetch-confirm</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-message-fetch-threshold</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-prefetch-confirm</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-prefetch-threshold</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
終了時に確認しない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-interactive-exit</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
送信時は確認する
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-interactive-send</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org14b77860">misc.</h5>
<div class="outline-text-5" id="text-org14b77860">
<p>
大きいメッセージを送信時に分割しない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-edit-split-message</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
スレッドは常に閉じる
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-thread-insert-opened</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
3 pain 表示 -&gt; 使わない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-stay-folder-window</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
未読を優先的に読む
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-move-order</span> <span class="ss">'unread</span><span class="p">)</span></code></pre></figure>
<p>
改ページ無視
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-break-pages</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
icon を使わない → GUI でもメニュー表示してないし, 体感的には遅くなる
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-highlight-folder-with-icon</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org83490625">dispose, delete の設定</h5>
<div class="outline-text-5" id="text-org83490625">
<p>
Gmail用に%INBOXでは削除を <code>wl-trash-folder</code> への移動ではなく, 「delete」に．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'wl-dispose-folder-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">"^%INBOX"</span> <span class="o">.</span> <span class="nb">remove</span><span class="p">))</span></code></pre></figure>
<p>
迷惑メール関連も
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'wl-dispose-folder-alist</span>
             <span class="o">'</span><span class="p">(</span><span class="s">".*Junk$"</span> <span class="o">.</span> <span class="nb">remove</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgd88be525">折り返しの設定</h5>
<div class="outline-text-5" id="text-orgd88be525">
<p>
message は折り返す.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-truncate-lines</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
<p>
draft も折り返す
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-draft-truncate-lines</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgb31f5f2c">mode-line の設定</h5>
<div class="outline-text-5" id="text-orgb31f5f2c">
<p>
長いと嫌なのでイロイロ削る
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-mode-line-format</span> <span class="s">""</span><span class="p">)</span> <span class="c1">; "%f {%t}(%n/%u/%a)"</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-mode-line-format</span> <span class="s">""</span><span class="p">)</span> <span class="c1">; "&lt;&lt; %f:%F&gt;&gt; [%m]"</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="org51dfe1e0">キーバインド関連</h4>
<div class="outline-text-4" id="text-org51dfe1e0">
<p>
<code>C-c C-j</code> を browse-url に明け渡す
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-draft-mode-map</span> <span class="s">"\C-c\C-j"</span> <span class="ss">'browse-url-at-point</span><span class="p">)</span></code></pre></figure>
<p>
<code>M-u</code> で unread にする
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-summary-mode-map</span> <span class="s">"\M-u"</span> <span class="ss">'wl-summary-mark-as-unread</span><span class="p">)</span></code></pre></figure>
<p>
<code>i</code> で sync &lt;- Mew 風
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-summary-mode-map</span> <span class="s">"i"</span> <span class="ss">'wl-summary-sync-update</span><span class="p">)</span></code></pre></figure>
<p>
<code>C-o</code> は elscreen で使う
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-summary-mode-map</span> <span class="s">"\C-o"</span> <span class="no">nil</span> <span class="p">)</span></code></pre></figure>
<p>
<code>M-o</code> で <code>auto-refile</code>  (Mew 風)
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-summary-mode-map</span> <span class="s">"\M-o"</span> <span class="ss">'wl-summary-auto-refile</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org460a927d">flag とフォルダを行き来する関数の追加</h4>
<div class="outline-text-4" id="text-org460a927d">
<p>
"=" でフラグ付きフォルダと
実際にメッセージのあるフォルダを行き来する.
Gmail の「スター付き」フォルダでも有効
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">require</span> <span class="ss">'elmo</span> <span class="no">nil</span> <span class="ss">'noerror</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my:wl-summary-jump-to-referer-message</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">wl-summary-message-number</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">eq</span> <span class="p">(</span><span class="nv">elmo-folder-type-internal</span> <span class="nv">wl-summary-buffer-elmo-folder</span><span class="p">)</span> <span class="ss">'flag</span><span class="p">)</span>
        <span class="p">(</span><span class="k">progn</span>
          <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">referer</span> <span class="p">(</span><span class="nv">elmo-flag-folder-referrer</span>
                           <span class="nv">wl-summary-buffer-elmo-folder</span>
                           <span class="p">(</span><span class="nv">wl-summary-message-number</span><span class="p">)))</span>
                 <span class="p">(</span><span class="nv">folder</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nb">length</span> <span class="nv">referer</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
                             <span class="p">(</span><span class="nv">completing-read</span>
                              <span class="p">(</span><span class="nb">format</span> <span class="s">"Jump to (%s): "</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">referer</span><span class="p">)))</span>
                              <span class="nv">referer</span>
                              <span class="no">nil</span> <span class="no">t</span> <span class="no">nil</span> <span class="no">nil</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">referer</span><span class="p">)))</span>
                           <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">referer</span><span class="p">)))))</span>
            <span class="p">(</span><span class="nv">wl-summary-goto-folder-subr</span> <span class="nv">folder</span> <span class="ss">'no-sync</span> <span class="no">nil</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">wl-summary-jump-to-msg</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">folder</span> <span class="nv">referer</span><span class="p">)))))</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">eq</span> <span class="p">(</span><span class="nv">elmo-folder-type</span> <span class="nv">wl-summary-last-visited-folder</span><span class="p">)</span> <span class="ss">'internal</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">wl-summary-goto-last-visited-folder</span><span class="p">)))))</span>
<span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-summary-mode-map</span> <span class="s">"="</span> <span class="ss">'my:wl-summary-jump-to-referer-message</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org433d7a5c">summary-mode の表示のカスタマイズ</h4>
<div class="outline-text-4" id="text-org433d7a5c">
</div>
<div>
<h5 id="org63a385a5">自分が差出人である mail は To:某 と表示</h5>
<div class="outline-text-5" id="text-org63a385a5">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-showto-folder-regexp</span> <span class="s">".*"</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-from-function</span> <span class="ss">'wl-summary-default-from</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org94145d9c">サマリ行の表示関連</h5>
<div class="outline-text-5" id="text-org94145d9c">
<p>
サマリ行のフォーマット指定
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-line-format</span>
      <span class="s">"%T%P%1@%1&gt;%Y/%M/%D %21(%t%[%19(%c %f%)%]%) %#%~%s"</span>
      <span class="nv">wl-summary-width</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nv">window-width</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>
<p>
サマリ表示は切り詰めない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-subject-length-limit</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
スレッドの幅の指定
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-thread-indent-level</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-thread-have-younger-brother-str</span> <span class="s">"+"</span> <span class="c1">;; "├"</span>
      <span class="nv">wl-thread-youngest-child-str</span> <span class="s">"+"</span> <span class="c1">;; "└"</span>
      <span class="nv">wl-thread-vertical-str</span> <span class="s">"|"</span> <span class="c1">;; "│"</span>
      <span class="nv">wl-thread-horizontal-str</span> <span class="s">"-"</span> <span class="c1">;; "─"</span>
      <span class="nv">wl-thread-space-str</span> <span class="s">" "</span><span class="p">)</span></code></pre></figure>
<p>
以下の二つの設定を有効にするには
<code>elmo-msgdb-extra-fields</code> を設定する必要がある.
この変数は振り分け判定にも使用するのでそこで設定している
</p>
</div>
</div>
<div>
<h5 id="orga083aeb5">Gmail 風に, 自分宛のメールに "&gt;" をつけて表示する</h5>
<div class="outline-text-5" id="text-orga083aeb5">
<p>
元ネタ <a href="http://d.hatena.ne.jp/khiker/20080206/wanderlust">http://d.hatena.ne.jp/khiker/20080206/wanderlust</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-user-mail-address-regexp</span> <span class="s">"^uwabami.*\\|^sasakyh.*"</span><span class="p">)</span>
<span class="c1">;; 一覧表示での置き換え規則に追加</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my:wl-summary-line-for-me</span> <span class="p">()</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="k">catch</span> <span class="ss">'found</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">to</span> <span class="p">(</span><span class="nv">elmo-message-entity-field</span> <span class="nv">wl-message-entity</span> <span class="ss">'to</span><span class="p">))</span>
              <span class="p">(</span><span class="nv">cc</span> <span class="p">(</span><span class="nv">elmo-message-entity-field</span> <span class="nv">wl-message-entity</span> <span class="ss">'cc</span><span class="p">)))</span>
          <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">stringp</span> <span class="nv">to</span><span class="p">)</span> <span class="nv">cc</span><span class="p">)</span>
            <span class="p">(</span><span class="k">setq</span> <span class="nv">to</span>
                  <span class="p">(</span><span class="nb">append</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">stringp</span> <span class="nv">to</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">to</span><span class="p">)</span> <span class="nv">to</span><span class="p">)</span>
                          <span class="p">(</span><span class="nb">when</span> <span class="nv">cc</span>
                            <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">stringp</span> <span class="nv">cc</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="nv">cc</span><span class="p">)</span> <span class="nv">cc</span><span class="p">)))))</span>
          <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">i</span> <span class="nv">to</span><span class="p">)</span>
            <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">wl-address-user-mail-address-p</span> <span class="p">(</span><span class="nv">eword-decode-string</span> <span class="nv">i</span><span class="p">))</span>
              <span class="p">(</span><span class="k">throw</span> <span class="ss">'found</span> <span class="no">t</span><span class="p">)))))</span>
      <span class="s">"&gt;"</span>
    <span class="s">""</span><span class="p">))</span>
<span class="c1">;; &gt; を summary-line-format に追加</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-line-format-spec-alist</span>
      <span class="p">(</span><span class="nb">append</span> <span class="nv">wl-summary-line-format-spec-alist</span>
              <span class="o">'</span><span class="p">((</span><span class="nv">?&gt;</span> <span class="p">(</span><span class="nv">my:wl-summary-line-for-me</span><span class="p">)))))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org04b0fd69">添付ファイルがあったら, サマリ行に @ を付ける</h5>
<div class="outline-text-5" id="text-org04b0fd69">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-line-format-spec-alist</span>
      <span class="p">(</span><span class="nb">append</span> <span class="nv">wl-summary-line-format-spec-alist</span>
              <span class="o">'</span><span class="p">((</span><span class="nv">?@</span> <span class="p">(</span><span class="nv">wl-summary-line-attached</span><span class="p">)))))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org9b1eb3e9">クォートされた文字列もデコードする</h5>
<div class="outline-text-5" id="text-org9b1eb3e9">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-header-lexical-analyzer</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="c1">;; eword-analyze-quoted-string</span>
        <span class="nv">eword-analyze-domain-literal</span>
        <span class="nv">eword-analyze-comment</span>
        <span class="nv">eword-analyze-spaces</span>
        <span class="nv">eword-analyze-special</span>
        <span class="nv">eword-analyze-encoded-word</span>
        <span class="nv">eword-analyze-atom</span><span class="p">))</span>
<span class="c1">;; (mime-set-field-decoder</span>
<span class="c1">;;  'From nil 'eword-decode-and-unfold-unstructured-field-body)</span>
<span class="c1">;; (mime-set-field-decoder</span>
<span class="c1">;;  'To nil 'eword-decode-and-unfold-unstructured-field-body)</span>
<span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="ss">'eword-decode</span>
  <span class="p">(</span><span class="nv">mime-set-field-decoder</span>
   <span class="ss">'From</span> <span class="no">nil</span> <span class="ss">'eword-decode-and-unfold-unstructured-field-body</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">mime-set-field-decoder</span>
   <span class="ss">'To</span> <span class="no">nil</span> <span class="ss">'eword-decode-and-unfold-unstructured-field-body</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org8e1a38e8">Subject が変わってもスレッドを切らない</h5>
<div class="outline-text-5" id="text-org8e1a38e8">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-divide-thread-when-subject-changed</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org4a68d8d4">Subject での Tab や複数スペースを無視</h5>
<div class="outline-text-5" id="text-org4a68d8d4">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (defadvice std11-unfold-string (after simply activate)</span>
<span class="c1">;;   (setq ad-return-value</span>
<span class="c1">;;         (replace-regexp-in-string ad-return-value "[ \t]+" " ")))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org84fec166">重複メッセージを非表示に</h5>
<div class="outline-text-5" id="text-org84fec166">
<p>
フォルダ内の Message-ID が同じメールを非表示にする
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-folder-process-duplicates-alist</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="p">(</span><span class="s">".*"</span> <span class="o">.</span> <span class="nv">hide</span><span class="p">)</span>
        <span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgc0e5bbcf">sort 順: 返信が来た順</h5>
<div class="outline-text-5" id="text-orgc0e5bbcf">
<p>
元ネタは <a href="http://ikazuhiro.s206.xrea.com/article.php/20140920115345919">Re: wanderlust で GMail 風、新着レス順にソート</a>.
あんまり頑張る気がなかったので <code>el-x</code> にある <code>dflet</code> を使っている。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">wl-summary-overview-entity-compare-by-reply-date</span> <span class="p">(</span><span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="s">"Compare message A and B by latest date of replies including thread."</span>
  <span class="p">(</span><span class="nv">dflet</span> <span class="p">((</span><span class="nv">string-max2</span> <span class="p">(</span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nb">string&lt;</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">y</span><span class="p">)</span>
                                  <span class="p">(</span><span class="ss">'t</span> <span class="nv">x</span><span class="p">)))</span>
         <span class="p">(</span><span class="nv">elmo-entity-to-number</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
                                <span class="p">(</span><span class="nb">elt</span> <span class="p">(</span><span class="nb">cddr</span> <span class="nv">x</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
         <span class="p">(</span><span class="nv">thread-number-get-date</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nv">timezone-make-date-sortable</span>
                                  <span class="p">(</span><span class="nv">elmo-msgdb-overview-entity-get-date</span>
                                   <span class="p">(</span><span class="nv">elmo-message-entity</span>
                                    <span class="nv">wl-summary-buffer-elmo-folder</span>
                                    <span class="nv">x</span><span class="p">))))</span>
         <span class="p">(</span><span class="nv">thread-get-family</span> <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
                            <span class="p">(</span><span class="nb">cons</span> <span class="nv">x</span> <span class="p">(</span><span class="nv">wl-thread-entity-get-descendant</span>
                                     <span class="p">(</span><span class="nv">wl-thread-get-entity</span> <span class="nv">x</span><span class="p">))))</span>
         <span class="p">(</span><span class="nv">max-reply-date</span>  <span class="p">(</span><span class="nv">x</span><span class="p">)</span>
                          <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nb">eq</span> <span class="ss">'nil</span> <span class="nv">x</span><span class="p">)</span>
                                 <span class="ss">'nil</span><span class="p">)</span>
                                <span class="p">((</span><span class="nb">eq</span> <span class="ss">'nil</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))</span>
                                 <span class="p">(</span><span class="nv">thread-number-get-date</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">)))</span>
                                <span class="p">(</span><span class="ss">'t</span>
                                 <span class="p">(</span><span class="nv">string-max2</span> <span class="p">(</span><span class="nv">thread-number-get-date</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">x</span><span class="p">))</span>
                                              <span class="p">(</span><span class="nv">max-reply-date</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">x</span><span class="p">))))))</span>
         <span class="p">)</span>
    <span class="p">(</span><span class="nb">string&lt;</span>
     <span class="p">(</span><span class="nv">max-reply-date</span> <span class="p">(</span><span class="nv">thread-get-family</span> <span class="p">(</span><span class="nv">elmo-entity-to-number</span> <span class="nv">a</span><span class="p">)))</span>
     <span class="p">(</span><span class="nv">max-reply-date</span> <span class="p">(</span><span class="nv">thread-get-family</span> <span class="p">(</span><span class="nv">elmo-entity-to-number</span> <span class="nv">b</span><span class="p">))))))</span>
<span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'wl-summary-sort-specs</span> <span class="ss">'reply-date</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-default-sort-spec</span> <span class="ss">'reply-date</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="orgbeaff272">振り分け設定</h4>
<div class="outline-text-4" id="text-orgbeaff272">
<p>
<code>$</code> 以外を振り分け対象に
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-summary-auto-refile-skip-marks</span> <span class="o">'</span><span class="p">(</span><span class="s">"$"</span><span class="p">))</span></code></pre></figure>
</div>
<div>
<h5 id="org1581be27">振り分け判定に使用するヘッダ</h5>
<div class="outline-text-5" id="text-org1581be27">
<p>
添付の有無の表示にも使うので <code>Content-Type</code> も登録.
あと <code>Delivered-To</code> はメールの検索の時に結構重宝している.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-msgdb-extra-fields</span>
      <span class="o">'</span><span class="p">(</span>
        <span class="s">"List-Post"</span>
        <span class="s">"List-Id"</span>
        <span class="s">"List-ID"</span>                  <span class="c1">;; たまに List-ID で来るメールあるよね?</span>
        <span class="s">"Resent-CC"</span>
        <span class="s">"Mailing-List"</span>
        <span class="s">"X-Mailing-List"</span>
        <span class="s">"X-ML-Address"</span>
        <span class="s">"X-ML-Name"</span>
        <span class="s">"X-ML-To"</span>
        <span class="s">"X-Loop"</span>
        <span class="s">"Delivered-To"</span>
        <span class="s">"Content-Type"</span>              <span class="c1">;; 添付の有無の表示の為に追加</span>
        <span class="s">"X-Google-Appengine-App-Id"</span> <span class="c1">;; GAEの送信するメールの振り分け用</span>
        <span class="s">"To"</span>
        <span class="s">"Cc"</span>
        <span class="s">"From"</span>
        <span class="s">"Subject"</span>
        <span class="s">"Reply-To"</span>
        <span class="s">"Auto-Submitted"</span>            <span class="c1">;; Git commit/Cron notify</span>
        <span class="p">))</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="org1c00dc9a">メッセージ表示</h4>
<div class="outline-text-4" id="text-org1c00dc9a">
</div>
<div>
<h5 id="orgbdcad743">いったん全て非表示に</h5>
<div class="outline-text-5" id="text-orgbdcad743">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-ignored-field-list</span> <span class="o">'</span><span class="p">(</span><span class="s">"^.*:"</span><span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org279f859d">見たいヘッダだけ表示</h5>
<div class="outline-text-5" id="text-org279f859d">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-visible-field-list</span>
      <span class="o">'</span><span class="p">(</span><span class="s">"^Subject:"</span>
        <span class="s">"^From:"</span>
        <span class="s">"^To:"</span>
        <span class="s">"^Cc:"</span>
        <span class="s">"^Date:"</span>
        <span class="s">"^Message-ID:"</span>
        <span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org594e5622">表示順の変更</h5>
<div class="outline-text-5" id="text-org594e5622">
<p>
Mew 風…
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-sort-field-list</span>
      <span class="o">'</span><span class="p">(</span><span class="s">"^Subject:"</span>
        <span class="s">"^From:"</span>
        <span class="s">"^To:"</span>
        <span class="s">"^Cc:"</span>
        <span class="s">"^Date:"</span>
        <span class="s">"^Message-ID:"</span>
        <span class="p">))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org452d7cdb">From, To を省略表示しない</h5>
<div class="outline-text-5" id="text-org452d7cdb">
<p>
To や From にアドレスが沢山指定されていると省略されるので, これを無効化
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-message-use-header-narrowing</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="org1bf4b420">Wanderlust: Face の設定</h4>
<div class="outline-text-4" id="text-org1bf4b420">
<p>
デフォルトより細かく指定するために幾つかの face 定義を追加.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-highlight-message-header-alist</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"Subject[ \t]*:"</span>
         <span class="o">.</span> <span class="nv">wl-highlight-message-subject-header-contents</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"From[ \t]*:"</span>
         <span class="o">.</span> <span class="nv">wl-highlight-message-from-header-contents</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"Date[ \t]*:"</span>
         <span class="o">.</span> <span class="nv">wl-highlight-message-date-header-contents</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"\\(.*To\\|Cc\\|Newsgroups\\)[ \t]*:"</span>
         <span class="o">.</span> <span class="nv">wl-highlight-message-important-header-contents</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"\\(User-Agent\\|X-Mailer\\|X-Newsreader\\)[ \t]*:"</span>
         <span class="o">.</span> <span class="nv">wl-highlight-message-unimportant-header-contents</span><span class="p">)</span>
        <span class="p">))</span></code></pre></figure>
<p>
face の色付け
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">my:wl-set-face</span> <span class="p">(</span><span class="nv">face</span> <span class="nv">spec</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">make-face</span> <span class="nv">face</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nb">fboundp</span> <span class="ss">'face-spec-set</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">face-spec-set</span> <span class="nv">face</span> <span class="nv">spec</span><span class="p">))</span>
        <span class="p">(</span><span class="no">t</span>
         <span class="p">(</span><span class="nv">wl-declare-face</span> <span class="nv">face</span> <span class="nv">spec</span><span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-folder-closed-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4cff4c"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-folder-few-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#FF4C4C"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-folder-zero-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#f6f3e8"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-1</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7fff7f"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-2</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ffff7f"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-3</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7f7fff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-4</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7fffff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-5</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ff7fff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-6</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ff7f7f"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-7</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4cff4c"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-8</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ffff4c"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-9</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4c4cff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-10</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4cffff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-11</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ff4cff"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-cited-text-12</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ff4c4c"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-date-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4CFF4C"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#aaaaaa"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-headers</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4CFFFF"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-important-header-contents2</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4CFF4C"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-signature</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#aaaaaa"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-important-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#FF4CFF"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-subject-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#FF4C4C"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-from-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#FFFF4C"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">bold</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-message-unimportant-header-contents</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#aaaaaa"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-summary-answered-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#4CFF4C"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-summary-refiled-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7F7FFF"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-summary-thread-top-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#F6F3E8"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="p">(</span><span class="nv">my:wl-set-face</span> <span class="ss">'wl-highlight-summary-important-flag-face</span>
                <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#ffff4c"</span> <span class="ss">:bold</span> <span class="no">nil</span> <span class="ss">:italic</span> <span class="no">nil</span> <span class="ss">:weight</span> <span class="nv">normal</span> <span class="p">))))</span>
<span class="c1">;;</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-killed-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:black :5Dbold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-many-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:magenta :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-opened-face</span>
<span class="c1">;;                 '((t (:foreground "#4cffff" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-path-face</span>
<span class="c1">;;                 '((t (:underline t :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-unknown-face</span>
<span class="c1">;;                 '((t (:foreground "#4cffff" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-folder-unread-face</span>
<span class="c1">;;                 '((t (:foreground ,my:n:blue :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-header-separator-face</span>
<span class="c1">;;                 '((t (:inherit highlight :bold t ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-message-citation-header</span>
<span class="c1">;;                 '((t (:foreground ,my:h:green :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-copied-face</span>
<span class="c1">;;                 '((t (:foreground "#4CFFFF" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-deleted-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:black :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-displaying-face</span>
<span class="c1">;;                 '((t (:underline t :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-disposed-face</span>
<span class="c1">;;                 '((t (:foreground "#aaaaaa" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-flagged-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:yellow :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-forwarded-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:blue :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-high-read-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:green :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-high-unread-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:orange :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-important-face</span>
<span class="c1">;;                 '((t (:foreground "#ffff4c" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-killed-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:black :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-l:read-face</span>
<span class="c1">;;                 '((t (:foreground "#4CFF4C" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-l:unread-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:lightb :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-new-face</span>
<span class="c1">;;                 '((t (:foreground "#ff4c4c" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-normal-face</span>
<span class="c1">;;                 '((t (:foreground "#f6f3e8" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-prefetch-face</span>
<span class="c1">;;                 '((t (:foreground ,my:n:blue :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-resend-face</span>
<span class="c1">;;                 '((t (:foreground ,my:h:orange :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-target-face</span>
<span class="c1">;;                 '((t (:foreground "#4CFFFF" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-temp-face</span>
<span class="c1">;;                 '((t (:foreground ,my:n:violet :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-summary-unread-face</span>
<span class="c1">;;                 '((t (:foreground "#ff4c4c" :bold nil :italic nil ))))</span>
<span class="c1">;; (my:wl-set-face 'wl-highlight-thread-indent-face</span>
<span class="c1">;;                 '((t (:underline t :bold nil :italic nil ))))</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org32b816f3">作成/返信設定</h4>
<div class="outline-text-4" id="text-org32b816f3">
<p>
自分宛のメールに返信する場合は <code>To:</code>, <code>Cc:</code> から自分のアドレスを削除
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-draft-always-delete-myself</span> <span class="no">t</span><span class="p">)</span></code></pre></figure>
<p>
"a" (without-argument)では <code>Reply-To:</code> や <code>From:</code> などで
指定された唯一人または唯一つの投稿先に返信.
また, <code>X-ML-Name:</code> と <code>Reply-To:</code> がついているなら <code>Reply-To:</code> 宛に返信
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-draft-reply-without-argument-list</span>
      <span class="o">'</span><span class="p">(((</span><span class="s">"X-ML-Name"</span> <span class="s">"Reply-To"</span><span class="p">)</span> <span class="o">.</span> <span class="p">((</span><span class="s">"Reply-To"</span><span class="p">)</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
        <span class="p">(</span><span class="s">"X-ML-Name"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"To"</span> <span class="s">"Cc"</span><span class="p">)</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
        <span class="p">(</span><span class="s">"Followup-To"</span> <span class="o">.</span> <span class="p">(</span><span class="no">nil</span> <span class="no">nil</span> <span class="p">(</span><span class="s">"Followup-To"</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">"Newsgroups"</span> <span class="o">.</span> <span class="p">(</span><span class="no">nil</span> <span class="no">nil</span> <span class="p">(</span><span class="s">"Newsgroups"</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">"Reply-To"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"Reply-To"</span><span class="p">)</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
        <span class="p">(</span><span class="s">"Mail-Reply-To"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"Mail-Reply-To"</span><span class="p">)</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
        <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"From"</span><span class="p">)</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))))</span></code></pre></figure>
<p>
<code>C-u a</code> (with-argument)であれば関係する全ての人・投稿先に返信
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-draft-reply-with-argument-list</span>
      <span class="o">'</span><span class="p">((</span><span class="s">"Followup-To"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"From"</span><span class="p">)</span> <span class="no">nil</span> <span class="p">(</span><span class="s">"Followup-To"</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">"Newsgroups"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"From"</span><span class="p">)</span> <span class="no">nil</span> <span class="p">(</span><span class="s">"Newsgroups"</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">"Mail-Followup-To"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"Mail-Followup-To"</span><span class="p">)</span> <span class="no">nil</span> <span class="p">(</span><span class="s">"Newsgroups"</span><span class="p">)))</span>
        <span class="p">(</span><span class="s">"From"</span> <span class="o">.</span> <span class="p">((</span><span class="s">"From"</span><span class="p">)</span> <span class="p">(</span><span class="s">"To"</span> <span class="s">"Cc"</span><span class="p">)</span> <span class="p">(</span><span class="s">"Newsgroups"</span><span class="p">)))))</span></code></pre></figure>
<p>
サマリ表示には petname を使うが, 引用には使わない
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">wl-default-draft-cite-decorate-author</span> <span class="no">nil</span><span class="p">)</span></code></pre></figure>
</div>
<div>
<h5 id="orgccd69748">メール本文の文字コード</h5>
<div class="outline-text-5" id="text-orgccd69748">
<p>
丸囲み数字なんかが入ってしまうと
勝手にエンコーディングが変わってしまって鬱陶しい. どうしたモンだろうかね.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'wl-draft-mode-hook</span>
          <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
            <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'mime-charset-type-list</span> <span class="o">'</span><span class="p">(</span><span class="nv">utf-8</span> <span class="mi">8</span> <span class="no">nil</span><span class="p">))))</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="org62a575b3">draft mode で orgtbl を有効に</h5>
<div class="outline-text-5" id="text-org62a575b3">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'wl-draft-mode-hook</span> <span class="ss">'turn-on-orgtbl</span><span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h5 id="orgc1db3638">c-sig</h5>
<div class="outline-text-5" id="text-orgc1db3638">
<p>
署名の選択に c-sig を使用している.
設定は以下の通り. Mew 風に <code>C-c &lt;tab&gt;</code> で signature を挿入するようにしている
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">c-sig</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">eval-when-compile</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'wl</span><span class="p">))</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">sig-insert-end</span> <span class="no">t</span>
        <span class="nv">sig-save-to-sig-name-alist</span> <span class="no">nil</span>
        <span class="nv">message-signature-file</span> <span class="no">nil</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">define-key</span> <span class="nv">wl-draft-mode-map</span> <span class="s">"\C-c\t"</span> <span class="ss">'insert-signature-eref</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'wl-draft-mode-hook</span>
            <span class="o">'</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
               <span class="p">(</span><span class="nv">define-key</span> <span class="p">(</span><span class="nv">current-local-map</span><span class="p">)</span> <span class="s">"\C-c\C-w"</span>
                 <span class="ss">'insert-signature-eref</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h4 id="orgda22b5d8">GPG 署名</h4>
<div class="outline-text-4" id="text-orgda22b5d8">
<p>
以前は mailcrypt を使っていたけれど,
epa があるので主にキーバインドの設定のみ.
<code>draft-mode</code> の文字コードをあらかじめ指定しておかないと,
送信時に文字コードが変換されるので不正な署名となってしまう.
</p>

<p>
もっとうまい方法/正攻法がありそうな気がするけれど,
使えてるから, まあ良いかな, とか.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">mime-pgp-verify-when-preview</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my:epa-wl-decrypt-message</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">save-window-excursion</span>
    <span class="p">(</span><span class="nv">wl-summary-jump-to-current-message</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">wl-message-decrypt-pgp-nonmime</span><span class="p">)))</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my:epa-wl-verify-message</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">save-selected-window</span>
    <span class="p">(</span><span class="nv">wl-summary-jump-to-current-message</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">wl-message-verify-pgp-nonmime</span><span class="p">)))</span>
<span class="p">(</span><span class="nv">leaf-keys</span> <span class="p">((</span><span class="ss">:wl-summary-mode-map</span>
             <span class="p">(</span><span class="s">"C-c : d"</span> <span class="o">.</span> <span class="nv">my:epa-wl-decrypt-message</span><span class="p">)</span>
             <span class="p">(</span><span class="s">"C-c : v"</span> <span class="o">.</span> <span class="nv">my:epa-wl-verify-message</span><span class="p">))</span>
            <span class="p">(</span><span class="ss">:wl-draft-mode-map</span>
             <span class="p">(</span><span class="s">"C-c : s"</span> <span class="o">.</span> <span class="nv">epa-mail-sign</span><span class="p">)</span>
             <span class="p">(</span><span class="s">"C-c : e"</span> <span class="o">.</span> <span class="nv">epa-mail-encrypt</span><span class="p">)))</span>
           <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org5d7309d7">検索</h4>
<div class="outline-text-4" id="text-org5d7309d7">
<p>
notmuchを使う.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">elmo-search</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">elmo-search-register-engine</span> <span class="ss">'notmuch-custom</span> <span class="ss">'local-file</span>
                               <span class="ss">:prog</span> <span class="s">"notmuch-query-custom"</span>
                               <span class="ss">:args</span> <span class="o">'</span><span class="p">(</span><span class="nv">elmo-search-split-pattern-list</span><span class="p">)</span>
                               <span class="ss">:charset</span> <span class="ss">'utf-8</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-search-default-engine</span> <span class="ss">'notmuch-custom</span><span class="p">))</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">wl-qs</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">wl-quicksearch-folder</span> <span class="s">"[]"</span>
        <span class="p">)</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nv">leaf-keys</span> <span class="p">((</span><span class="ss">:wl-summary-mode-map</span>
             <span class="p">(</span><span class="s">"v"</span> <span class="o">.</span> <span class="nv">wl-quicksearch-goto-search-folder-wrapper</span><span class="p">))</span>
            <span class="p">(</span><span class="ss">:wl-folder-mode-map</span>
             <span class="p">(</span><span class="s">"v"</span> <span class="o">.</span> <span class="nv">wl-quicksearch-goto-search-folder-wrapper</span><span class="p">)))</span>
           <span class="p">)</span></code></pre></figure>
<p>
実際の呼び出しはスレッドを全部取得したいので以下を呼び出している
</p>
<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="c">#!/bin/sh</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> x<span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span> <span class="o">=</span> x<span class="s2">""</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
    </span><span class="nv">res</span><span class="o">=</span><span class="si">$(</span>notmuch search <span class="nt">--output</span><span class="o">=</span>threads <span class="s2">"</span><span class="nv">$*</span><span class="s2">"</span><span class="si">)</span>
<span class="k">fi
if</span> <span class="o">[</span> <span class="o">!</span> x<span class="s2">"</span><span class="nv">$res</span><span class="s2">"</span> <span class="o">=</span> x<span class="s2">""</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="nv">$res</span> | xargs notmuch search <span class="nt">--sort</span><span class="o">=</span>oldest-first <span class="nt">--output</span><span class="o">=</span>files
<span class="k">fi</span></code></pre></figure>
<p>
検索時にメールが多すぎると怒られるので. 数字は適当.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-multi-divide-number</span> <span class="mi">2000000000</span><span class="p">)</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">elmo-multi-number</span> <span class="mi">2000000000</span><span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h3 id="orgcfa9b17b">Linux Desktop で <code>mailto:</code> リンクを扱うために</h3>
<div class="outline-text-3" id="text-orgcfa9b17b">
<p>
ついでに <code>mailto</code> のリンクを emacsclient で扱うために,
以下の関数を定義しておく
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">my:mailto-compose-mail</span> <span class="p">(</span><span class="nv">mailto-url</span><span class="p">)</span>
  <span class="s">"Custom: handling mailto: link"</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nb">stringp</span> <span class="nv">mailto-url</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">string-match</span> <span class="s">"\\`mailto:"</span> <span class="nv">mailto-url</span><span class="p">))</span>
      <span class="p">(</span><span class="k">progn</span>
        <span class="p">(</span><span class="nv">eval-and-compile</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'rfc2368</span><span class="p">))</span>
        <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">headers</span> <span class="p">(</span><span class="nb">mapcar</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">h</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">intern</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">h</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">h</span><span class="p">)))</span>
                                <span class="p">(</span><span class="nv">rfc2368-parse-mailto-url</span> <span class="nv">mailto-url</span><span class="p">)))</span>
               <span class="p">(</span><span class="nv">good-headers</span> <span class="p">(</span><span class="nv">cl-remove-if</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">h</span><span class="p">)</span> <span class="p">(</span><span class="nb">member</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">h</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nv">Body</span><span class="p">)))</span> <span class="nv">headers</span><span class="p">))</span>
               <span class="p">(</span><span class="nv">body</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">assoc</span> <span class="ss">'Body</span> <span class="nv">headers</span><span class="p">))))</span>
          <span class="p">(</span><span class="nv">wl-draft</span> <span class="nv">good-headers</span> <span class="no">nil</span> <span class="no">nil</span> <span class="nv">body</span><span class="p">)))))</span></code></pre></figure>
<p>
Desktop の設定では
</p>
<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="c">#!/bin/sh</span>
<span class="c"># emacs-mailto-handler</span>

<span class="nv">mailto</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">mailto</span><span class="o">=</span><span class="s2">"mailto:</span><span class="k">${</span><span class="nv">mailto</span><span class="p">#mailto</span>:<span class="k">}</span><span class="s2">"</span>
<span class="nv">mailto</span><span class="o">=</span><span class="si">$(</span><span class="nb">printf</span> <span class="s1">'%s\n'</span> <span class="s2">"</span><span class="nv">$mailto</span><span class="s2">"</span> | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/[\"]/\\&amp;/g'</span><span class="si">)</span>
<span class="nv">elisp_expr</span><span class="o">=</span><span class="s2">"(my:mailto-compose-mail </span><span class="se">\"</span><span class="nv">$mailto</span><span class="se">\"</span><span class="s2">)"</span>

emacsclient <span class="nt">-a</span> <span class="s2">""</span> <span class="nt">-n</span> <span class="nt">--eval</span> <span class="s2">"</span><span class="nv">$elisp_expr</span><span class="s2">"</span> <span class="se">\</span>
            <span class="s1">'(set-window-dedicated-p (selected-window) t)'</span></code></pre></figure>
<p>
をメーラとして指定すれば良い．
GNOME は <code>.desktop</code> ファイルが無いと「お気に入り」登録ができないので
以下のファイルを適当な名前で <code>~/.local/share/applications/</code> 以下に放り込んでおくと良いだろう
</p>
<figure class="highlight"><pre><code class="language-conf" data-lang="conf">[<span class="n">Desktop</span> <span class="n">Entry</span>]
<span class="n">Name</span>=<span class="n">Emacs</span> <span class="n">Mail</span> <span class="n">Handler</span>
<span class="n">GenericName</span>=<span class="n">Mail</span> <span class="n">User</span> <span class="n">Agent</span>
<span class="n">X</span>-<span class="n">GNOME</span>-<span class="n">FullName</span>=<span class="n">Emacs</span> <span class="n">Mail</span> <span class="n">Handler</span>
<span class="n">Comment</span>=<span class="n">Use</span> <span class="n">emacsclient</span> <span class="n">as</span> <span class="n">MUA</span>, <span class="n">handling</span> <span class="n">mailto</span> <span class="n">link</span>
<span class="n">Keywords</span>=<span class="n">email</span>
<span class="n">Exec</span>=/<span class="n">home</span>/<span class="n">uwabami</span>/<span class="n">bin</span>/<span class="n">emacs</span>-<span class="n">mailto</span>-<span class="n">handler</span> %<span class="n">U</span>
<span class="n">Icon</span>=<span class="n">emacs25</span>
<span class="n">Terminal</span>=<span class="n">false</span>
<span class="n">Type</span>=<span class="n">Application</span>
<span class="n">Categories</span>=<span class="n">GNOME</span>;<span class="n">GTK</span>;<span class="n">Office</span>;<span class="n">Email</span>;
<span class="n">StartupNotify</span>=<span class="n">false</span>
<span class="n">MimeType</span>=<span class="n">application</span>/<span class="n">mbox</span>;<span class="n">message</span>/<span class="n">rfc822</span>;<span class="n">x</span>-<span class="n">scheme</span>-<span class="n">handler</span>/<span class="n">mailto</span>;</code></pre></figure>
</div>
</div>
<div>
<h3 id="org215a97b9">メールからの予定の取り込み: <code>mhc</code>
</h3>
<div class="outline-text-3" id="text-org215a97b9">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">mhc</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)</span> <span class="s">"/.config/mhc"</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:commands</span> <span class="p">(</span><span class="nv">mhc-import</span><span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">mhc-calendar-day-strings</span> <span class="nv">[</span><span class="s">"日"</span> <span class="s">"月"</span> <span class="s">"火"</span> <span class="s">"水"</span> <span class="s">"木"</span> <span class="s">"金"</span> <span class="s">"土"</span><span class="nv">]</span>
        <span class="nv">mhc-calendar-header-function</span> <span class="ss">'mhc-calendar-make-header-ja</span>
        <span class="nv">mhc-calendar-language</span> <span class="ss">'japanese</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="orgc0b8a536">閉じタグの入力補助: <code>smartparens</code>
</h2>
<div class="outline-text-2" id="text-orgc0b8a536">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">smartparens</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="no">t</span>
  <span class="ss">:defun</span> <span class="p">(</span><span class="nv">sp-pair</span><span class="p">)</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">after-init-hook</span> <span class="o">.</span> <span class="nv">smartparens-global-mode</span><span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">require</span> <span class="ss">'smartparens-config</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">sp-pair</span> <span class="s">"="</span> <span class="s">"="</span> <span class="ss">:actions</span> <span class="o">'</span><span class="p">(</span><span class="nv">wrap</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">sp-pair</span> <span class="s">"+"</span> <span class="s">"+"</span> <span class="ss">:actions</span> <span class="o">'</span><span class="p">(</span><span class="nv">wrap</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">sp-pair</span> <span class="s">"&lt;"</span> <span class="s">"&gt;"</span> <span class="ss">:actions</span> <span class="o">'</span><span class="p">(</span><span class="nv">wrap</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">sp-pair</span> <span class="s">"$"</span> <span class="s">"$"</span> <span class="ss">:actions</span> <span class="o">'</span><span class="p">(</span><span class="nv">wrap</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org1f0e431b">カラーコードに色付け: <code>rainbow-mode</code>
</h2>
<div class="outline-text-2" id="text-org1f0e431b">
<p>
<code>#RRGGBB</code> のカラーコードに勝手に色が付く．CSS の編集中なんかで地味に便利．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">rainbow-mode</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="o">`</span><span class="p">((</span><span class="nv">rainbow-mode</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nb">format</span> <span class="s">" %s"</span> <span class="s">"\x1F308"</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orgdddd3388">対応する括弧を見易く: <code>rainbow-delimiters</code>
</h2>
<div class="outline-text-2" id="text-orgdddd3388">
<p>
対応する括弧を強調表示してくれる
<a href="https://www.emacswiki.org/emacs/RainbowDelimiters">RainbowDelimiters</a>:
global に有効にするのは他の
Major modeとの衝突があるので止めた方が良い, らしい．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">rainbow-delimiters</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="no">t</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">prog-mode-hook</span> <span class="o">.</span> <span class="nv">rainbow-delimiters-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org7b7eccc9">Org-mode</h2>
<div class="outline-text-2" id="text-org7b7eccc9">
<p>
<code>org-mode</code> が無いと生きていけない体になりました
</p>
</div>
<div>
<h3 id="orgb143e870">基本設定: <code>org</code>
</h3>
<div class="outline-text-3" id="text-orgb143e870">
<p>
目新しい設定はしていない, と思う．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org</span>
  <span class="ss">:blackout</span> <span class="o">`</span><span class="p">((</span><span class="nv">org-mode</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="ss">'org-mode</span><span class="p">)))</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x n s"</span> <span class="o">.</span> <span class="nv">org-narrow-to-subtree</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x n w"</span> <span class="o">.</span> <span class="nv">widen</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-c a"</span>   <span class="o">.</span> <span class="nv">org-agenda</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x m"</span>   <span class="o">.</span> <span class="nv">org-capture</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"C-x M"</span>   <span class="o">.</span> <span class="nv">my:org-journal-new-entry</span><span class="p">)</span>
         <span class="p">)</span>
  <span class="ss">:advice</span>
  <span class="p">(</span><span class="ss">:before</span> <span class="nv">org-calendar-holiday</span>
           <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nb">require</span> <span class="ss">'japanese-holidays</span><span class="p">)))</span>
  <span class="ss">:mode</span>
  <span class="c1">;; 昔のメモ(howm)も org-mode で開く</span>
  <span class="p">((</span><span class="s">"\\.org\\'"</span> <span class="s">"\\.howm\\'"</span><span class="o">.</span> <span class="nv">org-mode</span><span class="p">))</span>
  <span class="ss">:preface</span>
  <span class="c1">;;; timestamp 更新文字列の変更:</span>
  <span class="c1">;;  org-mode では ＃+DATE: をひっかける用に(＃は小文字)．</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-timestamp-hook</span> <span class="p">()</span>
    <span class="s">"Change `time-stamp-start' in org-mode"</span>
    <span class="p">(</span><span class="nb">set</span> <span class="p">(</span><span class="nv">make-local-variable</span> <span class="ss">'time-stamp-start</span><span class="p">)</span> <span class="s">"#\\+date: "</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">set</span> <span class="p">(</span><span class="nv">make-local-variable</span> <span class="ss">'time-stamp-end</span><span class="p">)</span>   <span class="s">"\$"</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="c1">;; GTD: TODO→...→DONE としたエントリを =Arhive.org= に移動</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-archive-done-tasks</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-map-entries</span> <span class="ss">'org-archive-subtree</span> <span class="s">"/DONE"</span> <span class="ss">'file</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-mode-hook</span>                  <span class="o">.</span> <span class="nv">my:org-timestamp-hook</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-todo-statistics-hook</span>       <span class="o">.</span> <span class="nv">my:org-archive-done-tasks</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-todo-after-statistics-hook</span> <span class="o">.</span> <span class="nv">my:org-archive-done-tasks</span><span class="p">))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">(</span><span class="c1">;; Nextcloud に保存する</span>
    <span class="p">(</span><span class="nv">org-directory</span>              <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">my:d:org</span><span class="p">))</span>
    <span class="c1">;; return でリンクを辿る</span>
    <span class="p">(</span><span class="nv">org-return-follows-link</span>    <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; 見出しを畳んで表示</span>
    <span class="p">(</span><span class="nv">org-startup-folded</span>         <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; 折り返し無し</span>
    <span class="p">(</span><span class="nv">org-startup-truncated</span>      <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;; link handler -&gt; xdg-open 任せ</span>
    <span class="p">(</span><span class="nv">org-file-apps-defaults</span>     <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">remote</span> <span class="o">.</span> <span class="nv">emacs</span><span class="p">)</span>
                                    <span class="p">(</span><span class="nv">system</span> <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)</span>
                                    <span class="p">(</span><span class="no">t</span>      <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">org-file-apps-defaults-gnu</span> <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">remote</span> <span class="o">.</span> <span class="nv">emacs</span><span class="p">)</span>
                                    <span class="p">(</span><span class="nv">system</span> <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)</span>
                                    <span class="p">(</span><span class="no">t</span>      <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)))</span>
    <span class="p">(</span><span class="nv">org-file-apps</span>              <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nv">auto-mode</span> <span class="o">.</span> <span class="nv">emacs</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"\\.mm\\'"</span> <span class="o">.</span> <span class="nv">default</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"\\.x?html?\\'"</span> <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"\\.pdf\\'"</span> <span class="o">.</span> <span class="s">"xdg-open %s"</span><span class="p">)))</span>
    <span class="c1">;; GTD: 状態の追加</span>
    <span class="p">(</span><span class="nv">org-todo-keywords</span>          <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="nc">sequence</span> <span class="s">"TODO(t)"</span> <span class="s">"WAIT(w)"</span> <span class="s">"|"</span> <span class="s">"DONE(d)"</span> <span class="s">"CANCEL(c)"</span> <span class="s">"SOMEDAY(s)"</span><span class="p">)</span>
                                    <span class="p">(</span><span class="k">type</span> <span class="s">"ARTICLE(a)"</span><span class="p">)</span>
                                    <span class="p">(</span><span class="k">type</span> <span class="s">"MEMO(m)"</span><span class="p">)))</span>
    <span class="c1">;; GTD: タグの追加</span>
    <span class="p">(</span><span class="nv">org-tag-alist</span>              <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="s">"OFFICE"</span>     <span class="o">.</span> <span class="nv">?o</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"HOME"</span>       <span class="o">.</span> <span class="nv">?h</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"MAIL"</span>       <span class="o">.</span> <span class="nv">?m</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"WORK"</span>       <span class="o">.</span> <span class="nv">?w</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"Debian"</span>     <span class="o">.</span> <span class="nv">?d</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"Computer"</span>   <span class="o">.</span> <span class="nv">?c</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"Book"</span>       <span class="o">.</span> <span class="nv">?b</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"Emacs"</span>      <span class="o">.</span> <span class="nv">?e</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"TeX"</span>        <span class="o">.</span> <span class="nv">?t</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"Ruby"</span>       <span class="o">.</span> <span class="nv">?r</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"IGNORE"</span>     <span class="o">.</span> <span class="nv">?i</span><span class="p">)</span>
                                    <span class="p">(</span><span class="s">"PLANNED"</span>    <span class="o">.</span> <span class="nv">?p</span><span class="p">)</span>
                                    <span class="p">))</span>
    <span class="c1">;; DONE → Archive.org に移動</span>
    <span class="p">(</span><span class="nv">org-archive-location</span>       <span class="o">.</span> <span class="s">"Archive.org::"</span><span class="p">)</span>
    <span class="c1">;; modules → とりあえずクリアしておく</span>
    <span class="p">(</span><span class="nv">org-modules</span>  <span class="o">.</span> <span class="o">'</span><span class="p">())</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="c1">;; テンプレート展開</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-tempo</span>
    <span class="ss">:if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="p">(</span><span class="nv">string-to-number</span> <span class="nv">org-version</span><span class="p">)</span> <span class="mf">9.2</span><span class="p">)</span>
    <span class="ss">:require</span> <span class="no">t</span><span class="p">)</span>
  <span class="c1">;; +打ち消し+ の font-lock の変更 →これはテーマに任せるべき?</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-emphasis-alist</span>
        <span class="p">(</span><span class="nb">cons</span> <span class="o">'</span><span class="p">(</span><span class="s">"+"</span> <span class="o">'</span><span class="p">(</span><span class="ss">:strike-through</span> <span class="no">t</span> <span class="ss">:foreground</span> <span class="s">"#999999"</span><span class="p">))</span>
              <span class="p">(</span><span class="nv">cl-delete</span> <span class="s">"+"</span> <span class="nv">org-emphasis-alist</span> <span class="ss">:key</span> <span class="ss">'car</span> <span class="ss">:test</span> <span class="ss">'equal</span><span class="p">)))</span>
  <span class="c1">;; (with-eval-after-load "org"</span>
  <span class="c1">;;   (setq org-file-apps '((auto-mode . emacs)</span>
  <span class="c1">;;                         ("\\.mm\\'" . default)</span>
  <span class="c1">;;                         ("\\.x?html?\\'" . default)</span>
  <span class="c1">;;                         ("\\.pdf\\'" . "xdg-open %s")))</span>
  <span class="c1">;;   )</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org67465ee0">Org-Id</h3>
<div class="outline-text-3" id="text-org67465ee0">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-id</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-macs</span> <span class="ss">:require</span> <span class="no">t</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-id-locations-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"org-id-locations"</span> <span class="nv">my:d:share</span><span class="p">))</span>
    <span class="c1">;; (org-id-link-to-org-use-id . create-if-interactive-and-no-custom-id)</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:add-custom-id</span> <span class="p">()</span>
    <span class="s">"Add \"CUSTOM_ID\" to the current tree if not assigned yet."</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">my:org-custom-id-get</span> <span class="no">nil</span> <span class="no">t</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:get-custom-id</span> <span class="p">()</span>
    <span class="s">"Return a part of UUID with an \"org\" prefix.
e.g. \"org3ca6ef0c\"."</span>
    <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">id</span> <span class="p">(</span><span class="nv">org-id-new</span> <span class="s">""</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">org-uuidgen-p</span> <span class="nv">id</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">downcase</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"org"</span>  <span class="p">(</span><span class="nv">substring</span> <span class="p">(</span><span class="nv">org-id-new</span> <span class="s">""</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">8</span><span class="p">))))))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-custom-id-get</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">pom</span> <span class="nv">create</span><span class="p">)</span>
    <span class="s">"Get the CUSTOM_ID property of the entry at point-or-marker POM.
See https://writequit.org/articles/emacs-org-mode-generate-ids.html"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-with-point-at</span> <span class="nv">pom</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">id</span> <span class="p">(</span><span class="nv">org-entry-get</span> <span class="no">nil</span> <span class="s">"CUSTOM_ID"</span><span class="p">)))</span>
        <span class="p">(</span><span class="nb">cond</span>
         <span class="p">((</span><span class="nb">and</span> <span class="nv">id</span> <span class="p">(</span><span class="nb">stringp</span> <span class="nv">id</span><span class="p">)</span> <span class="p">(</span><span class="nv">string-match</span> <span class="s">"\\S-"</span> <span class="nv">id</span><span class="p">))</span>
          <span class="nv">id</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">create</span>
          <span class="p">(</span><span class="k">setq</span> <span class="nv">id</span> <span class="p">(</span><span class="nv">my:get-custom-id</span><span class="p">))</span>
          <span class="p">(</span><span class="nb">unless</span> <span class="nv">id</span>
            <span class="p">(</span><span class="nb">error</span> <span class="s">"Invalid ID"</span><span class="p">))</span>
          <span class="p">(</span><span class="nv">org-entry-put</span> <span class="nv">pom</span> <span class="s">"CUSTOM_ID"</span> <span class="nv">id</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">message</span> <span class="s">"--- CUSTOM_ID assigned: %s"</span> <span class="nv">id</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">org-id-add-location</span> <span class="nv">id</span> <span class="p">(</span><span class="nv">buffer-file-name</span> <span class="p">(</span><span class="nv">buffer-base-buffer</span><span class="p">)))</span>
          <span class="nv">id</span><span class="p">)))))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:delete-all-id-in-file</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">goto-char</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nb">not</span> <span class="p">(</span><span class="nb">eq</span> <span class="p">(</span><span class="nv">point</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-max</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">org-next-visible-heading</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">id</span> <span class="p">(</span><span class="nv">org-entry-get</span> <span class="p">(</span><span class="nv">point</span><span class="p">)</span> <span class="s">"ID"</span><span class="p">)))</span>
        <span class="p">(</span><span class="nb">when</span> <span class="nv">id</span>
          <span class="p">(</span><span class="nv">message</span> <span class="s">"ID: %s"</span> <span class="nv">id</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">org-delete-property</span> <span class="s">"ID"</span><span class="p">))))</span>
    <span class="p">(</span><span class="nv">message</span> <span class="s">"--- done."</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-id-add-to-headlines-in-file</span> <span class="p">()</span>
    <span class="s">"Add CUSTOM_ID properties to all headlines in the current file.
See https://writequit.org/articles/emacs-org-mode-generate-ids.html"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">save-excursion</span>
      <span class="p">(</span><span class="nv">widen</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"^#\\+options:.*auto-id:t"</span> <span class="p">(</span><span class="nv">point-max</span><span class="p">)</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">org-map-entries</span>
         <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nv">my:org-custom-id-get</span> <span class="p">(</span><span class="nv">point</span><span class="p">)</span> <span class="ss">'create</span><span class="p">))))))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'before-save-hook</span> <span class="ss">'my:org-id-add-to-headlines-in-file</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org99399f3b">Babel</h3>
<div class="outline-text-3" id="text-org99399f3b">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-babel</span>
  <span class="ss">:after</span> <span class="nv">all-the-icons-in-terminal</span>
  <span class="ss">:blackout</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-src-mode</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nb">format</span> <span class="s">" %s"</span> <span class="p">(</span><span class="nv">all-the-icons-octicon</span> <span class="s">"code"</span><span class="p">))))</span>
  <span class="ss">:custom</span>
  <span class="p">(</span><span class="c1">;; font-lock</span>
   <span class="p">(</span><span class="nv">org-src-fontify-natively</span>         <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="c1">;; TAB の挙動</span>
   <span class="p">(</span><span class="nv">org-src-tab-acts-natively</span>        <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="c1">;; インデント</span>
   <span class="p">(</span><span class="nv">org-edit-src-content-indentation</span> <span class="o">.</span> <span class="mi">0</span><span class="p">)</span>
   <span class="c1">;; インデントを残す</span>
   <span class="p">(</span><span class="nv">org-src-preserve-indentation</span>     <span class="o">.</span> <span class="no">t</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org016dbf67">Agenda: スケジュール, TODO 表示</h3>
<div class="outline-text-3" id="text-org016dbf67">
<p>
GTD 用の設定．後述の <code>org-gcal</code> と <code>orgmine</code> で取得したデータも表示している．
ついでに
</p>
<ul class="org-ul">
<li>土曜日をの face を追加.</li>
<li>祝日, 休日を日曜と同じfaceにする.</li>
</ul>
<p>
なんて事もやっている．元ネタは <a href="https://julien.danjou.info/blog/2010/org-mode-and-holidays">Org-mode and holidays</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-agenda</span>
  <span class="ss">:commands</span> <span class="nv">org-agenda</span>
  <span class="c1">;; :custom</span>
  <span class="c1">;; (;; day or week</span>
  <span class="c1">;;  (org-agenda-span              . 'day)</span>
  <span class="c1">;;  ;; YY/MM/DD (曜)</span>
  <span class="c1">;;  (org-agenda-format-date       . "%Y/%m/%d (%a)")</span>
  <span class="c1">;;  ;; 日曜始まり</span>
  <span class="c1">;;  (org-agenda-start-on-weekday  . 0)</span>
  <span class="c1">;;  (org-agenda-weekend-days      . '(0))</span>
  <span class="c1">;;  ;; 繰り返し日付も表示</span>
  <span class="c1">;;  (org-agenda-repeating-timestampo-show-all . t)</span>
  <span class="c1">;;  ;; 表示関数</span>
  <span class="c1">;;  ;; (org-agenda-day-face-function . 'my:org-agenda-day-face-function)</span>
  <span class="c1">;;  ;; GTD 用の設定</span>
  <span class="c1">;;  (org-agenda-custom-commands</span>
  <span class="c1">;;   . '(</span>
  <span class="c1">;;       ("n" "agenda and all TODO list"</span>
  <span class="c1">;;        (</span>
  <span class="c1">;;         (agenda ""</span>
  <span class="c1">;;                 ((org-agenda-ndays 1)</span>
  <span class="c1">;;                  (org-agenda-entry-types '(:timestamp :sexp))))</span>
  <span class="c1">;;         (todo "TODO"</span>
  <span class="c1">;;               ((org-agenda-prefix-format " %i %-22:c")))</span>
  <span class="c1">;;         (todo "新規|着手|進行中|確認"</span>
  <span class="c1">;;               ((org-agenda-prefix-format " %i %-22:c")))</span>
  <span class="c1">;;         (todo "WAIT"</span>
  <span class="c1">;;               ((org-agenda-prefix-format " %i %-22:c")))</span>

  <span class="c1">;;         (todo "SOMEDAY"</span>
  <span class="c1">;;               ((org-agenda-prefix-format " %i %-22:c")))</span>
  <span class="c1">;;         ))</span>
  <span class="c1">;;       ("N" "All memo entry"</span>
  <span class="c1">;;        (;;</span>
  <span class="c1">;;         (todo "MEMO")</span>
  <span class="c1">;;         ))</span>
  <span class="c1">;;       )))</span>
  <span class="ss">:defer-config</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-date-saturday</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7FBFFF"</span> <span class="ss">:bold</span> <span class="no">t</span> <span class="p">)))</span>
    <span class="s">"Agenda 表示中の土曜日用のface"</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-date-today-saturday</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:inherit</span> <span class="nv">my:org-agenda-date-saturday</span> <span class="ss">:underline</span> <span class="no">t</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中の今日かつ土曜日用のface"</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-date-today-weekend</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:inherit</span> <span class="nv">org-agenda-date-weekend</span> <span class="ss">:underline</span> <span class="no">t</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中の今日かつ日・祝日用のface"</span><span class="p">)</span>
  <span class="c1">;; こっからは org-gcal で同期したカレンダーの色</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-calendar-Univ</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7FFF7F"</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中, Univ.org の表示 face"</span>
    <span class="ss">:group</span> <span class="ss">'org-agenda</span> <span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-calendar-Schedule</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#7FFFFF"</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中, Schedule.org の表示 face"</span>
    <span class="ss">:group</span> <span class="ss">'org-agenda</span> <span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-calendar-GFD</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#FFFF7F"</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中, GFD.org の表示 face"</span>
    <span class="ss">:group</span> <span class="ss">'org-agenda</span> <span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-calendar-DebianJP</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#BF7FFF"</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中, DebianJP.org の表示 face"</span>
    <span class="ss">:group</span> <span class="ss">'org-agenda</span> <span class="p">)</span>
  <span class="p">(</span><span class="nv">defface</span> <span class="nv">my:org-agenda-calendar-twitter</span>
    <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:foreground</span> <span class="s">"#CCCCCC"</span><span class="p">)))</span>
    <span class="s">"Agenda 表示中, Twitter log の表示 face"</span>
    <span class="ss">:group</span> <span class="ss">'org-agenda</span> <span class="p">)</span>
  <span class="c1">;; 更新用の関数 - とりあえず動いているので良しとするが,</span>
  <span class="c1">;; リファクタリングしたい</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-agenda-day-face-function</span> <span class="p">(</span><span class="nv">date</span><span class="p">)</span>
    <span class="s">"Compute DATE face for saturday, holidays."</span>
    <span class="p">(</span><span class="nv">cl-dolist</span> <span class="p">(</span><span class="nv">file</span> <span class="p">(</span><span class="nv">org-agenda-files</span> <span class="no">nil</span> <span class="ss">'ifmode</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">cond</span>
       <span class="p">((</span><span class="nb">member</span> <span class="p">(</span><span class="nv">calendar-day-of-week</span> <span class="nv">date</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">org-agenda-todayp</span> <span class="nv">date</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'my:org-agenda-date-today-weekend</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'org-agenda-date-weekend</span><span class="p">))</span>
       <span class="p">((</span><span class="nb">member</span> <span class="p">(</span><span class="nv">calendar-day-of-week</span> <span class="nv">date</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">org-agenda-todayp</span> <span class="nv">date</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'my:org-agenda-date-today-saturday</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'my:org-agenda-date-saturday</span><span class="p">)))</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">face</span>
             <span class="p">(</span><span class="nv">cl-dolist</span> <span class="p">(</span><span class="nv">entry</span> <span class="p">(</span><span class="nv">org-agenda-get-day-entries</span> <span class="nv">file</span> <span class="nv">date</span><span class="p">))</span>
               <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">category</span> <span class="p">(</span><span class="nv">with-temp-buffer</span>
                                 <span class="p">(</span><span class="nv">insert</span> <span class="nv">entry</span><span class="p">)</span>
                                 <span class="p">(</span><span class="nv">org-get-category</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">)))))</span>
                 <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nb">or</span> <span class="p">(</span><span class="nb">string=</span> <span class="s">"祝日"</span> <span class="nv">category</span><span class="p">)</span>
                           <span class="p">(</span><span class="nb">string=</span> <span class="s">"休日"</span> <span class="nv">category</span><span class="p">))</span>
                   <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">org-agenda-todayp</span> <span class="nv">date</span><span class="p">)</span>
                       <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'my:org-agenda-date-today-weekend</span><span class="p">)</span>
                     <span class="p">(</span><span class="nv">cl-return</span> <span class="ss">'org-agenda-date-weekend</span><span class="p">)))))))</span>
        <span class="p">(</span><span class="nb">when</span> <span class="nv">face</span> <span class="p">(</span><span class="nv">cl-return</span> <span class="nv">face</span><span class="p">)))))</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-agenda-day-face-function</span>
        <span class="ss">'my:org-agenda-day-face-function</span><span class="p">)</span>
  <span class="c1">;; font-lock の適用</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-agenda-finalize-font-lock</span> <span class="p">()</span>
    <span class="s">"Custom: apply custom font-lock"</span>
    <span class="p">(</span><span class="nv">save-excursion</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"Univ:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span>
         <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
         <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-Univ</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"Schedule:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-Schedule</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"MHC:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-Schedule</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"DebianJP:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-DebianJP</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"GFD:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-GFD</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"twitter:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">my:org-agenda-calendar-twitter</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"誕生日:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">org-agenda-date-weekend</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"祝日:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">org-agenda-date-weekend</span><span class="p">)))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"休日:"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">add-text-properties</span> <span class="p">(</span><span class="nv">match-beginning</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-at-eol</span><span class="p">)</span>
                             <span class="o">'</span><span class="p">(</span><span class="nv">face</span> <span class="nv">org-agenda-date-weekend</span><span class="p">)))))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'org-agenda-finalize-hook</span>
            <span class="nf">#'</span><span class="nv">my:org-agenda-finalize-font-lock</span><span class="p">)</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-agenda-span</span> <span class="ss">'day</span>
        <span class="nv">org-agenda-format-date</span> <span class="s">"%Y/%m/%d (%a)"</span>
        <span class="nv">org-agenda-start-on-weekday</span> <span class="mi">0</span>
        <span class="nv">org-agenda-weekend-days</span> <span class="o">'</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="nv">org-agenda-repeating-timestampo-show-all</span> <span class="no">t</span>
        <span class="nv">org-agenda-day-face-function</span> <span class="ss">'my:org-agenda-day-face-function</span>
        <span class="nv">org-agenda-custom-commands</span>
        <span class="o">'</span><span class="p">(</span>
          <span class="p">(</span><span class="s">"n"</span> <span class="s">"agenda and all TODO list"</span>
           <span class="p">(</span>
            <span class="p">(</span><span class="nv">agenda</span> <span class="s">""</span>
                    <span class="p">((</span><span class="nv">org-agenda-ndays</span> <span class="mi">1</span><span class="p">)</span>
                     <span class="p">(</span><span class="nv">org-agenda-entry-types</span> <span class="o">'</span><span class="p">(</span><span class="ss">:timestamp</span> <span class="ss">:sexp</span><span class="p">))))</span>
            <span class="p">(</span><span class="nv">todo</span> <span class="s">"TODO"</span>
                  <span class="p">((</span><span class="nv">org-agenda-prefix-format</span> <span class="s">" %i %-22:c"</span><span class="p">)))</span>
            <span class="p">(</span><span class="nv">todo</span> <span class="s">"新規|着手|進行中|確認"</span>
                  <span class="p">((</span><span class="nv">org-agenda-prefix-format</span> <span class="s">" %i %-22:c"</span><span class="p">)))</span>
            <span class="p">(</span><span class="nv">todo</span> <span class="s">"WAIT"</span>
                  <span class="p">((</span><span class="nv">org-agenda-prefix-format</span> <span class="s">" %i %-22:c"</span><span class="p">)))</span>

            <span class="p">(</span><span class="nv">todo</span> <span class="s">"SOMEDAY"</span>
                  <span class="p">((</span><span class="nv">org-agenda-prefix-format</span> <span class="s">" %i %-22:c"</span><span class="p">)))</span>
            <span class="p">))</span>
          <span class="p">(</span><span class="s">"N"</span> <span class="s">"All memo entry"</span>
           <span class="p">(</span><span class="c1">;;</span>
            <span class="p">(</span><span class="nv">todo</span> <span class="s">"MEMO"</span><span class="p">)</span>
            <span class="p">))</span>
          <span class="p">)</span>
        <span class="p">)</span>
  <span class="c1">;; 使用するファイル</span>
  <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">file</span>
           <span class="o">'</span><span class="p">(</span><span class="s">"Archive.org"</span>
             <span class="s">"Holidays.org"</span>
             <span class="s">"Memo.org"</span>
             <span class="s">"Schedule.org"</span>
             <span class="s">"MHC.org"</span>
             <span class="s">"GFD.org"</span>
             <span class="s">"Univ.org"</span>
             <span class="s">"DebianJP.org"</span>
             <span class="s">"twitter.org"</span>
             <span class="s">"redmine_GFD.org"</span>
             <span class="s">"redmine_FluidSoc.org"</span>
             <span class="p">))</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-agenda-files</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">file</span> <span class="nv">my:d:org</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-agenda-files</span> <span class="p">(</span><span class="nv">locate-user-emacs-file</span> <span class="s">"README.org"</span><span class="p">))</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">file-directory-p</span>
       <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Public/"</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)))</span>
      <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">file</span>
               <span class="p">(</span><span class="nv">directory-files-recursively</span>
                <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Public/"</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">))</span> <span class="s">"org$"</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-agenda-files</span> <span class="nv">file</span><span class="p">)))</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nv">file-directory-p</span>
       <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"journal/"</span> <span class="nv">my:d:org</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">file</span>
               <span class="p">(</span><span class="nv">directory-files-recursively</span>
                <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"journal/"</span> <span class="nv">my:d:org</span><span class="p">)</span> <span class="s">"org$"</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-agenda-files</span> <span class="nv">file</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org456c87fa">Org-journal: 日記</h3>
<div class="outline-text-3" id="text-org456c87fa">
<p>
機能が豊富なのだが, イマイチ使いこなせていない.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-journal</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d:org</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">emacs-major-version</span> <span class="mi">25</span><span class="p">))</span>
  <span class="ss">:commands</span> <span class="nv">my:org-journal-new-entry</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="ss">:org-journal-mode-map</span>
          <span class="p">(</span><span class="s">"C-c C-c"</span> <span class="o">.</span> <span class="nv">my:org-journal-entry-save-and-exit</span><span class="p">)))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-journal-new-entry</span> <span class="p">(</span><span class="nv">prefix</span> <span class="k">&amp;optional</span> <span class="nb">time</span><span class="p">)</span>
    <span class="s">"Add new journal entry on new elscreen"</span>
    <span class="p">(</span><span class="nv">interactive</span> <span class="s">"P"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">elscreen-create</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-new-entry</span> <span class="no">nil</span> <span class="nb">time</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-journal-entry-save-and-exit</span> <span class="p">()</span>
    <span class="s">"Save journal entry and close elscreen buffer"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">save-buffer</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">elscreen-kill</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">((</span><span class="nv">org-journal-mode-hook</span>
    <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span><span class="p">()</span>
        <span class="p">(</span><span class="nv">setq-local</span> <span class="nv">truncate-lines</span> <span class="no">t</span><span class="p">))))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-journal-file-type</span>                 <span class="o">.</span> <span class="ss">'yearly</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-dir</span>                       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"journal"</span> <span class="nv">my:d:org</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-journal-file-format</span>               <span class="o">.</span> <span class="s">"%Y.org"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-cache-file</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"org-journal.cache"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-journal-date-format</span>               <span class="o">.</span> <span class="s">"%x (%a)"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-time-format</span>               <span class="o">.</span> <span class="s">"&lt;%Y-%m-%d %R&gt; "</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-time-prefix</span>               <span class="o">.</span> <span class="s">"** MEMO "</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-enable-agenda-integration</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-find-file</span>                 <span class="o">.</span> <span class="ss">'find-file</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-carryover-delete-empty-journal</span> <span class="o">.</span> <span class="ss">'ask</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-journal-start-on-weekday</span>          <span class="o">.</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">;; sunday</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">eval-and-compile</span> <span class="ss">'browse-url</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="ss">'org-journal</span>
    <span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">"C-c C-j"</span><span class="p">)</span> <span class="ss">'browse-url-at-point</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orgbe835a6b">Org-capture: メモ取り</h3>
<div class="outline-text-3" id="text-orgbe835a6b">
<p>
キーバインドは以前 changelog memo をやっていた時の癖で <code>C-x m</code> をメモにしている.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-capture</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d:org</span><span class="p">)</span>
  <span class="ss">:commands</span> <span class="nv">org-capture</span>
  <span class="ss">:pl-setq</span>
  <span class="p">(</span><span class="nv">my:org:calendar1</span> <span class="nv">my:org:calendar2</span><span class="p">)</span>   <span class="c1">;; 名前がイケてないっ!</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-journal-add-date-entry-capture</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">org-journal-new-entry</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-max</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-default-notes-file</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Memo.org"</span> <span class="nv">my:d:org</span><span class="p">))</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-capture-templates</span>
        <span class="o">`</span><span class="p">(</span>
          <span class="p">(</span><span class="s">"t"</span> <span class="s">"TODO"</span> <span class="nv">plain</span>
           <span class="p">(</span><span class="k">function</span> <span class="nv">my:org-journal-add-date-entry-capture</span><span class="p">)</span>
           <span class="s">"** TODO %(format-time-string org-journal-time-format)%^{title} %^g\n  %?\n  %a"</span>
           <span class="ss">:prepend</span> <span class="no">nil</span>
           <span class="ss">:unnarrowed</span> <span class="no">nil</span>
           <span class="ss">:kill-buffer</span> <span class="no">t</span>
           <span class="p">)</span>
          <span class="p">(</span><span class="s">"m"</span> <span class="s">"メモを追加"</span> <span class="nv">plain</span>
           <span class="p">(</span><span class="k">function</span> <span class="nv">my:org-journal-add-date-entry-capture</span><span class="p">)</span>
           <span class="s">"** MEMO %(format-time-string org-journal-time-format)%?"</span>
           <span class="ss">:prepend</span> <span class="no">nil</span>
           <span class="ss">:unnarrowed</span> <span class="no">nil</span>
           <span class="ss">:kill-buffer</span> <span class="no">t</span>
           <span class="p">)</span>
          <span class="p">(</span><span class="s">"a"</span> <span class="s">"少し長めの記事を追加する"</span> <span class="nv">plain</span>
           <span class="p">(</span><span class="k">function</span> <span class="nv">my:org-journal-add-date-entry-capture</span><span class="p">)</span>
           <span class="s">"** ARTICLE %(format-time-string org-journal-time-format)%? "</span>
           <span class="ss">:prepend</span> <span class="no">nil</span>
           <span class="ss">:unnarrowed</span> <span class="no">nil</span>
           <span class="ss">:kill-buffer</span> <span class="no">t</span>
           <span class="p">)</span>
          <span class="p">(</span><span class="s">"s"</span> <span class="s">"個人予定表スケジュールを追加"</span> <span class="nv">plain</span>
           <span class="p">(</span><span class="nv">file</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Schedule.org"</span> <span class="nv">my:d:org</span><span class="p">))</span>
           <span class="s">"* %^{prompt}\n  :PROPERTIES:\n  :calendar-id: %(format \"%s\" my:org:calendar1)\n  :END:\n  :org-gcal:\n%?\n%i\n  :END:"</span>
           <span class="ss">:prepend</span> <span class="no">nil</span>
           <span class="ss">:unnarrowed</span> <span class="no">nil</span>
           <span class="ss">:kill-buffer</span> <span class="no">t</span>
           <span class="p">)</span>
          <span class="p">(</span><span class="s">"u"</span> <span class="s">"仕事予定表スケジュールを追加"</span> <span class="nv">plain</span>
           <span class="p">(</span><span class="nv">file</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Univ.org"</span> <span class="nv">my:d:org</span><span class="p">))</span>
           <span class="s">"* %^{prompt}\n  :PROPERTIES:\n  :calendar-id: %(format \"%s\" my:org:calendar2)\n  :END:\n  :org-gcal:\n%?\n%i\n  :END:"</span>
           <span class="ss">:prepend</span> <span class="no">nil</span>
           <span class="ss">:unnarrowed</span> <span class="no">nil</span>
           <span class="ss">:kill-buffer</span> <span class="no">t</span>
           <span class="p">)</span>
          <span class="p">)</span>
        <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org6a1d2f0c">OrgとGoogle カレンダーの連携: <code>org-gcal</code>
</h3>
<div class="outline-text-3" id="text-org6a1d2f0c">
<p>
request token 等の置き場所の変更
実際の情報等は <code>password-store</code> を使って設定しておく.
ついでに agenda 表示の際の色付けを設定．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-gcal</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">my:d:password-store</span>
           <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d:org</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:commands</span> <span class="p">(</span><span class="nv">org-gcal-fetch</span> <span class="nv">org-gcal-sync</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">org-gcal-dir</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"org-gcal"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">org-gcal-dir</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">make-directory</span> <span class="nv">org-gcal-dir</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">request</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:preface</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">request-storage-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"request"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">request-storage-directory</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">make-directory</span> <span class="nv">request-storage-directory</span><span class="p">))</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">request-storage-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"request"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">persist</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">persist--directory-location</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"persist"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-gcal-dir</span>          <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span>
                               <span class="s">"org-gcal"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-gcal-token-file</span>   <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span>
                               <span class="s">"org-gcal/.org-gcal-token"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-gcal-down-days</span>    <span class="o">.</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1">;; 未来 180 日</span>
    <span class="p">(</span><span class="nv">org-gcal-up-days</span>      <span class="o">.</span>  <span class="mi">30</span><span class="p">)</span>  <span class="c1">;; 過去 30 日</span>
    <span class="p">(</span><span class="nv">org-gcal-auto-archive</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-gcal-notify-p</span>     <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-gcal-remove-api-cancelled-evetnts</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-gcal-remove-events-with-cancelled-todo</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="c1">;;</span>
    <span class="p">(</span><span class="nv">alert-log-messages</span>    <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">alert-default-style</span>   <span class="o">.</span><span class="ss">'libnotify</span><span class="p">))</span>
  <span class="ss">:pl-setq</span>
  <span class="p">(</span><span class="nv">org-gcal-client-id</span>
   <span class="nv">org-gcal-client-secret</span>
   <span class="nv">org-gcal-file-alist</span><span class="p">)</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">org-capture-after-finalize-hook</span>  <span class="o">.</span> <span class="nv">org-gcal-fetch</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org5908f7b5">OrgとRedmine の連携: <code>orgmine</code>
</h3>
<div class="outline-text-3" id="text-org5908f7b5">
<p>
素晴しい!!
<a href="https://github.com/kametoku/orgmine">kametoku/orgmine: Emacs minor mode for org-mode with redmine integration</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*orgmine</span>
  <span class="ss">:if</span>  <span class="p">(</span><span class="nb">and</span> <span class="nv">my:d:password-store</span>
            <span class="p">(</span><span class="nv">file-directory-p</span> <span class="nv">my:d:org</span><span class="p">))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">enable-local-variables</span> <span class="ss">:safe</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">elmine</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">add-hook</span> <span class="ss">'org-mode-hook</span>
            <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
              <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">assoc</span> <span class="s">"om_server"</span> <span class="nv">org-file-properties</span><span class="p">)</span> <span class="p">(</span><span class="nv">orgmine-mode</span><span class="p">))))</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">orgmine</span>
    <span class="ss">:commands</span> <span class="p">(</span><span class="nv">orgmine-mode</span><span class="p">)</span>
    <span class="ss">:el-get</span> <span class="nv">kametoku/orgmine</span>
    <span class="ss">:pl-setq</span> <span class="nv">orgmine-servers</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">orgmine-note-block-begin</span> <span class="s">"#+begin_src gfm"</span>   <span class="c1">;; 要調整</span>
          <span class="nv">orgmine-note-block-end</span>   <span class="s">"#+end_src\n"</span>
          <span class="nv">orgmine-default-todo-keyword</span> <span class="s">"新規"</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org0ea55d7d">OrgとTrelloの連携: <code>org-trello</code>
</h3>
<div class="outline-text-3" id="text-org0ea55d7d">
<p>
ToDo管理に Trello を使い始めたので, 設定
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (leaf org-trello</span>
<span class="c1">;;   :if (and my:d:password-store</span>
<span class="c1">;;            (file-directory-p my:d:org))</span>
<span class="c1">;;   :ensure t</span>
<span class="c1">;;   :custom</span>
<span class="c1">;;   `((org-trello-files . '(,(expand-file-name "Trello.org" my:d:org))))</span>
<span class="c1">;;   )</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org5f8d1640">Org-Wiki</h3>
<div class="outline-text-3" id="text-org5f8d1640">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-wiki</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="s">"~/Public/cc-env"</span><span class="p">)</span>
  <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">org-wiki</span>
           <span class="ss">:type</span> <span class="nv">github</span>
           <span class="ss">:pkgname</span> <span class="s">"uwabami/org-wiki"</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-wiki-location</span>    <span class="o">.</span> <span class="s">"~/Public/cc-env"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-wiki-publish-root</span> <span class="o">.</span> <span class="s">"{{site.url}}/cc-env/"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-wiki-template</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">concat</span> <span class="s">"#+TITLE: %n\n"</span>
                <span class="s">"#+date: 20\n"</span>
                <span class="s">"#+LAYOUT: default\n"</span>
                <span class="s">"#+PREMALINK: /cc-env/%n.html\n"</span>
                <span class="s">"#+options: auto-id:nil\n"</span>
                <span class="s">"#+REF: cc-env/%n\n"</span>
                <span class="s">"Related [[wiki:index][Index]] [[~/Public/cc-env/index.org::#orge0707863][Debian]]\n"</span>
                <span class="s">"* %n\n"</span>
                <span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org54ab7934">Org-Export</h3>
<div class="outline-text-3" id="text-org54ab7934">
</div>
<div>
<h4 id="org06031219">全般設定</h4>
<div class="outline-text-4" id="text-org06031219">
<p>
latex, beamer,jekyll(後述) のみを有効に.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ox</span>
  <span class="ss">:preface</span>
  <span class="c1">;; 空行の削除</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:remove-org-newlines-at-cjk-text</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">_mode</span><span class="p">)</span>
    <span class="s">"先頭が '*', '#', '|' でなく、改行の前後が日本の文字の場合は改行を除去"</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-min</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nv">re-search-forward</span> <span class="s">"^\\([^|#*\n].+\\)\\(.\\)\n *\\(.\\)"</span> <span class="no">nil</span> <span class="no">t</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">string-to-char</span> <span class="p">(</span><span class="nv">match-string</span> <span class="mi">2</span><span class="p">))</span> <span class="m">#x2000</span><span class="p">)</span>
               <span class="p">(</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nv">string-to-char</span> <span class="p">(</span><span class="nv">match-string</span> <span class="mi">3</span><span class="p">))</span> <span class="m">#x2000</span><span class="p">))</span>
          <span class="p">(</span><span class="nv">replace-match</span> <span class="s">"\\1\\2\\3"</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">goto-char</span> <span class="p">(</span><span class="nv">point-at-bol</span><span class="p">))))</span>
  <span class="ss">:hook</span>
  <span class="c1">;; ((org-export-before-processing-hook . my:remove-org-newlines-at-cjk-text))</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">org-export-backends</span>             <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="c1">;; remove somve built-in</span>
                                        <span class="c1">;; html</span>
                                        <span class="nv">jekyll</span>
                                        <span class="nv">latex</span>
                                        <span class="nv">beamer</span><span class="p">))</span>
   <span class="p">(</span><span class="nv">org-export-with-toc</span>             <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">org-export-with-section-numbers</span> <span class="o">.</span> <span class="no">nil</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org10cd0de1">HTML</h4>
<div class="outline-text-4" id="text-org10cd0de1">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ox-html</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">org-html-table-align-individual-fields</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">org-html-table-default-attributes</span>      <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">org-html-html5-fancy</span>                   <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">org-html-doctype</span>                       <span class="o">.</span> <span class="s">"html5"</span><span class="p">)</span>
   <span class="c1">;; (org-html-container-element             . "div")</span>
   <span class="p">(</span><span class="nv">org-html-inline-image-rules</span>
    <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="s">"file"</span>  <span class="o">.</span> <span class="s">"\\.\\(jpeg\\|jpg\\|png\\|gif\\|webp\\|svg\\)\\'"</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"http"</span>  <span class="o">.</span> <span class="s">"\\.\\(jpeg\\|jpg\\|png\\|gif\\|webp\\|svg\\)\\'"</span><span class="p">)</span>
        <span class="p">(</span><span class="s">"https"</span> <span class="o">.</span> <span class="s">"\\.\\(jpeg\\|jpg\\|png\\|gif\\|webp\\|svg\\)\\'"</span><span class="p">)))</span>
   <span class="p">)</span>
<span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org4d9c6533">LaTeX, Beamer</h4>
<div class="outline-text-4" id="text-org4d9c6533">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ox-latex</span>
  <span class="ss">:after</span> <span class="nv">ox</span>
  <span class="ss">:preface</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">ox-beamer</span>
    <span class="ss">:custom</span>
    <span class="o">`</span><span class="p">((</span><span class="nv">org-beamer-frame-level</span> <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">org-beamer-frame-default-options</span> <span class="o">.</span> <span class="s">"fragile,squeeze,c"</span><span class="p">)</span>
      <span class="p">)</span>
    <span class="ss">:config</span>
    <span class="c1">;; for Beamer</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-options-alist</span>
                 <span class="o">'</span><span class="p">(</span><span class="ss">:shortdate</span>    <span class="s">"SHORTDATE"</span>   <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-options-alist</span>
                 <span class="o">'</span><span class="p">(</span><span class="ss">:shorttitle</span>   <span class="s">"SHORTTITLE"</span>  <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-options-alist</span>
                 <span class="o">'</span><span class="p">(</span><span class="ss">:shortauthor</span>  <span class="s">"SHORTAUTHOR"</span> <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-options-alist</span>
                 <span class="o">'</span><span class="p">(</span><span class="ss">:institute</span>    <span class="s">"INSTITUTE"</span>   <span class="no">nil</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-latex-default-class</span> <span class="o">.</span> <span class="s">"my:platex"</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-latex-pdf-process</span>   <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">"latexmk -pvc %f"</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">org-latex-classes</span>
     <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="s">"my:platex"</span>
          <span class="s">"\\documentclass[a4j]{jsarticle}
            [NO-DEFAULT-PACKAGES] [NO-PACKAGES] [EXTRA]"</span>
          <span class="p">(</span><span class="s">"\\section\{%s\}"</span> <span class="o">.</span> <span class="s">"\\section*\{%s\}"</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"\\subsection\{%s\}"</span> <span class="o">.</span> <span class="s">"\\subsection*\{%s\}"</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"\\subsubsection\{%s\}"</span> <span class="o">.</span> <span class="s">"\\subsubsection*\{%s\}"</span><span class="p">))</span>
         <span class="p">(</span><span class="s">"my:beamer"</span>
          <span class="s">"\\documentclass[dvipdfmx,presentation]{beamer}
             [NO-DEFAULT-PACKAGES] [NO-PACKAGES] [EXTRA]"</span>
          <span class="p">(</span><span class="s">"\\section\{%s\}"</span> <span class="o">.</span> <span class="s">"\\section*\{%s\}"</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"\\subsection\{%s\}"</span> <span class="o">.</span> <span class="s">"\\subsection*\{%s\}"</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"\\subsubsection\{%s\}"</span> <span class="o">.</span> <span class="s">"\\subsubsection*\{%s\}"</span><span class="p">))))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h4 id="org589a50cc">Jekyll</h4>
<div class="outline-text-4" id="text-org589a50cc">
<p>
Web サイトは Jekyll で作成しています.
以前は org file を直接 jekyll で処理していましたが,
最近は org を html に export して, それを処理する様にしています.
</p>

<p>
exporter は <a href="https://uwabami.github.com/ox-jekyll">uwabami/ox-jekyll</a> にあります.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ox-jekyll</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="s">"~/Public/cc-env"</span><span class="p">)</span>
  <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">ox-jekyll</span>
           <span class="ss">:type</span> <span class="nv">github</span>
           <span class="ss">:pkgname</span> <span class="s">"uwabami/ox-jekyll"</span><span class="p">)</span>
  <span class="ss">:after</span> <span class="nv">ox-html</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-wiki-jekyll-finalized1</span> <span class="p">(</span><span class="nv">contents</span> <span class="nv">backend</span> <span class="nv">info</span><span class="p">)</span>
    <span class="s">"Replace some URL"</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">org-export-derived-backend-p</span> <span class="nv">backend</span> <span class="ss">'jekyll</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">s-replace</span>
       <span class="p">(</span><span class="nb">format</span> <span class="s">"&lt;a href=\"file://%sREADME.html"</span>
               <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">user-emacs-directory</span><span class="p">))</span>
       <span class="s">"&lt;a href=\"{{baseurl}}/cc-env/Emacs.html"</span>
       <span class="nv">contents</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-filter-body-functions</span>
               <span class="ss">'my:org-wiki-jekyll-finalized1</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-wiki-jekyll-finalized2</span> <span class="p">(</span><span class="nv">contents</span> <span class="nv">backend</span> <span class="nv">info</span><span class="p">)</span>
    <span class="s">"Replace some URL"</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">org-export-derived-backend-p</span> <span class="nv">backend</span> <span class="ss">'jekyll</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">s-replace</span>
       <span class="p">(</span><span class="nb">format</span> <span class="s">"&lt;a href=\"file://%s"</span>
               <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"Public/"</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)))</span>
       <span class="s">"&lt;a href=\"{{site.url}}/"</span>
       <span class="nv">contents</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-filter-body-functions</span>
               <span class="ss">'my:org-wiki-jekyll-finalized2</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-wiki-jekyll-finalized3</span> <span class="p">(</span><span class="nv">contents</span> <span class="nv">backend</span> <span class="nv">info</span><span class="p">)</span>
    <span class="s">"Replace some URL"</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">org-export-derived-backend-p</span> <span class="nv">backend</span> <span class="ss">'jekyll</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">replace-regexp-in-string</span>
     <span class="s">" id=\"outline-container-org.+\" class=\"outline-.+\""</span>
     <span class="s">""</span> <span class="nv">contents</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-filter-body-functions</span>
               <span class="ss">'my:org-wiki-jekyll-finalized3</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:org-wiki-jekyll-finalized4</span> <span class="p">(</span><span class="nv">contents</span> <span class="nv">backend</span> <span class="nv">info</span><span class="p">)</span>
    <span class="s">"Replace some URL"</span>
    <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">org-export-derived-backend-p</span> <span class="nv">backend</span> <span class="ss">'jekyll</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">replace-regexp-in-string</span>
     <span class="s">"&lt;a id=\"org.+?\"&gt;&lt;/a&gt;"</span>
     <span class="s">""</span> <span class="nv">contents</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'org-export-filter-body-functions</span>
               <span class="ss">'my:org-wiki-jekyll-finalized4</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h3 id="orge77c5c82">Org-Publish</h3>
<div class="outline-text-3" id="text-orge77c5c82">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-publish</span>
  <span class="ss">:after</span> <span class="p">(</span><span class="nv">ox-jekyll</span> <span class="nv">org-wiki</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">org-publish-timestamp-directory</span>
    <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"org-timestamps.el"</span> <span class="nv">my:d:tmp</span><span class="p">)))</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">org-wiki-publish</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">org-publish</span> <span class="p">(</span><span class="nv">org-wiki-make-org-publish-plist</span>
                  <span class="ss">'org-jekyll-publish-to-html</span><span class="p">)</span>
                 <span class="no">t</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org912b87a3">Outline Magic</h2>
<div class="outline-text-2" id="text-org912b87a3">
<p>
どんどん増えそう．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">outline</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">outline-magic</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:bind</span> <span class="p">((</span><span class="ss">:outline-minor-mode-map</span>
            <span class="p">(</span><span class="s">"C-c TAB"</span> <span class="o">.</span> <span class="nv">outline-cycle</span><span class="p">)))</span>
    <span class="ss">:hook</span> <span class="p">((</span><span class="nv">LaTeX-mode-hook</span> <span class="o">.</span> <span class="nv">my:add-outline-headings</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">LaTeX-mode-hook</span> <span class="o">.</span> <span class="nv">outline-minor-mode</span><span class="p">))</span>
    <span class="ss">:init</span>
    <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:add-outline-headings</span> <span class="p">()</span>
      <span class="s">"Custom: Add promotion headings"</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">outline-promotion-headings</span> <span class="o">'</span><span class="p">(</span><span class="s">"\\chapter"</span>
                                         <span class="s">"\\section"</span>
                                         <span class="s">"\\subsection"</span>
                                         <span class="s">"\\subsubsection"</span>
                                         <span class="s">"\\paragraph"</span>
                                         <span class="s">"\\subparagraph"</span>
                                         <span class="s">"\\begin{frame}"</span>
                                         <span class="p">)))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orgc6b67eb9">VCS</h2>
<div class="outline-text-2" id="text-orgc6b67eb9">
<p>
まあ, ほとんど Git 関連な訳ですが．
</p>
</div>
<div>
<h3 id="org429f5b00">git{attributes,config,ignore}-mode, git-commit</h3>
<div class="outline-text-3" id="text-org429f5b00">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*git</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">emacs-major-version</span> <span class="mi">25</span><span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">git-commit</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">gitattributes-mode</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">gitconfig-mode</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">gitignore-mode</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org59371622">magit:</h3>
<div class="outline-text-3" id="text-org59371622">
<p>
magit は Emacs の Git Frontend.
結局の所 CUI でコマンド叩く事も多いけれど, これはこれで重宝している．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">magit</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"C-x g"</span> <span class="o">.</span> <span class="nv">magit-status</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">transient</span>
    <span class="ss">:custom</span>
    <span class="o">`</span><span class="p">((</span><span class="nv">transient-history-file</span>
       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"transient-history.el"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">transient-levels-file</span>
       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"transient-levels.el"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">transient-values-file</span>
       <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"transient-values.el"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">transient-force-fixed-pitch</span> <span class="o">.</span> <span class="no">t</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">magit-completing-read-function</span> <span class="ss">'ido</span>
        <span class="nv">magit-refs-show-commit-count</span>   <span class="ss">'all</span>
        <span class="nv">magit-log-buffer-file-locked</span>   <span class="no">t</span>
        <span class="nv">magit-revision-show-gravatars</span>  <span class="no">nil</span>
        <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org6727f452">Forge</h3>
<div class="outline-text-3" id="text-org6727f452">
<p>
Gitub/Gitlab と Magit の連携
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">forge</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:after</span> <span class="nv">magit</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org994abf0f">Git Gutter+</h3>
<div class="outline-text-3" id="text-org994abf0f">
<p>
飽きたら止めるかもしれないけれど.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">git-gutter+</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">emacs-major-version</span> <span class="mi">25</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="o">`</span><span class="p">((</span><span class="nv">git-gutter+-mode</span>
               <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nb">format</span> <span class="s">"%s"</span> <span class="p">(</span><span class="nv">all-the-icons-octicon</span> <span class="s">"git-merge"</span><span class="p">))))</span>
  <span class="ss">:bind</span> <span class="p">(</span><span class="s">"C-x G"</span> <span class="o">.</span> <span class="nv">global-git-gutter+-mode</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org710c040c">関数定義を辿る: <code>dump-jump</code>, <code>smart-jump</code>
</h2>
<div class="outline-text-2" id="text-org710c040c">
<p>
あまり上手く使えていない.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">dumb-jump</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"rg"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="s">"M-g o"</span> <span class="o">.</span> <span class="nv">dumb-jump-go-other-window</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"M-g j"</span> <span class="o">.</span> <span class="nv">dumb-jump-go</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"M-g i"</span> <span class="o">.</span> <span class="nv">dumb-jump-go-prompt</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"M-g x"</span> <span class="o">.</span> <span class="nv">dumb-jump-go-prefer-external</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"M-g z"</span> <span class="o">.</span> <span class="nv">dumb-jump-go-prefer-external-other-window</span><span class="p">))</span>
  <span class="ss">:custom</span> <span class="o">'</span><span class="p">((</span><span class="nv">dumb-jump-selector</span>       <span class="o">.</span> <span class="ss">'ido</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">dumb-jump-force-searcher</span> <span class="o">.</span> <span class="ss">'rg</span><span class="p">))</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">smart-jump</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">smart-jump-setup-default-registers</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org935a4dbf">
<span class="done SOMEDAY">SOMEDAY</span> 言語毎の補完: <code>company-mode</code>
</h2>
<div class="outline-text-2" id="text-org935a4dbf">
<p>
まだうまく使いこなせていない．
</p>
<ul class="org-ul">
<li><a href="https://qiita.com/wktkshn/items/3ac46671d1c242a59f7e">company-dabbrevで日本語を補完しない</a></li>
</ul>
<p>
を有効にしてみたが, これで良いのかしら…?
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">company</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="no">t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">edit-category-table-for-company-dabbrev</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">define-category</span> <span class="nv">?s</span> <span class="s">"word constituents for company-dabbrev"</span> <span class="nv">table</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">i</span> <span class="mi">0</span><span class="p">))</span>
      <span class="p">(</span><span class="nv">while</span> <span class="p">(</span><span class="nb">&lt;</span> <span class="nv">i</span> <span class="mi">128</span><span class="p">)</span>
        <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">equal</span> <span class="nv">?w</span> <span class="p">(</span><span class="nv">char-syntax</span> <span class="nv">i</span><span class="p">))</span>
            <span class="p">(</span><span class="nv">modify-category-entry</span> <span class="nv">i</span> <span class="nv">?s</span> <span class="nv">table</span><span class="p">)</span>
          <span class="p">(</span><span class="nv">modify-category-entry</span> <span class="nv">i</span> <span class="nv">?s</span> <span class="nv">table</span> <span class="no">t</span><span class="p">))</span>
        <span class="p">(</span><span class="k">setq</span> <span class="nv">i</span> <span class="p">(</span><span class="nb">1+</span> <span class="nv">i</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nv">edit-category-table-for-company-dabbrev</span><span class="p">)</span>
  <span class="c1">;; (add-hook 'TeX-mode-hook 'edit-category-table-for-company-dabbrev) ; 下の追記参照</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">company-dabbrev-char-regexp</span> <span class="s">"\\cs"</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">company-idle-delay</span>            <span class="o">.</span> <span class="mi">0</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">company-selection-wrap-around</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">company-minimum-prefix-length</span> <span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
   <span class="c1">;; disable some noisy default backends</span>
   <span class="p">(</span><span class="nv">company-backends</span> <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="nv">company-files</span>
                         <span class="nv">company-capf</span>
                         <span class="p">(</span><span class="nv">company-dabbrev-code</span>
                          <span class="nv">company-gtags</span>
                          <span class="nv">company-etags</span>
                          <span class="nv">company-keywords</span><span class="p">))))</span>
  <span class="ss">:bind</span>
  <span class="p">(</span><span class="c1">;; ("&lt;tab&gt;"    . company-indent-or-complete-common)</span>
   <span class="p">(</span><span class="ss">:company-active-map</span>
    <span class="p">(</span><span class="s">"C-n"</span>     <span class="o">.</span> <span class="nv">company-select-next</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"C-p"</span>     <span class="o">.</span> <span class="nv">company-select-previous</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"C-s"</span>     <span class="o">.</span> <span class="nv">company-filter-candidates</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"C-&lt;tab&gt;"</span> <span class="o">.</span> <span class="nv">company-complete-common-or-cycle</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"&lt;tab&gt;"</span>   <span class="o">.</span> <span class="nv">company-indent-or-complete-common</span><span class="p">)</span>
    <span class="p">)</span>
   <span class="p">(</span><span class="ss">:company-search-map</span>
    <span class="p">(</span><span class="s">"C-p"</span> <span class="o">.</span> <span class="nv">company-select-previous</span><span class="p">)</span>
    <span class="p">(</span><span class="s">"C-n"</span> <span class="o">.</span> <span class="nv">company-select-next</span><span class="p">)))</span>
  <span class="ss">:hook</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">after-init-hook</span>      <span class="o">.</span> <span class="nv">global-company-mode</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">minibuffer-setup-hook</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
                                <span class="p">(</span><span class="nv">company-mode</span> <span class="mi">-1</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="on">
<code>[X]</code> <a href="https://github.com/TheBB/company-reftex">TheBB/company-reftex</a>
</li>
<li class="on">
<code>[X]</code> <a href="https://github.com/vspinu/company-math">vspinu/company-math</a>
</li>
<li class="on">
<code>[X]</code> <a href="https://github.com/alexeyr/company-auctex">alexeyr/company-auctex</a>
</li>
</ul>
</div>
</div>
<div>
<h2 id="orgffdbe5ff">
<span class="done SOMEDAY">SOMEDAY</span> テンプレート補完: <code>yasnippet</code> <code>[0/1]</code>
</h2>
<div class="outline-text-2" id="text-orgffdbe5ff">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">yasnippet</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:blackout</span> <span class="no">t</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">yas-indent-line</span>  <span class="o">.</span> <span class="ss">'fixed</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">yas-snippet-dirs</span> <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"snippets"</span> <span class="nv">my:d:share</span><span class="p">))))</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">after-init-hook</span> <span class="o">.</span> <span class="nv">yas-global-mode</span><span class="p">)</span>
  <span class="ss">:bind</span> <span class="p">((</span><span class="nv">yas-keymap</span>
          <span class="p">(</span><span class="s">"C-&lt;tab&gt;"</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"&lt;tab&gt;"</span>   <span class="o">.</span> <span class="no">nil</span><span class="p">))</span>  <span class="c1">; for company</span>
         <span class="p">(</span><span class="nv">yas-minor-mode-map</span>
          <span class="p">(</span><span class="s">"&lt;tab&gt;"</span>   <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-&lt;tab&gt;"</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y e"</span> <span class="o">.</span> <span class="nv">yas-expand</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y i"</span> <span class="o">.</span> <span class="nv">yas-insert-snippet</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y n"</span> <span class="o">.</span> <span class="nv">yas-new-snippet</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y v"</span> <span class="o">.</span> <span class="nv">yas-visit-snippet-file</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y l"</span> <span class="o">.</span> <span class="nv">yas-describe-tables</span><span class="p">)</span>
          <span class="p">(</span><span class="s">"C-c y g"</span> <span class="o">.</span> <span class="nv">yas-reload-all</span><span class="p">)))</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">yasnippet-snippets</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">yatemplate</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> 意図しない所で発火してテンプレートが挿入されてしまうので保留中</li>
</ul>
</div>
</div>
<div>
<h2 id="orgd4b6f681">
<span class="done SOMEDAY">SOMEDAY</span> <code>flymake</code>: on-the-fly check <code>[0/1]</code>
</h2>
<div class="outline-text-2" id="text-orgd4b6f681">
<p>
on-the-fly syntax checker.
同様の拡張には <code>flycheck</code> があるけれど,
<code>flycheck</code> はいろいろやりすぎてて私には合わない.
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">flymake</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">&lt;=</span> <span class="mf">26.1</span> <span class="p">(</span><span class="nv">string-to-number</span> <span class="nv">emacs-version</span><span class="p">))</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> 設定調整が必要</li>
</ul>
</div>
</div>
<div>
<h2 id="org44ddff4c">LSP: <code>lsp-mode</code>
</h2>
<div class="outline-text-2" id="text-org44ddff4c">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">lsp-mode</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"fortls"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">lsp-print-io</span>             <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-trace</span>                <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-print-performance</span>    <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-auto-guess-root</span>      <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-document-sync-method</span> <span class="o">.</span> <span class="ss">'incremental</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-response-timeout</span>     <span class="o">.</span> <span class="mi">5</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-prefer-flymake</span>       <span class="o">.</span><span class="ss">'flymake</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">lsp-session-file</span>         <span class="o">.,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"lsp-session-v1"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
   <span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">lsp-ui</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">lsp-ui-doc-enable</span>            <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-header</span>            <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-include-signature</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-position</span>          <span class="o">.</span> <span class="ss">'at-point</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-max-width</span>         <span class="o">.</span> <span class="mi">150</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-max-height</span>        <span class="o">.</span> <span class="mi">30</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-use-childframe</span>    <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-doc-use-webkit</span>        <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-flycheck-enable</span>       <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-peek-enable</span>           <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-peek-peek-height</span>      <span class="o">.</span> <span class="mi">20</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-peek-list-width</span>       <span class="o">.</span> <span class="mi">50</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">lsp-ui-peek-fontify</span>          <span class="o">.</span> <span class="ss">'on-demand</span><span class="p">)</span> <span class="c1">;; never, on-demand, or always</span>
     <span class="p">)</span>
    <span class="p">)</span>
  <span class="ss">:hook</span>
  <span class="p">((</span><span class="nv">lsp-mode-hook</span> <span class="o">.</span> <span class="nv">lsp-ui-mode</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">f90-mode-hook</span> <span class="o">.</span> <span class="nv">lsp</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org88a3cb1b">TeX: <code>AUCTeX</code>
</h2>
<div class="outline-text-2" id="text-org88a3cb1b">
<p>
やっている事は
</p>
<ul class="org-ul">
<li>japanese-latex-mode において, 幾つかのコマンドが追加/上書きされているが,  あまり使うことの無いコマンドが表示されるのが嫌なのでそれらを削除．</li>
<li>コンパイルには<a href="http://personal.psu.edu/jcc8/software/latexmk/">Latexmk</a>を使う</li>
</ul>
<p>
と言った所.
<a href="http://personal.psu.edu/jcc8/software/latexmk/">Latexmk</a>の設定には<a href="https://github.com/tom-tan/auctex-latexmk">auctex-latexmk</a>を利用する．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">auctex</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"uplatex"</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"latexmk"</span><span class="p">))</span>
  <span class="c1">;; :ensure t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">unless</span> <span class="p">(</span><span class="nv">file-directory-p</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"auctex/auto"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="k">progn</span>
      <span class="p">(</span><span class="nv">make-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"auctex/auto"</span> <span class="nv">my:d:tmp</span><span class="p">)</span> <span class="no">t</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">make-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"auctex/style"</span> <span class="nv">my:d:tmp</span><span class="p">)</span> <span class="no">t</span><span class="p">)))</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">reftex</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">reftex-plug-into-AUCTeX</span>               <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">reftex-cite-prompt-optional-args</span>      <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">reftex-toc-split-windows-horizontally</span> <span class="o">.</span> <span class="no">t</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">company-reftex</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
<span class="c1">;;  (leaf company-auctex</span>
<span class="c1">;;    :ensure t</span>
<span class="c1">;;    )</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">auctex-latexmk</span>
    <span class="ss">:el-get</span> <span class="nv">tom-tan/auctex-latexmk</span>
    <span class="ss">:hook</span> <span class="p">(</span><span class="nv">LaTeX-mode-hook</span> <span class="o">.</span> <span class="nv">auctex-latexmk-setup</span><span class="p">)</span>
    <span class="ss">:config</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">auctex-latexmk-inherit-TeX-PDF-mode</span> <span class="no">nil</span>
          <span class="nv">TeX-command-default</span> <span class="s">"LaTeXMk"</span>
          <span class="nv">japanese-LaTeX-command-default</span> <span class="s">"LaTeX"</span>
          <span class="p">)</span>
    <span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">TeX-auto-local</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"auctex/auto"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">TeX-style-local</span>
     <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"auctex/style"</span> <span class="nv">my:d:tmp</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">TeX-parse-self</span>                    <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">TeX-auto-save</span>                     <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">TeX-auto-untabify</span>                 <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">TeX-source-correlate-mode</span>         <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">TeX-source-correlate-start-server</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">TeX-source-correlate-method</span>       <span class="o">.</span> <span class="ss">'synctex</span><span class="p">)</span>
    <span class="c1">;; (font-latex-fontify-script         . nil)</span>
    <span class="c1">;; (font-latex-script-display         . nil)</span>
    <span class="c1">;; (font-latex-fontify-sectioning     . 1.0)</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">TeX-command-output-list</span> <span class="o">'</span><span class="p">((</span><span class="s">"LaTeXMk"</span> <span class="p">(</span><span class="s">"pdf"</span><span class="p">))))</span>
  <span class="p">(</span><span class="nv">with-eval-after-load</span> <span class="ss">'tex-jp</span>
    <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">command</span> <span class="o">'</span><span class="p">(</span><span class="s">"pTeX"</span> <span class="s">"pLaTeX"</span> <span class="s">"jTeX"</span> <span class="s">"jLaTeX"</span> <span class="s">"jBibTeX"</span> <span class="s">"Mendex"</span>
                       <span class="s">"upMendex"</span> <span class="s">"pBibTeX"</span> <span class="s">"BibTeX"</span> <span class="s">"Biber"</span> <span class="s">"Ps2pdf"</span> <span class="p">))</span>
      <span class="p">(</span><span class="nv">delq</span> <span class="p">(</span><span class="nb">assoc</span> <span class="nv">command</span> <span class="nv">TeX-command-list</span><span class="p">)</span> <span class="nv">TeX-command-list</span><span class="p">))</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">TeX-view-program-selection</span> <span class="o">'</span><span class="p">((</span><span class="nv">output-dvi</span> <span class="s">"xdvi"</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nv">output-pdf</span> <span class="s">"Evince"</span><span class="p">)</span>
                                       <span class="p">(</span><span class="nv">output-html</span> <span class="s">"xdg-open"</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="ss">:mode-hook</span>
  <span class="p">((</span><span class="nv">LaTeX-mode-hook</span>
    <span class="o">.</span> <span class="p">((</span><span class="nv">turn-on-reftex</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">TeX-source-correlate-mode</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">TeX-PDF-mode</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">LaTeX-math-mode</span><span class="p">)</span>
       <span class="c1">;; (company-auctex-init)</span>
       <span class="p">(</span><span class="nv">reftex-mode</span><span class="p">)</span>
       <span class="p">(</span><span class="nv">outline-minor-mode</span><span class="p">))))</span>
  <span class="p">)</span></code></pre></figure>
<p>
<code>~/.latexmkrc</code> は以下の通り
</p>
<figure class="highlight"><pre><code class="language-perl" data-lang="perl"><span class="c1">#!/usr/bin/env perl</span>
<span class="nv">$kanji</span> <span class="o">=</span> <span class="nb">defined</span> <span class="nv">$ENV</span><span class="p">{"</span><span class="s2">LATEXENC</span><span class="p">"}</span> <span class="p">?</span> <span class="p">"</span><span class="s2">-kanji=</span><span class="si">$ENV</span><span class="s2">{</span><span class="se">\"</span><span class="s2">LATEXENC</span><span class="se">\"</span><span class="s2">}</span><span class="p">"</span> <span class="p">:</span> <span class="p">"</span><span class="s2">-kanji=utf8</span><span class="p">"</span> <span class="p">;</span>
<span class="nv">$latex</span>  <span class="o">=</span> <span class="p">"</span><span class="s2">platex -interaction=nonstopmode -src-specials -shell-escape --synctex=1 </span><span class="si">$kanji</span><span class="p">"</span> <span class="p">;</span>
<span class="nv">$latex_silent</span> <span class="o">=</span> <span class="p">"</span><span class="s2">platex -interaction=batchmode -src-specials -shell-escape --synctex=1 </span><span class="si">$kanji</span><span class="p">"</span> <span class="p">;</span>
<span class="nv">$pdflatex</span> <span class="o">=</span> <span class="p">"</span><span class="s2">ptex2pdf -e -l -ot '-shell-escape -synctex=1 </span><span class="si">$kanji</span><span class="s2">'</span><span class="p">";</span>
<span class="nv">$bibtex</span> <span class="o">=</span> <span class="p">"</span><span class="s2">pbibtex </span><span class="si">$kanji</span><span class="p">";</span>
<span class="c1"># disable makeindex/mendex</span>
<span class="nv">$makeindex</span> <span class="o">=</span> <span class="p">"</span><span class="s2">touch -m %D</span><span class="p">";</span>
<span class="c1"># if ( $ENV{"LATEXENC"} == "jis" ){</span>
<span class="c1">#     $makeindex = "mendex -J %O -c -r -o %D %S ";</span>
<span class="c1"># } elsif ( $ENV{"LATEXENC"} == "euc" ){</span>
<span class="c1">#     $makeindex = "mendex -E %O -c -r -o %D %S ";</span>
<span class="c1"># } elsif ( $ENV{"LATEXENC"} == "sjis" ){</span>
<span class="c1">#     $makeindex = "mendex -S %O -c -r -o %D %S";</span>
<span class="c1"># } else {</span>
<span class="c1">#     $makeindex = "mendex -U %O -c -r -o %D %S";</span>
<span class="c1"># }</span>
<span class="nv">$dvipdf</span> <span class="o">=</span> <span class="p">"</span><span class="s2">dvipdfmx %O -o %D %S</span><span class="p">";</span>
<span class="nv">$dvips</span> <span class="o">=</span> <span class="p">'</span><span class="s1">dvips %O -z -f %S | convbkmk -u &gt; %D</span><span class="p">';</span>
<span class="nv">$ps2pdf</span> <span class="o">=</span> <span class="p">'</span><span class="s1">ps2pdfwr %O %S %D</span><span class="p">';</span>
<span class="nv">$pdf_mode</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="nv">$pdf_previewer</span> <span class="o">=</span> <span class="p">'</span><span class="s1">xdg-open</span><span class="p">';</span>
<span class="c1"># $pdf_previewer = 'fwdevince %S %D';</span>
<span class="nv">$pdf_update_method</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nv">$cleanup_mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nv">$clean_ext</span> <span class="o">=</span> <span class="p">"</span><span class="s2">snm nav vrb synctex.gz spl bbl blg run.xml pgf-plot.table pgf-plot.gnuplot</span><span class="p">"</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org898b9a45">Autoconf</h2>
<div class="outline-text-2" id="text-org898b9a45">
<p>
いれてみたけれど, はてさて．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">sh-autoconf</span>
  <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">sh-autoconf</span>
           <span class="ss">:type</span> <span class="nv">http</span>
           <span class="ss">:url</span> <span class="s">"https://download.tuxfamily.org/user42/sh-autoconf.el"</span><span class="p">)</span>
  <span class="ss">:mode</span> <span class="p">((</span><span class="s">"/configure\\.\\(ac\\|in\\)\\'"</span>    <span class="o">.</span> <span class="nv">sh-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"/ac\\(include\\|local\\)\\.m4\\'"</span> <span class="o">.</span> <span class="nv">sh-mode</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org11ccc687">Fortran</h2>
<div class="outline-text-2" id="text-org11ccc687">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">f90</span>
  <span class="ss">:mode</span> <span class="p">(</span><span class="s">"\\.\\(f|F\\)\\(90|95|03|08\\)$"</span> <span class="o">.</span> <span class="nv">f90-mode</span><span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">f90-indent</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">f90-do-indent</span>               <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-if-indent</span>               <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-type-indent</span>             <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-program-indent</span>          <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-continuation-indent</span>     <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-directive-comment-re</span>    <span class="o">.</span> <span class="s">"!omp\\$"</span> <span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-indented-comment-re</span>     <span class="o">.</span> <span class="s">"!"</span> <span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-break-delimiters</span>        <span class="o">.</span> <span class="s">"[-+\\*/&gt;&lt;=,% \t]"</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-break-before-delimiters</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-beginning-ampersand</span>     <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-smart-end</span>               <span class="o">.</span> <span class="ss">'blink</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-auto-keyword-case</span>       <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-leave-line-no</span>           <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-comment-region</span>          <span class="o">.</span> <span class="s">"!! "</span><span class="p">)</span>
     <span class="p">(</span><span class="nv">f90-indent-comment</span>          <span class="o">.</span> <span class="s">"! "</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org6035cc60">Markdown</h2>
<div class="outline-text-2" id="text-org6035cc60">
<p>
markdown自体はあまり好きじゃないんだけれど,
必要に迫られて書く事が増えてきたので設定しておく．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">markdown-mode</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"pandoc"</span><span class="p">)</span>
  <span class="ss">:mode</span> <span class="p">(</span><span class="s">"\\.\\(md\\|markdown\\|mkd\\)\\'"</span> <span class="o">.</span> <span class="nv">gfm-mode</span><span class="p">)</span>
  <span class="ss">:preface</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:disable-electric-indent-local-mode</span> <span class="p">()</span>
    <span class="p">(</span><span class="nv">electric-indent-local-mode</span> <span class="mi">-1</span><span class="p">))</span>
  <span class="ss">:hook</span> <span class="p">((</span><span class="nv">markdown-mode-hook</span> <span class="o">.</span> <span class="nv">my:disable-electric-indent-local-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="nv">gfm-mode-hook</span>      <span class="o">.</span> <span class="nv">my:disable-electric-indent-local-mode</span><span class="p">)</span>
         <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">markdown-command</span>
        <span class="s">"pandoc --from markdown_github -t html5 --mathjax --highlight-style pygments"</span>
        <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org4b0a1cef">SCSS</h2>
<div class="outline-text-2" id="text-org4b0a1cef">
<p>
ちょいちょい弄る機会が増えてきたので導入．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">scss-mode</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"sass"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:mode</span> <span class="s">"\\.scss\\'"</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">scss-sass-command</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">executable-find</span> <span class="s">"sass"</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orge4a7e301">PlantUML</h2>
<div class="outline-text-2" id="text-orge4a7e301">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">plantuml-mode</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nv">executable-find</span> <span class="s">"plantuml"</span><span class="p">)</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">plantuml-executable-path</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">executable-find</span> <span class="s">"plantuml"</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">plantuml-default-exec-mode</span> <span class="o">.</span> <span class="ss">'executable</span><span class="p">))</span>
  <span class="ss">:init</span>
<span class="c1">;;   (add-to-list</span>
<span class="c1">;;    'org-src-lang-modes '("plantuml" . plantuml))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="org332b8d85">Re:VIEW</h2>
<div class="outline-text-2" id="text-org332b8d85">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">review-mode</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">review-mode-use-skk-mode</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">reivew-use-em</span> <span class="o">.</span> <span class="no">t</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orga28ad005">その他のモード設定</h2>
<div class="outline-text-2" id="text-orga28ad005">
<p>
読み込むだけの mode の設定. 設定が増えたら別途まとめる。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*misc-mode</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">yaml-mode</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:mode</span> <span class="s">"\\(\.yml\\|\.yaml\\)"</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">generic-x</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">textile-mode</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">lua-mode</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">debian-el</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">sh-mode</span>
    <span class="ss">:custom</span> <span class="p">((</span><span class="nv">system-uses-terminfo</span> <span class="o">.</span> <span class="no">nil</span><span class="p">))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">apt-sources-list</span> <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:custom</span>
    <span class="p">((</span><span class="nv">apt-sources-list-suites</span>
      <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">"stable"</span> <span class="s">"stable-backports"</span>
          <span class="s">"testing"</span> <span class="s">"testing-backports"</span>
          <span class="s">"unstable"</span> <span class="s">"experimental"</span>
          <span class="s">"jessie"</span> <span class="s">"jessie-backports"</span>
          <span class="s">"stretch"</span> <span class="s">"stretch-backports"</span>
          <span class="s">"buster"</span> <span class="s">"buster-backports"</span>
          <span class="s">"bullseye"</span>
          <span class="s">"sid"</span><span class="p">)))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">woman</span>
    <span class="ss">:custom-face</span>
    <span class="p">((</span><span class="nv">woman-bold</span>   <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:inherit</span> <span class="nv">font-lock-type-face</span> <span class="ss">:bold</span> <span class="no">t</span><span class="p">))))</span>
     <span class="p">(</span><span class="nv">woman-italic</span> <span class="o">.</span> <span class="o">'</span><span class="p">((</span><span class="no">t</span> <span class="p">(</span><span class="ss">:inherit</span> <span class="nv">font-lock-keyword-face</span> <span class="ss">:underline</span> <span class="no">t</span><span class="p">)))))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">info-colors</span>
    <span class="ss">:ensure</span> <span class="no">t</span>
    <span class="ss">:hook</span>
    <span class="p">(</span><span class="nv">Info-selection</span> <span class="nf">#'</span><span class="nv">info-colors-fontify-node</span><span class="p">))</span>
  <span class="p">)</span></code></pre></figure>
</div>
<div>
<h3 id="org993cf404">SSH config mode</h3>
<div class="outline-text-3" id="text-org993cf404">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">ssh-config-mode</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:mode</span> <span class="p">(((</span><span class="s">"/\\.ssh/config\\'"</span> <span class="s">"/sshd?_config\\'"</span><span class="p">)</span> <span class="o">.</span> <span class="nv">ssh-config-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"/known_hosts\\'"</span>                        <span class="o">.</span> <span class="nv">ssh-known-hosts-mode</span><span class="p">)</span>
         <span class="p">(</span><span class="s">"/authorized_keys?\\'"</span>                   <span class="o">.</span> <span class="nv">ssh-authorized-keys-mode</span><span class="p">))</span>
  <span class="ss">:hook</span> <span class="p">(</span><span class="nv">ssh-config-mode</span> <span class="o">.</span> <span class="nv">turn-on-font-lock</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="org9992a617">
<span class="done SOMEDAY">SOMEDAY</span> 日記: <code>tDiary</code> <code>[0/1]</code>
</h2>
<div class="outline-text-2" id="text-org9992a617">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">tdiary-mode</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">and</span> <span class="nv">my:d:password-store</span>
           <span class="p">(</span><span class="nv">file-directory-p</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)</span> <span class="s">"/Nextcloud/tdiary"</span><span class="p">)))</span>
  <span class="ss">:commands</span> <span class="p">(</span><span class="nv">tdiary-mode</span> <span class="nv">tdiary-replace</span> <span class="nv">tdiary-append</span><span class="p">)</span>
  <span class="ss">:el-get</span> <span class="nv">uwabami/tdiary-mode</span>
  <span class="ss">:defvar</span> <span class="nv">tdiary-passwd-file</span>
  <span class="ss">:pl-setq</span>
  <span class="p">(</span><span class="nv">tdiary-csrf-key</span> <span class="nv">tdiary-passwd-file</span><span class="p">)</span>
  <span class="c1">;; :init</span>
  <span class="c1">;; (setq tdiary-text-save-p t)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">tdiary-text-directory</span> <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"HOME"</span><span class="p">)</span> <span class="s">"/Nextcloud/tdiary/"</span><span class="p">)</span>
        <span class="nv">tdiary-diary-list</span> <span class="o">'</span><span class="p">((</span><span class="s">"log"</span> <span class="s">"https://uwabami.junkhub.org/log/"</span><span class="p">))</span>
        <span class="nv">tdiary-style-mode</span> <span class="ss">'org-mode</span>
        <span class="nv">tdiary-text-suffix</span> <span class="s">".org"</span>
        <span class="nv">tdiary-http-timeout</span> <span class="mi">100</span>
        <span class="p">)</span>
  <span class="p">(</span><span class="nv">tdiary-passwd-file-load</span><span class="p">)</span>
  <span class="c1">;; (with-eval-after-load 'tdiary-mode</span>
  <span class="c1">;;   (setq tdiary-text-save-p t))</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> org2blog で tDiary を更新できないか妄想している</li>
</ul>
</div>
</div>
<div>
<h2 id="orgbf458527">テーマ, フォント, モードライン, などなど</h2>
<div class="outline-text-2" id="text-orgbf458527">
</div>
<div>
<h3 id="org4c769ff7">
<span class="done SOMEDAY">SOMEDAY</span> xterm-color <code>[0/1]</code>
</h3>
<div class="outline-text-3" id="text-org4c769ff7">
<p>
色を端末と揃える。
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">xterm-color</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">xterm-color-names</span>
        <span class="nv">[</span><span class="s">"#000000"</span>    <span class="c1">; black</span>
         <span class="s">"#FF4C4C"</span>    <span class="c1">; red</span>
         <span class="s">"#4Cff4C"</span>    <span class="c1">; green</span>
         <span class="s">"#FFFF4C"</span>    <span class="c1">; yellow</span>
         <span class="s">"#4C4CFF"</span>    <span class="c1">; blue</span>
         <span class="s">"#FF4CFF"</span>    <span class="c1">; magenta</span>
         <span class="s">"#4CFFFF"</span>    <span class="c1">; cyan</span>
         <span class="s">"#AAAAAA"</span><span class="nv">]</span>   <span class="c1">; white</span>
        <span class="nv">xterm-color-names-bright</span>
        <span class="nv">[</span><span class="s">"#020202"</span>    <span class="c1">; black</span>
         <span class="s">"#FF7F7F"</span>    <span class="c1">; red</span>
         <span class="s">"#7FFF7F"</span>    <span class="c1">; green</span>
         <span class="s">"#FFFF7F"</span>    <span class="c1">; yellow</span>
         <span class="s">"#7F7FFF"</span>    <span class="c1">; blue</span>
         <span class="s">"#FF7FFF"</span>    <span class="c1">; magenta</span>
         <span class="s">"#7FFFFF"</span>    <span class="c1">; cyan</span>
         <span class="s">"#FFFFFF"</span><span class="nv">]</span>   <span class="c1">; white</span>
        <span class="nv">xterm-color-use-bold-for-bright</span> <span class="no">nil</span>
        <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> ちゃんと効いてない, ような?</li>
</ul>
</div>
</div>
<div>
<h3 id="org356b9857">
<span class="done SOMEDAY">SOMEDAY</span> フォント <code>[0/1]</code>
</h3>
<div class="outline-text-3" id="text-org356b9857">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nb">defun</span> <span class="nv">my:load-window-config</span> <span class="p">()</span>
  <span class="s">"load window-system specific settings"</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">when</span> <span class="nv">window-system</span>
    <span class="p">(</span><span class="k">progn</span>
      <span class="p">(</span><span class="nv">set-frame-parameter</span> <span class="no">nil</span> <span class="ss">'alpha</span> <span class="mi">95</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'default</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">195</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'fixed-pitch</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">195</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'variable-pitch</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">195</span><span class="p">)</span>
      <span class="c1">;; Math symbols</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#x2200</span> <span class="o">.</span> <span class="m">#x22FF</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">195</span><span class="p">))</span>
      <span class="c1">;; Greek</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#x0370</span> <span class="o">.</span> <span class="m">#x03FF</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">195</span><span class="p">))</span>
      <span class="c1">;; Some Icons</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#xE0A0</span> <span class="o">.</span> <span class="m">#xEEE0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">195</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">use-default-font-for-symbols</span> <span class="no">t</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-frame-parameter</span> <span class="no">nil</span> <span class="ss">'alpha</span> <span class="mi">95</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">toggle-frame-maximized</span><span class="p">)</span>
      <span class="p">)))</span>
<span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">window-system</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">my:load-window-config</span><span class="p">))</span>
<span class="c1">;;</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">my:load-side-window-config</span> <span class="p">()</span>
  <span class="s">"load window-system specific settings"</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">when</span> <span class="nv">window-system</span>
    <span class="p">(</span><span class="k">progn</span>
      <span class="p">(</span><span class="nv">set-frame-parameter</span> <span class="no">nil</span> <span class="ss">'alpha</span> <span class="mi">95</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'default</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">150</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'fixed-pitch</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">150</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-face-attribute</span> <span class="ss">'variable-pitch</span> <span class="no">nil</span>
                          <span class="ss">:family</span> <span class="s">"FSMRMP"</span>
                          <span class="ss">:height</span> <span class="mi">150</span><span class="p">)</span>
      <span class="c1">;; Math symbols</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#x2200</span> <span class="o">.</span> <span class="m">#x22FF</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">150</span><span class="p">))</span>
      <span class="c1">;; Greek</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#x0370</span> <span class="o">.</span> <span class="m">#x03FF</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">150</span><span class="p">))</span>
      <span class="c1">;; Some Icons</span>
      <span class="p">(</span><span class="nv">set-fontset-font</span> <span class="no">nil</span>
                        <span class="o">'</span><span class="p">(</span><span class="m">#xE0A0</span> <span class="o">.</span> <span class="m">#xEEE0</span><span class="p">)</span>
                        <span class="p">(</span><span class="nv">font-spec</span> <span class="ss">:family</span> <span class="s">"FSMRMP"</span> <span class="ss">:height</span> <span class="mi">150</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">use-default-font-for-symbols</span> <span class="no">t</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">set-frame-parameter</span> <span class="no">nil</span> <span class="ss">'alpha</span> <span class="mi">95</span><span class="p">)</span>
      <span class="p">(</span><span class="nv">toggle-frame-maximized</span><span class="p">)</span>
      <span class="p">)))</span></code></pre></figure>
<ul class="org-ul">
<li class="off">
<code>[ ]</code> FSMRMP のギリシャ文字が全角にならない. 要調整</li>
</ul>
<pre class="example">
幅の確認:
Greek, Math, 絵文字は全角, 他は半角で 2:1 になっているかの確認用

|abcdefghijkl|
|ABCDEFGHIJKL|
|'";:-+=/\~`?|
|∞≤≥∏∑∫|
|×±≒≡⊆⊇|
|αβγδεζ|
|ηθικλμ|
|ΑΒΓΔΕΖ|
|ΗΘΙΚΛΜ|
|日本語の美観|
|あいうえおか|
|アイウエオカ|
|ｱｲｳｴｵｶｷｸｹｺｻｼ|

| hoge                 | hogeghoe | age              |
|----------------------+----------+------------------|
| 今日もいい天気ですね | お、     | 等幅になった👍 🍺|
|----------------------+----------+------------------|
</pre>
</div>
</div>
<div>
<h3 id="org20d8ce5c">Major, Minor モードの表示のカスタマイズ: <code>blackout</code>
</h3>
<div class="outline-text-3" id="text-org20d8ce5c">
<p>
基本個々のモードの設定でカスタマイズしているけれども．
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*modeline-string</span>
  <span class="c1">;; ここでやるより, modeline の設定時に一括で変換した方が良い気もしてきた．</span>
  <span class="ss">:blackout</span> <span class="p">((</span><span class="nv">lisp-interaction-mode</span>
              <span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="ss">'lisp-interaction-mode</span><span class="p">))</span>
             <span class="p">(</span><span class="nv">emacs-lisp-mode</span>
              <span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="ss">'emacs-lisp-mode</span><span class="p">))</span>
             <span class="p">(</span><span class="nv">text-mode</span>
              <span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="ss">'text-mode</span><span class="p">))</span>
             <span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org7e722d0e">theme: <code>doom-theme</code>
</h3>
<div class="outline-text-3" id="text-org7e722d0e">
<p>
これまで弄っていた font-lock を
doom-theme をベースに移植中: <a href="https://github.com/uwabami/emacs-doom-darkpastel">uwabami/emacs-doom-darkpastel</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (setq frame-background-mode (frame-parameter nil 'background-mode))</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">*doom-themes</span>
  <span class="ss">:if</span> <span class="p">(</span><span class="nb">&gt;=</span> <span class="nv">emacs-major-version</span> <span class="mi">25</span><span class="p">)</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">doom-themes</span> <span class="ss">:ensure</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">leaf</span> <span class="nv">emacs-doom-darkpastel</span>
    <span class="ss">:el-get</span> <span class="p">(</span><span class="nv">emacs-doom-darkpastel</span>
             <span class="ss">:type</span> <span class="nv">github</span>
             <span class="ss">:pkgname</span> <span class="s">"uwabami/emacs-doom-darkpastel"</span>
             <span class="ss">:prepare</span> <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'custom-theme-load-path</span> <span class="nv">default-directory</span><span class="p">)</span>
             <span class="p">)</span>
    <span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="p">(</span><span class="nv">doom-darkpastel-set-background</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nv">load-theme</span> <span class="ss">'doom-darkpastel</span> <span class="no">t</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">eaw-and-emoji-fullwidth</span><span class="p">)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="org51edfacc">modeline</h3>
<div class="outline-text-3" id="text-org51edfacc">
<p>
powerline を使ってる
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">powerline</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:init</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:powerline-ddskk</span> <span class="p">()</span>
    <span class="s">"skkが読み込まれていなくても状態を表示"</span>
    <span class="p">(</span><span class="nb">cond</span>
     <span class="p">((</span><span class="nb">not</span> <span class="p">(</span><span class="nb">boundp</span> <span class="ss">'skk-modeline-input-mode</span><span class="p">))</span>
      <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-modeline-input-mode</span> <span class="s">"--[--]:"</span><span class="p">))</span>
     <span class="p">(</span><span class="no">t</span> <span class="nv">skk-modeline-input-mode</span><span class="p">)))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:skk-setup-modeline</span> <span class="p">()</span>
      <span class="s">"skk-setup-modeline による modeline の更新を無効化"</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">skk-indicator-alist</span> <span class="p">(</span><span class="nv">skk-make-indicator-alist</span><span class="p">))</span>
    <span class="p">(</span><span class="nv">force-mode-line-update</span> <span class="no">t</span><span class="p">))</span>
  <span class="c1">;;</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:major-mode-icon</span> <span class="p">(</span><span class="nv">mode</span><span class="p">)</span>
    <span class="s">"Update file icon in mode-line, just display major-mode icon. not filename."</span>
    <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">icon</span> <span class="p">(</span><span class="nv">all-the-icons-icon-for-mode</span> <span class="nv">mode</span><span class="p">)))</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">symbolp</span> <span class="nv">icon</span><span class="p">)</span>
        <span class="p">(</span><span class="nv">all-the-icons-faicon</span> <span class="s">"file-code-o"</span>
                              <span class="ss">:face</span> <span class="ss">'all-the-icons-dsilver</span>
                              <span class="ss">:height</span> <span class="mf">1.0</span><span class="p">)</span>
      <span class="nv">icon</span><span class="p">)))</span>
  <span class="ss">:advice</span> <span class="p">(</span><span class="ss">:override</span> <span class="nv">skk-setup-modeline</span> <span class="nv">my:skk-setup-modeline</span><span class="p">)</span>
  <span class="ss">:custom</span>
  <span class="o">`</span><span class="p">((</span><span class="nv">powerline-buffer-size-suffix</span>  <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">powerline-display-hud</span>         <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">powerline-display-buffer-size</span> <span class="o">.</span> <span class="no">nil</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">powerline-text-scale-factor</span>   <span class="o">.</span>  <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="ss">:config</span>
  <span class="p">(</span><span class="nb">defun</span> <span class="nv">my:powerline-theme</span> <span class="p">()</span>
    <span class="s">"Setup the default mode-line."</span>
    <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">my:powerline-ddskk</span><span class="p">)</span>
    <span class="p">(</span><span class="nv">setq-default</span>
     <span class="nv">mode-line-format</span>
     <span class="o">'</span><span class="p">(</span><span class="s">"%e"</span>
       <span class="p">(</span><span class="ss">:eval</span>
        <span class="p">(</span><span class="k">let*</span> <span class="p">((</span><span class="nv">active</span> <span class="p">(</span><span class="nv">powerline-selected-window-active</span><span class="p">))</span>
               <span class="p">(</span><span class="nv">mode-line-buffer-id</span> <span class="p">(</span><span class="k">if</span> <span class="nv">active</span> <span class="ss">'mode-line-buffer-id</span> <span class="ss">'mode-line-buffer-id-inactive</span><span class="p">))</span>
               <span class="p">(</span><span class="nv">mode-line</span> <span class="p">(</span><span class="k">if</span> <span class="nv">active</span> <span class="ss">'mode-line</span> <span class="ss">'mode-line-inactive</span><span class="p">))</span>
               <span class="p">(</span><span class="nv">face1</span> <span class="p">(</span><span class="k">if</span> <span class="nv">active</span> <span class="ss">'mode-line-highlight</span> <span class="ss">'powerline-inactive2</span><span class="p">))</span>
               <span class="c1">;; (face1 (if active 'powerline-active1 'powerline-inactive2))</span>
               <span class="c1">;; (face2 (if active 'powerline-active2 'powerline-inactive2))</span>
               <span class="c1">;; (face2 (if active 'mode-line-highlight 'powerline-inactive2))</span>
               <span class="p">(</span><span class="nv">lhs</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nv">powerline-raw</span> <span class="p">(</span><span class="nv">substring</span> <span class="nv">skk-modeline-input-mode</span> <span class="mi">2</span> <span class="mi">-1</span><span class="p">)</span> <span class="nv">mode-line</span> <span class="ss">'l</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="s">"%*"</span> <span class="nv">mode-line</span> <span class="ss">'l</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="nv">mode-line-mule-info</span> <span class="nv">mode-line</span> <span class="ss">'l</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="p">(</span><span class="nv">my:major-mode-icon</span> <span class="nv">major-mode</span><span class="p">)</span> <span class="nv">mode-line</span> <span class="ss">'l</span><span class="p">)</span>
                          <span class="c1">;; (powerline-raw (all-the-icons-icon-for-mode major-mode) mode-line 'l)</span>
                          <span class="p">(</span><span class="nv">powerline-buffer-id</span> <span class="nv">mode-line-buffer-id</span> <span class="ss">'l</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="s">" "</span><span class="p">)</span>
                          <span class="p">))</span>
               <span class="p">(</span><span class="nv">rhs</span> <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nv">powerline-raw</span> <span class="nv">global-mode-string</span> <span class="nv">face1</span> <span class="ss">'r</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-vc</span> <span class="nv">face1</span> <span class="ss">'r</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="s">" "</span><span class="p">)</span>
                          <span class="p">(</span><span class="nv">powerline-raw</span> <span class="s">"%6p"</span> <span class="nv">mode-line</span> <span class="ss">'r</span><span class="p">)</span>
                          <span class="p">)))</span>
          <span class="p">(</span><span class="nv">concat</span> <span class="p">(</span><span class="nv">powerline-render</span> <span class="nv">lhs</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">powerline-fill</span> <span class="nv">face1</span> <span class="p">(</span><span class="nv">powerline-width</span> <span class="nv">rhs</span><span class="p">))</span>
                  <span class="p">(</span><span class="nv">powerline-render</span> <span class="nv">rhs</span><span class="p">))))))</span>
    <span class="p">)</span>
  <span class="p">(</span><span class="nv">my:powerline-theme</span><span class="p">)</span>
  <span class="c1">;; (powerline-revert)</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
</div>
<div>
<h2 id="orgca1f29da">起動時間の出力</h2>
<div class="outline-text-2" id="text-orgca1f29da">
<p>
<a href="http://memo.sugyan.com/entry/20120120/1327037494">起動時間を計測する 改訂版 - すぎゃーんメモ</a>
</p>
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">*show-startup-time</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">emacs-startup-hook</span>
   <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span>
       <span class="p">(</span><span class="nv">message</span> <span class="s">"init time: %.3f sec"</span>
                <span class="p">(</span><span class="nv">float-time</span> <span class="p">(</span><span class="nv">time-subtract</span> <span class="nv">after-init-time</span> <span class="nv">before-init-time</span><span class="p">)))))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orgd89ceb4b">Debug</h2>
<div class="outline-text-2" id="text-orgd89ceb4b">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="p">(</span><span class="nv">leaf</span> <span class="nv">esup</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
  <span class="p">((</span><span class="nv">esup-insignificant-time</span> <span class="o">.</span> <span class="mf">0.01</span><span class="p">)</span>
   <span class="p">(</span><span class="nv">esup-depth</span>              <span class="o">.</span> <span class="mi">0</span><span class="p">))</span> <span class="c1">;; 🤔</span>
  <span class="p">)</span>
<span class="p">(</span><span class="nv">leaf</span> <span class="nv">org-bullets</span>
  <span class="ss">:disabled</span> <span class="no">t</span>
  <span class="ss">:ensure</span> <span class="no">t</span>
  <span class="ss">:custom</span>
   <span class="p">(</span><span class="nv">org-bullets-bullet-list</span> <span class="o">.</span> <span class="o">'</span><span class="p">(</span><span class="s">" "</span> <span class="s">"◎ "</span> <span class="s">"□"</span> <span class="s">"・"</span><span class="p">))</span>
  <span class="ss">:hook</span>
  <span class="p">(</span><span class="nv">org-mode-hook</span>
   <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nv">org-bullets-mode</span> <span class="mi">1</span><span class="p">)))</span>
  <span class="p">)</span></code></pre></figure>
</div>
</div>
<div>
<h2 id="orgf87c4e84">最後に</h2>
<div class="outline-text-2" id="text-orgf87c4e84">
</div>
<div>
<h3 id="org4c97a1e0">provide の設定</h3>
<div class="outline-text-3" id="text-org4c97a1e0">
<figure class="highlight"><pre><code class="language-emacs-lisp" data-lang="emacs-lisp"><span class="c1">;; (profiler-report)</span>
<span class="c1">;; (profiler-stop)</span>
<span class="p">(</span><span class="nb">provide</span> <span class="ss">'init</span><span class="p">)</span>
<span class="c1">;; Local Variables:</span>
<span class="c1">;; byte-compile-warnings: (not obsolete cl-functions)</span>
<span class="c1">;; End:</span></code></pre></figure>
</div>
</div>
<div>
<h3 id="orge8960401">LICENSE</h3>
<div class="outline-text-3" id="text-orge8960401">
<p>
幾つかの関数の元ネタとして Emacs 本体のコードを参照したので,
GPL-3 or later です．
</p>
<pre class="example">
Copyright (C) 2011--2017 Youhei SASAKI &lt;uwabami@gfd-dennou.org&gt;
.
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
.
This package is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
.
You should have received a copy of the GNU General Public License
along with this program. If not, see &lt;https://www.gnu.org/licenses/&gt;.
</pre>
</div>
</div>
</div>
<!-- %%%% end content %%%% -->
        </div>
      </main>
      <!-- include footer -->
      <footer class="container bottom-0 left-0 right-0 small">
        <hr/>
        <p class="p0 m0 right-align">&copy; 2006-2020
          <a href="mailto:uwabami@gfd-dennou.org">Youhei SASAKI</a>,
          Lastupdate: 2020-11-01 03:22:33 +0000
          <br/>
          Powered by
          <a href="http://orgmode.org/" target="_blank" title="Org mode">
            Org mode
          </a>
          +
          <a href="http://jekyllrb.com/" target="_blank" title="Jekyll">
            Jekyll
          </a>
          +
          <a href="http://basscss.com/" target="_blank" title="Basscss">
            Basscss
          </a>
          &amp;
          <a href="https://amp.dev/">
            <span class="icon-amp">⚡</span>AMP
          </a>
        </p>
      </footer>
      <amp-analytics data-block-on-consent
                     type="gtag"
                     data-credentials="include">
        <script type="application/json">
          {
              "vars" : {
                  "gtag_id": "UA-90872419-1",
                  "config" : {
                      "UA-90872419-1": { "groups": "default" }
                  }
              }
          }
        </script>
      </amp-analytics>
      <!-- end: include footer -->
    </div>
  </body>
</html>
